[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 10:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  248G  86% /data
96G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 10:46:47 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 10:46:47 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.867 seconds
Query ID = busbi_20170502104653_d4117401-529a-4113-a852-3ead0314a55a
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 165
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_616101, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_616101/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_616101
Hadoop job information for Stage-3: number of mappers: 152; number of reducers: 165
2017-05-02 10:47:43,429 Stage-3 map = 0%,  reduce = 0%
2017-05-02 10:48:11,665 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 292.69 sec
2017-05-02 10:48:12,705 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 1005.06 sec
2017-05-02 10:48:13,750 Stage-3 map = 5%,  reduce = 0%, Cumulative CPU 1785.1 sec
2017-05-02 10:48:14,786 Stage-3 map = 8%,  reduce = 0%, Cumulative CPU 1854.97 sec
2017-05-02 10:48:15,820 Stage-3 map = 14%,  reduce = 0%, Cumulative CPU 2036.2 sec
2017-05-02 10:48:16,864 Stage-3 map = 21%,  reduce = 0%, Cumulative CPU 2275.81 sec
2017-05-02 10:48:17,908 Stage-3 map = 25%,  reduce = 0%, Cumulative CPU 2509.57 sec
2017-05-02 10:48:18,970 Stage-3 map = 34%,  reduce = 0%, Cumulative CPU 2772.43 sec
2017-05-02 10:48:20,038 Stage-3 map = 47%,  reduce = 0%, Cumulative CPU 2969.73 sec
2017-05-02 10:48:21,093 Stage-3 map = 57%,  reduce = 0%, Cumulative CPU 3205.88 sec
2017-05-02 10:48:22,138 Stage-3 map = 62%,  reduce = 0%, Cumulative CPU 3376.53 sec
2017-05-02 10:48:23,182 Stage-3 map = 64%,  reduce = 0%, Cumulative CPU 3448.83 sec
2017-05-02 10:48:24,213 Stage-3 map = 66%,  reduce = 0%, Cumulative CPU 3587.67 sec
2017-05-02 10:48:26,273 Stage-3 map = 68%,  reduce = 0%, Cumulative CPU 3890.8 sec
2017-05-02 10:48:28,335 Stage-3 map = 70%,  reduce = 0%, Cumulative CPU 4166.26 sec
2017-05-02 10:48:29,362 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 4241.78 sec
2017-05-02 10:48:31,439 Stage-3 map = 73%,  reduce = 0%, Cumulative CPU 4442.79 sec
2017-05-02 10:48:33,508 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 4599.83 sec
2017-05-02 10:48:34,545 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 4692.95 sec
2017-05-02 10:48:37,632 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 4861.82 sec
2017-05-02 10:48:38,662 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 4873.93 sec
2017-05-02 10:48:40,721 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 4980.36 sec
2017-05-02 10:48:41,757 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 5022.44 sec
2017-05-02 10:48:42,786 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 5065.53 sec
2017-05-02 10:48:43,814 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 5103.56 sec
2017-05-02 10:48:44,843 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 5153.78 sec
2017-05-02 10:48:45,870 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 5198.24 sec
2017-05-02 10:48:47,942 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 5261.07 sec
2017-05-02 10:48:48,965 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 5289.51 sec
2017-05-02 10:48:51,025 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 5341.04 sec
2017-05-02 10:48:52,051 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 5372.58 sec
2017-05-02 10:48:53,078 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 5393.55 sec
2017-05-02 10:48:55,152 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 5436.24 sec
2017-05-02 10:48:57,211 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 5454.1 sec
2017-05-02 10:48:58,249 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 5472.84 sec
2017-05-02 10:48:59,282 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 5481.07 sec
2017-05-02 10:49:38,347 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 5516.95 sec
2017-05-02 10:49:57,460 Stage-3 map = 100%,  reduce = 10%, Cumulative CPU 5607.98 sec
2017-05-02 10:49:58,493 Stage-3 map = 100%,  reduce = 55%, Cumulative CPU 6412.2 sec
2017-05-02 10:49:59,519 Stage-3 map = 100%,  reduce = 58%, Cumulative CPU 6473.14 sec
2017-05-02 10:50:00,544 Stage-3 map = 100%,  reduce = 63%, Cumulative CPU 6603.6 sec
2017-05-02 10:50:01,578 Stage-3 map = 100%,  reduce = 76%, Cumulative CPU 7007.33 sec
2017-05-02 10:50:02,604 Stage-3 map = 100%,  reduce = 77%, Cumulative CPU 7028.79 sec
2017-05-02 10:50:03,630 Stage-3 map = 100%,  reduce = 82%, Cumulative CPU 7197.81 sec
2017-05-02 10:50:04,658 Stage-3 map = 100%,  reduce = 94%, Cumulative CPU 7654.09 sec
2017-05-02 10:50:05,689 Stage-3 map = 100%,  reduce = 95%, Cumulative CPU 7693.92 sec
2017-05-02 10:50:06,720 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 7756.78 sec
2017-05-02 10:50:09,858 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 7829.09 sec
2017-05-02 10:50:11,932 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 7841.46 sec
2017-05-02 10:50:26,329 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 7909.9 sec
MapReduce Total cumulative CPU time: 0 days 2 hours 11 minutes 49 seconds 900 msec
Ended Job = job_1493104900716_616101
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_616371, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_616371/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_616371
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 2
2017-05-02 10:51:02,972 Stage-4 map = 0%,  reduce = 0%
2017-05-02 10:51:17,428 Stage-4 map = 28%,  reduce = 0%, Cumulative CPU 28.66 sec
2017-05-02 10:51:19,485 Stage-4 map = 39%,  reduce = 0%, Cumulative CPU 31.68 sec
2017-05-02 10:51:21,558 Stage-4 map = 42%,  reduce = 0%, Cumulative CPU 38.67 sec
2017-05-02 10:51:24,672 Stage-4 map = 45%,  reduce = 0%, Cumulative CPU 43.55 sec
2017-05-02 10:51:27,908 Stage-4 map = 48%,  reduce = 0%, Cumulative CPU 49.85 sec
2017-05-02 10:51:31,006 Stage-4 map = 51%,  reduce = 0%, Cumulative CPU 54.55 sec
2017-05-02 10:51:34,107 Stage-4 map = 52%,  reduce = 0%, Cumulative CPU 60.04 sec
2017-05-02 10:51:37,206 Stage-4 map = 56%,  reduce = 0%, Cumulative CPU 66.1 sec
2017-05-02 10:51:40,327 Stage-4 map = 58%,  reduce = 0%, Cumulative CPU 68.49 sec
2017-05-02 10:51:43,468 Stage-4 map = 61%,  reduce = 0%, Cumulative CPU 73.33 sec
2017-05-02 10:51:45,542 Stage-4 map = 63%,  reduce = 0%, Cumulative CPU 79.43 sec
2017-05-02 10:51:46,580 Stage-4 map = 65%,  reduce = 0%, Cumulative CPU 85.72 sec
2017-05-02 10:51:48,644 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 91.97 sec
2017-05-02 10:51:49,677 Stage-4 map = 68%,  reduce = 0%, Cumulative CPU 98.11 sec
2017-05-02 10:51:51,755 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 102.12 sec
2017-05-02 10:51:54,844 Stage-4 map = 70%,  reduce = 0%, Cumulative CPU 108.32 sec
2017-05-02 10:51:57,919 Stage-4 map = 72%,  reduce = 0%, Cumulative CPU 110.46 sec
2017-05-02 10:51:58,942 Stage-4 map = 75%,  reduce = 0%, Cumulative CPU 116.1 sec
2017-05-02 10:52:00,992 Stage-4 map = 76%,  reduce = 0%, Cumulative CPU 118.23 sec
2017-05-02 10:52:02,018 Stage-4 map = 78%,  reduce = 0%, Cumulative CPU 120.78 sec
2017-05-02 10:52:07,163 Stage-4 map = 83%,  reduce = 0%, Cumulative CPU 131.39 sec
2017-05-02 10:52:08,186 Stage-4 map = 89%,  reduce = 0%, Cumulative CPU 134.94 sec
2017-05-02 10:52:13,364 Stage-4 map = 94%,  reduce = 0%, Cumulative CPU 144.13 sec
2017-05-02 10:52:14,390 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 147.21 sec
2017-05-02 10:52:37,083 Stage-4 map = 100%,  reduce = 30%, Cumulative CPU 159.14 sec
2017-05-02 10:52:40,162 Stage-4 map = 100%,  reduce = 34%, Cumulative CPU 167.48 sec
2017-05-02 10:52:42,225 Stage-4 map = 100%,  reduce = 55%, Cumulative CPU 174.87 sec
2017-05-02 10:52:43,260 Stage-4 map = 100%,  reduce = 58%, Cumulative CPU 180.52 sec
2017-05-02 10:52:45,325 Stage-4 map = 100%,  reduce = 62%, Cumulative CPU 183.94 sec
2017-05-02 10:52:46,360 Stage-4 map = 100%,  reduce = 66%, Cumulative CPU 187.48 sec
2017-05-02 10:52:48,417 Stage-4 map = 100%,  reduce = 69%, Cumulative CPU 190.7 sec
2017-05-02 10:52:49,452 Stage-4 map = 100%,  reduce = 73%, Cumulative CPU 195.29 sec
2017-05-02 10:52:51,554 Stage-4 map = 100%,  reduce = 75%, Cumulative CPU 198.7 sec
2017-05-02 10:52:52,586 Stage-4 map = 100%,  reduce = 79%, Cumulative CPU 202.41 sec
2017-05-02 10:52:54,648 Stage-4 map = 100%,  reduce = 81%, Cumulative CPU 206.23 sec
2017-05-02 10:52:55,681 Stage-4 map = 100%,  reduce = 83%, Cumulative CPU 209.3 sec
2017-05-02 10:52:57,813 Stage-4 map = 100%,  reduce = 84%, Cumulative CPU 224.26 sec
2017-05-02 10:53:00,916 Stage-4 map = 100%,  reduce = 86%, Cumulative CPU 228.57 sec
2017-05-02 10:53:03,992 Stage-4 map = 100%,  reduce = 87%, Cumulative CPU 232.38 sec
2017-05-02 10:53:07,072 Stage-4 map = 100%,  reduce = 89%, Cumulative CPU 237.22 sec
2017-05-02 10:53:10,176 Stage-4 map = 100%,  reduce = 90%, Cumulative CPU 241.42 sec
2017-05-02 10:53:13,239 Stage-4 map = 100%,  reduce = 91%, Cumulative CPU 245.73 sec
2017-05-02 10:53:16,302 Stage-4 map = 100%,  reduce = 92%, Cumulative CPU 249.98 sec
2017-05-02 10:53:19,364 Stage-4 map = 100%,  reduce = 93%, Cumulative CPU 253.17 sec
2017-05-02 10:53:22,427 Stage-4 map = 100%,  reduce = 95%, Cumulative CPU 256.31 sec
2017-05-02 10:53:26,502 Stage-4 map = 100%,  reduce = 96%, Cumulative CPU 259.7 sec
2017-05-02 10:53:29,578 Stage-4 map = 100%,  reduce = 97%, Cumulative CPU 262.87 sec
2017-05-02 10:53:32,641 Stage-4 map = 100%,  reduce = 98%, Cumulative CPU 265.59 sec
2017-05-02 10:53:38,814 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 272.42 sec
2017-05-02 10:53:40,899 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 274.89 sec
MapReduce Total cumulative CPU time: 4 minutes 34 seconds 890 msec
Ended Job = job_1493104900716_616371
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_616807, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_616807/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_616807
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 2
2017-05-02 10:54:14,021 Stage-1 map = 0%,  reduce = 0%
2017-05-02 10:54:23,330 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 3.87 sec
2017-05-02 10:54:40,822 Stage-1 map = 57%,  reduce = 0%, Cumulative CPU 58.45 sec
2017-05-02 10:54:53,172 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 102.59 sec
2017-05-02 10:54:56,259 Stage-1 map = 86%,  reduce = 0%, Cumulative CPU 110.28 sec
2017-05-02 10:54:59,342 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 116.66 sec
2017-05-02 10:55:01,393 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 119.57 sec
2017-05-02 10:55:02,418 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 123.6 sec
2017-05-02 10:55:20,106 Stage-1 map = 100%,  reduce = 26%, Cumulative CPU 128.22 sec
2017-05-02 10:55:23,249 Stage-1 map = 100%,  reduce = 33%, Cumulative CPU 134.44 sec
2017-05-02 10:55:26,352 Stage-1 map = 100%,  reduce = 38%, Cumulative CPU 140.68 sec
2017-05-02 10:55:29,471 Stage-1 map = 100%,  reduce = 43%, Cumulative CPU 144.34 sec
2017-05-02 10:55:32,595 Stage-1 map = 100%,  reduce = 48%, Cumulative CPU 149.24 sec
2017-05-02 10:55:33,621 Stage-1 map = 100%,  reduce = 50%, Cumulative CPU 151.15 sec
2017-05-02 10:55:34,659 Stage-1 map = 100%,  reduce = 83%, Cumulative CPU 158.12 sec
2017-05-02 10:55:41,944 Stage-1 map = 100%,  reduce = 84%, Cumulative CPU 169.17 sec
2017-05-02 10:55:49,213 Stage-1 map = 100%,  reduce = 85%, Cumulative CPU 175.24 sec
2017-05-02 10:55:56,464 Stage-1 map = 100%,  reduce = 86%, Cumulative CPU 181.33 sec
2017-05-02 10:55:59,551 Stage-1 map = 100%,  reduce = 87%, Cumulative CPU 184.62 sec
2017-05-02 10:56:06,788 Stage-1 map = 100%,  reduce = 88%, Cumulative CPU 191.57 sec
2017-05-02 10:56:09,877 Stage-1 map = 100%,  reduce = 89%, Cumulative CPU 194.33 sec
2017-05-02 10:56:19,108 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 202.75 sec
2017-05-02 10:56:23,196 Stage-1 map = 100%,  reduce = 91%, Cumulative CPU 205.21 sec
2017-05-02 10:56:29,376 Stage-1 map = 100%,  reduce = 92%, Cumulative CPU 210.24 sec
2017-05-02 10:56:32,441 Stage-1 map = 100%,  reduce = 93%, Cumulative CPU 213.45 sec
2017-05-02 10:56:38,565 Stage-1 map = 100%,  reduce = 94%, Cumulative CPU 219.7 sec
2017-05-02 10:56:41,640 Stage-1 map = 100%,  reduce = 95%, Cumulative CPU 222.63 sec
2017-05-02 10:56:44,705 Stage-1 map = 100%,  reduce = 96%, Cumulative CPU 225.86 sec
2017-05-02 10:56:51,914 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 230.24 sec
2017-05-02 10:56:58,082 Stage-1 map = 100%,  reduce = 98%, Cumulative CPU 236.51 sec
2017-05-02 10:57:01,152 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 239.75 sec
2017-05-02 10:57:09,402 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 246.64 sec
MapReduce Total cumulative CPU time: 4 minutes 6 seconds 640 msec
Ended Job = job_1493104900716_616807
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_617182, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_617182/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_617182
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 10:57:48,179 Stage-2 map = 0%,  reduce = 0%
2017-05-02 10:58:48,220 Stage-2 map = 11%,  reduce = 0%, Cumulative CPU 80.39 sec
2017-05-02 10:59:04,759 Stage-2 map = 28%,  reduce = 0%, Cumulative CPU 108.96 sec
2017-05-02 10:59:42,870 Stage-2 map = 47%,  reduce = 0%, Cumulative CPU 196.16 sec
2017-05-02 10:59:50,081 Stage-2 map = 50%,  reduce = 0%, Cumulative CPU 214.42 sec
2017-05-02 11:00:02,485 Stage-2 map = 65%,  reduce = 0%, Cumulative CPU 236.34 sec
2017-05-02 11:00:05,602 Stage-2 map = 82%,  reduce = 0%, Cumulative CPU 239.33 sec
2017-05-02 11:00:06,666 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 242.67 sec
2017-05-02 11:00:25,333 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 272.91 sec
2017-05-02 11:01:07,599 Stage-2 map = 100%,  reduce = 67%, Cumulative CPU 296.07 sec
2017-05-02 11:01:13,760 Stage-2 map = 100%,  reduce = 68%, Cumulative CPU 307.08 sec
2017-05-02 11:01:17,902 Stage-2 map = 100%,  reduce = 70%, Cumulative CPU 311.33 sec
2017-05-02 11:01:21,038 Stage-2 map = 100%,  reduce = 72%, Cumulative CPU 313.14 sec
2017-05-02 11:01:24,112 Stage-2 map = 100%,  reduce = 73%, Cumulative CPU 315.26 sec
2017-05-02 11:01:28,216 Stage-2 map = 100%,  reduce = 76%, Cumulative CPU 319.36 sec
2017-05-02 11:01:31,304 Stage-2 map = 100%,  reduce = 78%, Cumulative CPU 324.13 sec
2017-05-02 11:01:34,453 Stage-2 map = 100%,  reduce = 80%, Cumulative CPU 329.71 sec
2017-05-02 11:01:37,647 Stage-2 map = 100%,  reduce = 82%, Cumulative CPU 333.29 sec
2017-05-02 11:01:41,498 Stage-2 map = 100%,  reduce = 84%, Cumulative CPU 336.09 sec
2017-05-02 11:01:44,612 Stage-2 map = 100%,  reduce = 86%, Cumulative CPU 338.81 sec
2017-05-02 11:01:48,135 Stage-2 map = 100%,  reduce = 88%, Cumulative CPU 341.98 sec
2017-05-02 11:01:51,210 Stage-2 map = 100%,  reduce = 90%, Cumulative CPU 345.3 sec
2017-05-02 11:01:54,577 Stage-2 map = 100%,  reduce = 92%, Cumulative CPU 348.04 sec
2017-05-02 11:01:57,719 Stage-2 map = 100%,  reduce = 94%, Cumulative CPU 350.94 sec
2017-05-02 11:02:00,847 Stage-2 map = 100%,  reduce = 96%, Cumulative CPU 353.26 sec
2017-05-02 11:02:04,046 Stage-2 map = 100%,  reduce = 98%, Cumulative CPU 356.35 sec
2017-05-02 11:02:07,227 Stage-2 map = 100%,  reduce = 99%, Cumulative CPU 359.33 sec
2017-05-02 11:02:08,867 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 359.63 sec
MapReduce Total cumulative CPU time: 5 minutes 59 seconds 630 msec
Ended Job = job_1493104900716_617182
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 152  Reduce: 165   Cumulative CPU: 7912.09 sec   HDFS Read: 42194331769 HDFS Write: 510225535 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 2   Cumulative CPU: 274.89 sec   HDFS Read: 510287676 HDFS Write: 510208070 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 2   Cumulative CPU: 246.64 sec   HDFS Read: 510249209 HDFS Write: 509160301 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 359.63 sec   HDFS Read: 509176628 HDFS Write: 375791458 SUCCESS
Total MapReduce CPU Time Spent: 0 days 2 hours 26 minutes 33 seconds 250 msec
OK
Time taken: 916.954 seconds, Fetched: 5575281 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1493049600, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 70.55}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 97.77}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 96.54}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 96.04}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 96.71}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.65}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 99.65}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 93.43}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 99.29}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.64}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.08}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 95.37}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 97.39}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 96.24}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 93.59}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.58}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.15}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.47}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 96.13}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 98.4}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.5}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 98.13}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 94.72}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:00:02 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  249G  86% /data
97G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170425' 
        and city_id = '7'
)q

17/05/02 11:09:15 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:09:15 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 3.202 seconds
Query ID = busbi_20170502110927_3100232a-c397-42a3-95a1-2eb95fbf192a
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_618416, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_618416/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_618416
Hadoop job information for Stage-1: number of mappers: 11; number of reducers: 1
2017-05-02 11:10:16,545 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:10:32,844 Stage-1 map = 3%,  reduce = 0%, Cumulative CPU 73.5 sec
2017-05-02 11:10:33,937 Stage-1 map = 9%,  reduce = 0%, Cumulative CPU 99.02 sec
2017-05-02 11:10:37,172 Stage-1 map = 15%,  reduce = 0%, Cumulative CPU 126.53 sec
2017-05-02 11:10:41,535 Stage-1 map = 39%,  reduce = 0%, Cumulative CPU 166.93 sec
2017-05-02 11:10:42,627 Stage-1 map = 45%,  reduce = 0%, Cumulative CPU 170.67 sec
2017-05-02 11:11:08,493 Stage-1 map = 48%,  reduce = 0%, Cumulative CPU 397.78 sec
2017-05-02 11:11:09,533 Stage-1 map = 52%,  reduce = 0%, Cumulative CPU 400.97 sec
2017-05-02 11:11:13,784 Stage-1 map = 55%,  reduce = 0%, Cumulative CPU 430.6 sec
2017-05-02 11:11:19,211 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 472.55 sec
2017-05-02 11:11:23,424 Stage-1 map = 73%,  reduce = 0%, Cumulative CPU 496.3 sec
2017-05-02 11:11:24,503 Stage-1 map = 76%,  reduce = 0%, Cumulative CPU 499.88 sec
2017-05-02 11:11:25,595 Stage-1 map = 82%,  reduce = 0%, Cumulative CPU 507.34 sec
2017-05-02 11:11:34,142 Stage-1 map = 88%,  reduce = 0%, Cumulative CPU 503.51 sec
2017-05-02 11:11:38,461 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 515.91 sec
2017-05-02 11:11:46,993 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 519.6 sec
MapReduce Total cumulative CPU time: 8 minutes 39 seconds 600 msec
Ended Job = job_1493104900716_618416
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 11  Reduce: 1   Cumulative CPU: 519.6 sec   HDFS Read: 2141278483 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 8 minutes 39 seconds 600 msec
OK
Time taken: 141.801 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:10:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 11:12:21 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/25/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170425(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170425;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170425 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170425';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='25');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='25') location '2017/04/25';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='25')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 11:12:31 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:12:31 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 4.278 seconds
OK
Time taken: 0.205 seconds
OK
Time taken: 0.915 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170425
Table transit_dw.tmp_abnormal_ratio_20170425 stats: [numFiles=1, numRows=0, totalSize=182, rawDataSize=0]
OK
Time taken: 0.894 seconds
Query ID = busbi_20170502111247_c2d9bdf3-7a63-4a0f-b4d3-30d1b575cd36
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_618798, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_618798/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_618798
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 11:13:48,053 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:13:57,957 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 4.63 sec
2017-05-02 11:14:08,712 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 8.56 sec
MapReduce Total cumulative CPU time: 8 seconds 560 msec
Ended Job = job_1493104900716_618798
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_11-12-47_387_8102297126308440699-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/a0dae34f-5546-490f-a431-df5020e9c2ca/_tmp_space.db/b954e8a0-fa44-4c40-8671-8d4d90301a2d
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6767, rawDataSize=6743]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 8.56 sec   HDFS Read: 19448 HDFS Write: 6864 SUCCESS
Total MapReduce CPU Time Spent: 8 seconds 560 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 87.672 seconds
Dropped the partition year=2017/month=04/day=25
OK
Time taken: 0.473 seconds
OK
Time taken: 0.118 seconds
Query ID = busbi_20170502111415_67daab09-ce0d-4ae1-af75-93d84f91f203
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_618969, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_618969/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_618969
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 11:14:50,477 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:15:08,817 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 8.11 sec
MapReduce Total cumulative CPU time: 8 seconds 110 msec
Ended Job = job_1493104900716_618969
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_11-14-15_657_4634424220456393549-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=25)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/25/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=25} stats: [numFiles=1, numRows=24, totalSize=1878, rawDataSize=33208]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 8.11 sec   HDFS Read: 11112 HDFS Write: 1998 SUCCESS
Total MapReduce CPU Time Spent: 8 seconds 110 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 56.472 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:10:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 11:15:43 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:15:43 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 2.836 seconds
Query ID = busbi_20170502111554_9af068a0-3127-4aa9-810e-94aab1cbc7e7
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 171
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_619133, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_619133/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_619133
Hadoop job information for Stage-3: number of mappers: 160; number of reducers: 171
2017-05-02 11:16:40,712 Stage-3 map = 0%,  reduce = 0%
2017-05-02 11:17:00,356 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 13.46 sec
2017-05-02 11:17:03,464 Stage-3 map = 6%,  reduce = 0%, Cumulative CPU 1527.46 sec
2017-05-02 11:17:04,492 Stage-3 map = 8%,  reduce = 0%, Cumulative CPU 2003.82 sec
2017-05-02 11:17:05,522 Stage-3 map = 9%,  reduce = 0%, Cumulative CPU 2261.66 sec
2017-05-02 11:17:06,551 Stage-3 map = 23%,  reduce = 0%, Cumulative CPU 2687.37 sec
2017-05-02 11:17:07,578 Stage-3 map = 28%,  reduce = 0%, Cumulative CPU 3016.68 sec
2017-05-02 11:17:08,606 Stage-3 map = 37%,  reduce = 0%, Cumulative CPU 3130.02 sec
2017-05-02 11:17:09,634 Stage-3 map = 48%,  reduce = 0%, Cumulative CPU 3377.61 sec
2017-05-02 11:17:10,661 Stage-3 map = 62%,  reduce = 0%, Cumulative CPU 3571.33 sec
2017-05-02 11:17:11,688 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 3726.18 sec
2017-05-02 11:17:12,721 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 3825.5 sec
2017-05-02 11:17:13,747 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 3904.6 sec
2017-05-02 11:17:14,774 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 4007.57 sec
2017-05-02 11:17:15,820 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 4108.83 sec
2017-05-02 11:17:16,846 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 4205.99 sec
2017-05-02 11:17:17,872 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 4251.43 sec
2017-05-02 11:17:19,924 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 4395.51 sec
2017-05-02 11:17:22,997 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 4539.1 sec
2017-05-02 11:17:24,024 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 4580.75 sec
2017-05-02 11:17:25,048 Stage-3 map = 88%,  reduce = 0%, Cumulative CPU 4614.83 sec
2017-05-02 11:17:26,075 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 4659.37 sec
2017-05-02 11:17:28,129 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 4702.36 sec
2017-05-02 11:17:29,156 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 4733.52 sec
2017-05-02 11:17:31,207 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 4778.73 sec
2017-05-02 11:17:33,267 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 4837.04 sec
2017-05-02 11:17:35,323 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 4879.84 sec
2017-05-02 11:17:36,360 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 4901.76 sec
2017-05-02 11:17:37,416 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 4920.85 sec
2017-05-02 11:17:40,522 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 4930.69 sec
2017-05-02 11:17:43,622 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 4959.91 sec
2017-05-02 11:17:45,670 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 4975.35 sec
2017-05-02 11:17:55,907 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 4973.77 sec
2017-05-02 11:18:06,245 Stage-3 map = 100%,  reduce = 35%, Cumulative CPU 5584.07 sec
2017-05-02 11:18:07,269 Stage-3 map = 100%,  reduce = 52%, Cumulative CPU 5928.32 sec
2017-05-02 11:18:08,294 Stage-3 map = 100%,  reduce = 54%, Cumulative CPU 5964.25 sec
2017-05-02 11:18:14,443 Stage-3 map = 100%,  reduce = 60%, Cumulative CPU 6188.43 sec
2017-05-02 11:18:15,468 Stage-3 map = 100%,  reduce = 66%, Cumulative CPU 6401.65 sec
2017-05-02 11:18:16,495 Stage-3 map = 100%,  reduce = 74%, Cumulative CPU 6705.21 sec
2017-05-02 11:18:17,519 Stage-3 map = 100%,  reduce = 86%, Cumulative CPU 7141.65 sec
2017-05-02 11:18:18,546 Stage-3 map = 100%,  reduce = 91%, Cumulative CPU 7342.26 sec
2017-05-02 11:18:19,610 Stage-3 map = 100%,  reduce = 96%, Cumulative CPU 7576.71 sec
2017-05-02 11:18:20,634 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 7666.52 sec
2017-05-02 11:18:21,659 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 7697.5 sec
2017-05-02 11:18:24,734 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 7798.07 sec
MapReduce Total cumulative CPU time: 0 days 2 hours 9 minutes 58 seconds 70 msec
Ended Job = job_1493104900716_619133
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_619387, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_619387/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_619387
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 3
2017-05-02 11:18:52,349 Stage-4 map = 0%,  reduce = 0%
2017-05-02 11:19:52,883 Stage-4 map = 0%,  reduce = 0%
2017-05-02 11:20:05,277 Stage-4 map = 4%,  reduce = 0%, Cumulative CPU 36.02 sec
2017-05-02 11:20:08,385 Stage-4 map = 7%,  reduce = 0%, Cumulative CPU 40.51 sec
2017-05-02 11:20:11,473 Stage-4 map = 13%,  reduce = 0%, Cumulative CPU 46.89 sec
2017-05-02 11:20:14,563 Stage-4 map = 18%,  reduce = 0%, Cumulative CPU 54.87 sec
2017-05-02 11:20:17,663 Stage-4 map = 27%,  reduce = 0%, Cumulative CPU 63.81 sec
2017-05-02 11:20:20,770 Stage-4 map = 32%,  reduce = 0%, Cumulative CPU 74.51 sec
2017-05-02 11:20:23,870 Stage-4 map = 35%,  reduce = 0%, Cumulative CPU 81.53 sec
2017-05-02 11:20:24,921 Stage-4 map = 46%,  reduce = 0%, Cumulative CPU 86.03 sec
2017-05-02 11:20:26,976 Stage-4 map = 48%,  reduce = 0%, Cumulative CPU 94.38 sec
2017-05-02 11:20:30,052 Stage-4 map = 51%,  reduce = 0%, Cumulative CPU 101.3 sec
2017-05-02 11:20:33,129 Stage-4 map = 52%,  reduce = 0%, Cumulative CPU 104.8 sec
2017-05-02 11:20:34,163 Stage-4 map = 54%,  reduce = 0%, Cumulative CPU 108.23 sec
2017-05-02 11:20:37,257 Stage-4 map = 56%,  reduce = 0%, Cumulative CPU 113.24 sec
2017-05-02 11:20:39,338 Stage-4 map = 57%,  reduce = 0%, Cumulative CPU 116.61 sec
2017-05-02 11:20:40,368 Stage-4 map = 58%,  reduce = 0%, Cumulative CPU 119.87 sec
2017-05-02 11:20:42,435 Stage-4 map = 59%,  reduce = 0%, Cumulative CPU 122.83 sec
2017-05-02 11:20:43,463 Stage-4 map = 60%,  reduce = 0%, Cumulative CPU 125.68 sec
2017-05-02 11:20:45,512 Stage-4 map = 62%,  reduce = 0%, Cumulative CPU 131.19 sec
2017-05-02 11:20:46,540 Stage-4 map = 63%,  reduce = 0%, Cumulative CPU 137.61 sec
2017-05-02 11:20:48,656 Stage-4 map = 64%,  reduce = 0%, Cumulative CPU 143.61 sec
2017-05-02 11:20:49,687 Stage-4 map = 65%,  reduce = 0%, Cumulative CPU 150.0 sec
2017-05-02 11:20:51,741 Stage-4 map = 66%,  reduce = 0%, Cumulative CPU 156.37 sec
2017-05-02 11:20:52,765 Stage-4 map = 68%,  reduce = 0%, Cumulative CPU 162.78 sec
2017-05-02 11:20:55,841 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 172.66 sec
2017-05-02 11:21:00,975 Stage-4 map = 71%,  reduce = 0%, Cumulative CPU 142.51 sec
2017-05-02 11:21:04,057 Stage-4 map = 73%,  reduce = 0%, Cumulative CPU 146.18 sec
2017-05-02 11:21:05,081 Stage-4 map = 74%,  reduce = 0%, Cumulative CPU 152.39 sec
2017-05-02 11:21:08,180 Stage-4 map = 75%,  reduce = 0%, Cumulative CPU 158.65 sec
2017-05-02 11:21:10,260 Stage-4 map = 81%,  reduce = 0%, Cumulative CPU 162.21 sec
2017-05-02 11:21:11,291 Stage-4 map = 82%,  reduce = 0%, Cumulative CPU 165.16 sec
2017-05-02 11:21:13,355 Stage-4 map = 87%,  reduce = 0%, Cumulative CPU 168.24 sec
2017-05-02 11:21:14,380 Stage-4 map = 88%,  reduce = 0%, Cumulative CPU 172.59 sec
2017-05-02 11:21:17,458 Stage-4 map = 89%,  reduce = 0%, Cumulative CPU 175.32 sec
2017-05-02 11:21:28,761 Stage-4 map = 93%,  reduce = 0%, Cumulative CPU 136.25 sec
2017-05-02 11:21:31,842 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 139.52 sec
2017-05-02 11:21:47,277 Stage-4 map = 100%,  reduce = 63%, Cumulative CPU 165.43 sec
2017-05-02 11:21:50,360 Stage-4 map = 100%,  reduce = 67%, Cumulative CPU 186.16 sec
2017-05-02 11:21:53,434 Stage-4 map = 100%,  reduce = 75%, Cumulative CPU 202.05 sec
2017-05-02 11:21:56,512 Stage-4 map = 100%,  reduce = 81%, Cumulative CPU 212.27 sec
2017-05-02 11:21:59,592 Stage-4 map = 100%,  reduce = 90%, Cumulative CPU 224.26 sec
2017-05-02 11:22:02,671 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 238.52 sec
2017-05-02 11:22:03,696 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 240.72 sec
MapReduce Total cumulative CPU time: 4 minutes 0 seconds 720 msec
Ended Job = job_1493104900716_619387
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_619677, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_619677/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_619677
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 3
2017-05-02 11:22:44,249 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:22:53,508 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 3.58 sec
2017-05-02 11:22:57,632 Stage-1 map = 38%,  reduce = 0%, Cumulative CPU 16.03 sec
2017-05-02 11:23:10,051 Stage-1 map = 51%,  reduce = 0%, Cumulative CPU 54.21 sec
2017-05-02 11:23:13,153 Stage-1 map = 56%,  reduce = 0%, Cumulative CPU 63.02 sec
2017-05-02 11:23:16,270 Stage-1 map = 63%,  reduce = 0%, Cumulative CPU 70.8 sec
2017-05-02 11:23:19,366 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 77.35 sec
2017-05-02 11:23:26,570 Stage-1 map = 76%,  reduce = 0%, Cumulative CPU 90.38 sec
2017-05-02 11:23:35,835 Stage-1 map = 79%,  reduce = 0%, Cumulative CPU 105.19 sec
2017-05-02 11:23:54,337 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 94.24 sec
2017-05-02 11:23:57,396 Stage-1 map = 96%,  reduce = 0%, Cumulative CPU 98.04 sec
2017-05-02 11:24:03,518 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 105.14 sec
2017-05-02 11:24:16,793 Stage-1 map = 100%,  reduce = 23%, Cumulative CPU 116.71 sec
2017-05-02 11:24:17,814 Stage-1 map = 100%,  reduce = 79%, Cumulative CPU 142.16 sec
2017-05-02 11:24:19,857 Stage-1 map = 100%,  reduce = 85%, Cumulative CPU 150.15 sec
2017-05-02 11:24:22,921 Stage-1 map = 100%,  reduce = 91%, Cumulative CPU 158.63 sec
2017-05-02 11:24:25,985 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 165.64 sec
2017-05-02 11:24:29,048 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 168.92 sec
2017-05-02 11:24:32,106 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 171.45 sec
MapReduce Total cumulative CPU time: 2 minutes 51 seconds 450 msec
Ended Job = job_1493104900716_619677
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_619901, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_619901/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_619901
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 11:25:07,493 Stage-2 map = 0%,  reduce = 0%
2017-05-02 11:25:20,901 Stage-2 map = 4%,  reduce = 0%, Cumulative CPU 20.04 sec
2017-05-02 11:25:24,040 Stage-2 map = 11%,  reduce = 0%, Cumulative CPU 27.87 sec
2017-05-02 11:25:33,308 Stage-2 map = 33%,  reduce = 0%, Cumulative CPU 51.37 sec
2017-05-02 11:25:39,471 Stage-2 map = 53%,  reduce = 0%, Cumulative CPU 76.18 sec
2017-05-02 11:25:42,577 Stage-2 map = 70%,  reduce = 0%, Cumulative CPU 83.34 sec
2017-05-02 11:25:54,884 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 101.84 sec
2017-05-02 11:26:04,147 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 112.22 sec
2017-05-02 11:26:25,796 Stage-2 map = 100%,  reduce = 79%, Cumulative CPU 134.89 sec
2017-05-02 11:26:28,891 Stage-2 map = 100%,  reduce = 87%, Cumulative CPU 138.4 sec
2017-05-02 11:26:31,969 Stage-2 map = 100%,  reduce = 94%, Cumulative CPU 142.02 sec
2017-05-02 11:26:35,053 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 145.37 sec
MapReduce Total cumulative CPU time: 2 minutes 25 seconds 370 msec
Ended Job = job_1493104900716_619901
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 160  Reduce: 171   Cumulative CPU: 7808.22 sec   HDFS Read: 43543653563 HDFS Write: 530669732 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 3   Cumulative CPU: 240.72 sec   HDFS Read: 530737088 HDFS Write: 530651252 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 3   Cumulative CPU: 171.45 sec   HDFS Read: 530703951 HDFS Write: 529572406 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 145.37 sec   HDFS Read: 529588822 HDFS Write: 391056320 SUCCESS
Total MapReduce CPU Time Spent: 0 days 2 hours 19 minutes 25 seconds 760 msec
OK
Time taken: 643.409 seconds, Fetched: 5792764 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492963200, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 69.44}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 97.55}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 96.69}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 95.97}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 96.82}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.38}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 97.8}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 92.75}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 98.82}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.51}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.17}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 95.38}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 95.72}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 95.94}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 93.14}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.67}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.19}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.43}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 95.66}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 98.26}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.81}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 97.86}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 95.65}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:20:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170424' 
        and city_id = '7'
)q

17/05/02 11:28:22 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:28:22 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.277 seconds
Query ID = busbi_20170502112826_9abb1ef9-ea1a-434a-93f0-7acd6491e549
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_620396, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_620396/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_620396
Hadoop job information for Stage-1: number of mappers: 12; number of reducers: 1
2017-05-02 11:28:58,190 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:29:13,719 Stage-1 map = 11%,  reduce = 0%, Cumulative CPU 97.47 sec
2017-05-02 11:29:16,811 Stage-1 map = 14%,  reduce = 0%, Cumulative CPU 177.17 sec
2017-05-02 11:29:17,873 Stage-1 map = 25%,  reduce = 0%, Cumulative CPU 198.47 sec
2017-05-02 11:29:18,904 Stage-1 map = 36%,  reduce = 0%, Cumulative CPU 204.11 sec
2017-05-02 11:29:19,932 Stage-1 map = 44%,  reduce = 0%, Cumulative CPU 230.77 sec
2017-05-02 11:29:20,980 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 242.3 sec
2017-05-02 11:29:24,066 Stage-1 map = 53%,  reduce = 0%, Cumulative CPU 324.85 sec
2017-05-02 11:29:27,143 Stage-1 map = 56%,  reduce = 0%, Cumulative CPU 368.05 sec
2017-05-02 11:29:29,192 Stage-1 map = 58%,  reduce = 0%, Cumulative CPU 387.15 sec
2017-05-02 11:29:32,273 Stage-1 map = 64%,  reduce = 0%, Cumulative CPU 424.69 sec
2017-05-02 11:29:34,319 Stage-1 map = 69%,  reduce = 0%, Cumulative CPU 432.5 sec
2017-05-02 11:29:35,347 Stage-1 map = 78%,  reduce = 0%, Cumulative CPU 453.92 sec
2017-05-02 11:29:41,497 Stage-1 map = 83%,  reduce = 0%, Cumulative CPU 493.72 sec
2017-05-02 11:29:44,599 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 510.91 sec
2017-05-02 11:29:45,628 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 513.18 sec
2017-05-02 11:29:47,678 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 518.88 sec
2017-05-02 11:29:56,898 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 523.32 sec
MapReduce Total cumulative CPU time: 8 minutes 43 seconds 320 msec
Ended Job = job_1493104900716_620396
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 12  Reduce: 1   Cumulative CPU: 523.32 sec   HDFS Read: 2275830541 HDFS Write: 6 SUCCESS
Total MapReduce CPU Time Spent: 8 minutes 43 seconds 320 msec
OK
Time taken: 93.405 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:20:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 11:30:17 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/24/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170424(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170424;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170424 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170424';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='24');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='24') location '2017/04/24';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='24')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 11:30:20 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:30:20 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.02 seconds
OK
Time taken: 0.042 seconds
OK
Time taken: 0.38 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170424
Table transit_dw.tmp_abnormal_ratio_20170424 stats: [numFiles=1, numRows=0, totalSize=179, rawDataSize=0]
OK
Time taken: 0.431 seconds
Query ID = busbi_20170502113026_28d6a1ff-5284-4062-a715-a70b1593ecde
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_620748, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_620748/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_620748
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 11:31:14,547 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:31:28,312 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 7.14 sec
2017-05-02 11:31:38,808 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 11.99 sec
MapReduce Total cumulative CPU time: 11 seconds 990 msec
Ended Job = job_1493104900716_620748
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_11-30-26_992_3562686891788002322-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/fd4bb3bc-8264-4d5d-b69f-de1fae739c26/_tmp_space.db/ce4ba693-62eb-4b8f-b5f2-efcbf31828fd
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6151, rawDataSize=6127]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 11.99 sec   HDFS Read: 19349 HDFS Write: 6248 SUCCESS
Total MapReduce CPU Time Spent: 11 seconds 990 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 75.099 seconds
Dropped the partition year=2017/month=04/day=24
OK
Time taken: 0.17 seconds
OK
Time taken: 0.059 seconds
Query ID = busbi_20170502113142_865e7bf1-d2bc-4634-a7c9-787a3cdca56b
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_620891, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_620891/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_620891
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 11:32:21,602 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:32:39,359 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 3.04 sec
MapReduce Total cumulative CPU time: 3 seconds 40 msec
Ended Job = job_1493104900716_620891
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_11-31-42_323_3273000678290199800-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=24)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/24/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=24} stats: [numFiles=1, numRows=24, totalSize=1824, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 3.04 sec   HDFS Read: 10496 HDFS Write: 1944 SUCCESS
Total MapReduce CPU Time Spent: 3 seconds 40 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 58.464 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:30:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 11:32:56 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:32:56 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.796 seconds
Query ID = busbi_20170502113303_e51bd522-8b32-4f9c-bc4d-3d985d4ba77c
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 149
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_621038, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_621038/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_621038
Hadoop job information for Stage-3: number of mappers: 140; number of reducers: 149
2017-05-02 11:33:36,294 Stage-3 map = 0%,  reduce = 0%
2017-05-02 11:33:58,758 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 940.49 sec
2017-05-02 11:34:00,856 Stage-3 map = 3%,  reduce = 0%, Cumulative CPU 1147.94 sec
2017-05-02 11:34:13,251 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 1292.28 sec
2017-05-02 11:34:16,344 Stage-3 map = 5%,  reduce = 0%, Cumulative CPU 1321.0 sec
2017-05-02 11:34:26,686 Stage-3 map = 6%,  reduce = 0%, Cumulative CPU 1350.2 sec
2017-05-02 11:34:27,719 Stage-3 map = 10%,  reduce = 0%, Cumulative CPU 1432.15 sec
2017-05-02 11:34:28,802 Stage-3 map = 12%,  reduce = 0%, Cumulative CPU 1490.6 sec
2017-05-02 11:34:29,834 Stage-3 map = 14%,  reduce = 0%, Cumulative CPU 1568.53 sec
2017-05-02 11:34:35,006 Stage-3 map = 15%,  reduce = 0%, Cumulative CPU 1763.52 sec
2017-05-02 11:34:38,099 Stage-3 map = 16%,  reduce = 0%, Cumulative CPU 1922.29 sec
2017-05-02 11:34:41,190 Stage-3 map = 18%,  reduce = 0%, Cumulative CPU 2179.57 sec
2017-05-02 11:34:42,221 Stage-3 map = 19%,  reduce = 0%, Cumulative CPU 2308.37 sec
2017-05-02 11:34:43,251 Stage-3 map = 20%,  reduce = 0%, Cumulative CPU 2356.25 sec
2017-05-02 11:34:45,326 Stage-3 map = 21%,  reduce = 0%, Cumulative CPU 2466.25 sec
2017-05-02 11:34:46,358 Stage-3 map = 22%,  reduce = 0%, Cumulative CPU 2506.79 sec
2017-05-02 11:34:48,418 Stage-3 map = 24%,  reduce = 0%, Cumulative CPU 2578.4 sec
2017-05-02 11:34:49,447 Stage-3 map = 26%,  reduce = 0%, Cumulative CPU 2655.16 sec
2017-05-02 11:34:50,472 Stage-3 map = 32%,  reduce = 0%, Cumulative CPU 2746.81 sec
2017-05-02 11:34:51,500 Stage-3 map = 38%,  reduce = 0%, Cumulative CPU 2965.69 sec
2017-05-02 11:34:52,529 Stage-3 map = 44%,  reduce = 0%, Cumulative CPU 3103.73 sec
2017-05-02 11:34:53,551 Stage-3 map = 48%,  reduce = 0%, Cumulative CPU 3272.85 sec
2017-05-02 11:34:54,575 Stage-3 map = 52%,  reduce = 0%, Cumulative CPU 3410.89 sec
2017-05-02 11:34:55,598 Stage-3 map = 57%,  reduce = 0%, Cumulative CPU 3511.62 sec
2017-05-02 11:34:56,622 Stage-3 map = 60%,  reduce = 0%, Cumulative CPU 3629.23 sec
2017-05-02 11:34:57,647 Stage-3 map = 62%,  reduce = 0%, Cumulative CPU 3713.2 sec
2017-05-02 11:34:58,670 Stage-3 map = 65%,  reduce = 0%, Cumulative CPU 3767.67 sec
2017-05-02 11:34:59,693 Stage-3 map = 67%,  reduce = 0%, Cumulative CPU 3883.43 sec
2017-05-02 11:35:00,717 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 3969.66 sec
2017-05-02 11:35:01,742 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 3999.23 sec
2017-05-02 11:35:02,767 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 4043.24 sec
2017-05-02 11:35:03,791 Stage-3 map = 74%,  reduce = 0%, Cumulative CPU 4109.32 sec
2017-05-02 11:35:04,819 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 4137.7 sec
2017-05-02 11:35:05,843 Stage-3 map = 77%,  reduce = 0%, Cumulative CPU 4177.61 sec
2017-05-02 11:35:06,875 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 4235.42 sec
2017-05-02 11:35:08,941 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 4295.98 sec
2017-05-02 11:35:09,966 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 4335.58 sec
2017-05-02 11:35:10,992 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 4359.83 sec
2017-05-02 11:35:12,029 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 4384.08 sec
2017-05-02 11:35:13,058 Stage-3 map = 88%,  reduce = 0%, Cumulative CPU 4440.42 sec
2017-05-02 11:35:15,115 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 4475.39 sec
2017-05-02 11:35:16,156 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 4521.75 sec
2017-05-02 11:35:18,201 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 4548.13 sec
2017-05-02 11:35:19,223 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 4584.86 sec
2017-05-02 11:35:20,244 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 4600.55 sec
2017-05-02 11:35:22,288 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 4654.72 sec
2017-05-02 11:35:24,331 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 4645.85 sec
2017-05-02 11:35:25,354 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 4673.79 sec
2017-05-02 11:35:26,377 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 4680.28 sec
2017-05-02 11:35:27,406 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 4650.61 sec
2017-05-02 11:35:28,428 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 4666.55 sec
2017-05-02 11:35:33,575 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 4686.68 sec
2017-05-02 11:35:41,861 Stage-3 map = 100%,  reduce = 1%, Cumulative CPU 4708.0 sec
2017-05-02 11:35:42,882 Stage-3 map = 100%,  reduce = 2%, Cumulative CPU 4718.4 sec
2017-05-02 11:35:43,906 Stage-3 map = 100%,  reduce = 22%, Cumulative CPU 5034.73 sec
2017-05-02 11:35:44,924 Stage-3 map = 100%,  reduce = 63%, Cumulative CPU 5721.21 sec
2017-05-02 11:35:45,946 Stage-3 map = 100%,  reduce = 77%, Cumulative CPU 5971.13 sec
2017-05-02 11:35:46,968 Stage-3 map = 100%,  reduce = 85%, Cumulative CPU 6125.81 sec
2017-05-02 11:35:47,991 Stage-3 map = 100%,  reduce = 87%, Cumulative CPU 6151.61 sec
2017-05-02 11:35:50,037 Stage-3 map = 100%,  reduce = 91%, Cumulative CPU 6258.25 sec
2017-05-02 11:35:51,059 Stage-3 map = 100%,  reduce = 93%, Cumulative CPU 6322.16 sec
2017-05-02 11:35:52,081 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 6448.22 sec
2017-05-02 11:35:53,102 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 6538.82 sec
MapReduce Total cumulative CPU time: 0 days 1 hours 48 minutes 58 seconds 820 msec
Ended Job = job_1493104900716_621038
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_621232, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_621232/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_621232
Hadoop job information for Stage-4: number of mappers: 2; number of reducers: 2
2017-05-02 11:36:50,068 Stage-4 map = 0%,  reduce = 0%
2017-05-02 11:37:03,795 Stage-4 map = 17%,  reduce = 0%, Cumulative CPU 18.76 sec
2017-05-02 11:37:05,904 Stage-4 map = 28%,  reduce = 0%, Cumulative CPU 24.84 sec
2017-05-02 11:37:09,024 Stage-4 map = 40%,  reduce = 0%, Cumulative CPU 31.47 sec
2017-05-02 11:37:12,138 Stage-4 map = 47%,  reduce = 0%, Cumulative CPU 39.37 sec
2017-05-02 11:37:15,276 Stage-4 map = 53%,  reduce = 0%, Cumulative CPU 50.44 sec
2017-05-02 11:37:18,392 Stage-4 map = 57%,  reduce = 0%, Cumulative CPU 59.46 sec
2017-05-02 11:37:21,510 Stage-4 map = 65%,  reduce = 0%, Cumulative CPU 66.12 sec
2017-05-02 11:37:24,616 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 72.85 sec
2017-05-02 11:37:27,711 Stage-4 map = 92%,  reduce = 0%, Cumulative CPU 79.68 sec
2017-05-02 11:37:30,796 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 85.98 sec
2017-05-02 11:37:45,418 Stage-4 map = 100%,  reduce = 32%, Cumulative CPU 96.54 sec
2017-05-02 11:37:48,522 Stage-4 map = 100%,  reduce = 36%, Cumulative CPU 104.64 sec
2017-05-02 11:37:49,544 Stage-4 map = 100%,  reduce = 61%, Cumulative CPU 117.41 sec
2017-05-02 11:37:51,597 Stage-4 map = 100%,  reduce = 65%, Cumulative CPU 120.95 sec
2017-05-02 11:37:52,626 Stage-4 map = 100%,  reduce = 70%, Cumulative CPU 124.21 sec
2017-05-02 11:37:54,695 Stage-4 map = 100%,  reduce = 74%, Cumulative CPU 128.38 sec
2017-05-02 11:37:55,747 Stage-4 map = 100%,  reduce = 78%, Cumulative CPU 131.83 sec
2017-05-02 11:37:57,800 Stage-4 map = 100%,  reduce = 81%, Cumulative CPU 135.76 sec
2017-05-02 11:37:58,829 Stage-4 map = 100%,  reduce = 83%, Cumulative CPU 149.65 sec
2017-05-02 11:37:59,874 Stage-4 map = 100%,  reduce = 85%, Cumulative CPU 151.61 sec
2017-05-02 11:38:01,928 Stage-4 map = 100%,  reduce = 87%, Cumulative CPU 155.18 sec
2017-05-02 11:38:05,018 Stage-4 map = 100%,  reduce = 89%, Cumulative CPU 158.69 sec
2017-05-02 11:38:08,107 Stage-4 map = 100%,  reduce = 91%, Cumulative CPU 162.65 sec
2017-05-02 11:38:11,184 Stage-4 map = 100%,  reduce = 93%, Cumulative CPU 168.27 sec
2017-05-02 11:38:14,264 Stage-4 map = 100%,  reduce = 95%, Cumulative CPU 172.21 sec
2017-05-02 11:38:17,356 Stage-4 map = 100%,  reduce = 97%, Cumulative CPU 175.53 sec
2017-05-02 11:38:20,428 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 179.34 sec
2017-05-02 11:38:22,482 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 181.42 sec
MapReduce Total cumulative CPU time: 3 minutes 1 seconds 420 msec
Ended Job = job_1493104900716_621232
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_621463, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_621463/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_621463
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 2
2017-05-02 11:38:50,470 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:38:58,692 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 3.02 sec
2017-05-02 11:39:19,256 Stage-1 map = 56%,  reduce = 0%, Cumulative CPU 59.9 sec
2017-05-02 11:39:22,351 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 66.64 sec
2017-05-02 11:39:25,433 Stage-1 map = 75%,  reduce = 0%, Cumulative CPU 70.58 sec
2017-05-02 11:39:40,840 Stage-1 map = 81%,  reduce = 0%, Cumulative CPU 96.53 sec
2017-05-02 11:40:02,409 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 123.75 sec
2017-05-02 11:40:05,492 Stage-1 map = 90%,  reduce = 0%, Cumulative CPU 127.49 sec
2017-05-02 11:40:08,581 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 130.87 sec
2017-05-02 11:40:17,857 Stage-1 map = 99%,  reduce = 0%, Cumulative CPU 140.53 sec
2017-05-02 11:40:20,937 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 143.67 sec
2017-05-02 11:40:37,370 Stage-1 map = 100%,  reduce = 72%, Cumulative CPU 169.3 sec
2017-05-02 11:40:40,451 Stage-1 map = 100%,  reduce = 81%, Cumulative CPU 176.58 sec
2017-05-02 11:40:43,523 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 184.93 sec
2017-05-02 11:40:45,582 Stage-1 map = 100%,  reduce = 93%, Cumulative CPU 187.31 sec
2017-05-02 11:40:46,614 Stage-1 map = 100%,  reduce = 96%, Cumulative CPU 190.77 sec
2017-05-02 11:40:49,694 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 194.48 sec
2017-05-02 11:40:50,722 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 195.74 sec
MapReduce Total cumulative CPU time: 3 minutes 15 seconds 740 msec
Ended Job = job_1493104900716_621463
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_621695, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_621695/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_621695
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 11:41:25,249 Stage-2 map = 0%,  reduce = 0%
2017-05-02 11:41:47,001 Stage-2 map = 43%,  reduce = 0%, Cumulative CPU 40.52 sec
2017-05-02 11:41:50,096 Stage-2 map = 50%,  reduce = 0%, Cumulative CPU 53.38 sec
2017-05-02 11:41:56,294 Stage-2 map = 67%,  reduce = 0%, Cumulative CPU 68.77 sec
2017-05-02 11:42:02,477 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 78.93 sec
2017-05-02 11:42:05,564 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 82.91 sec
2017-05-02 11:42:23,064 Stage-2 map = 100%,  reduce = 83%, Cumulative CPU 101.57 sec
2017-05-02 11:42:26,151 Stage-2 map = 100%,  reduce = 93%, Cumulative CPU 104.88 sec
2017-05-02 11:42:29,228 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 107.99 sec
MapReduce Total cumulative CPU time: 1 minutes 47 seconds 990 msec
Ended Job = job_1493104900716_621695
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 140  Reduce: 149   Cumulative CPU: 6544.17 sec   HDFS Read: 38106937622 HDFS Write: 454935654 SUCCESS
Stage-Stage-4: Map: 2  Reduce: 2   Cumulative CPU: 181.42 sec   HDFS Read: 454990940 HDFS Write: 454919589 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 2   Cumulative CPU: 195.74 sec   HDFS Read: 454964365 HDFS Write: 453925538 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 107.99 sec   HDFS Read: 453941677 HDFS Write: 335558780 SUCCESS
Total MapReduce CPU Time Spent: 0 days 1 hours 57 minutes 9 seconds 320 msec
OK
Time taken: 567.741 seconds, Fetched: 4951371 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492876800, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 58.97}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 96.55}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 95.26}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 93.69}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 95.68}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 97.8}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 97.45}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 90.19}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 99.15}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.27}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 98.96}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 94.07}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 96.24}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 95.3}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 98.97}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.46}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.17}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 97.91}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 94.53}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 97.75}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.08}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 97.85}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 93.95}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170423' 
        and city_id = '7'
)q

17/05/02 11:44:06 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:44:06 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.236 seconds
Query ID = busbi_20170502114410_ee05454d-3964-4e3a-ac7a-adfb4dbfd9b1
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_622049, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_622049/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_622049
Hadoop job information for Stage-1: number of mappers: 9; number of reducers: 1
2017-05-02 11:44:42,211 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:44:57,860 Stage-1 map = 22%,  reduce = 0%, Cumulative CPU 117.98 sec
2017-05-02 11:45:01,997 Stage-1 map = 37%,  reduce = 0%, Cumulative CPU 153.0 sec
2017-05-02 11:45:03,032 Stage-1 map = 52%,  reduce = 0%, Cumulative CPU 161.22 sec
2017-05-02 11:45:04,066 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 169.39 sec
2017-05-02 11:45:46,407 Stage-1 map = 74%,  reduce = 0%, Cumulative CPU 307.99 sec
2017-05-02 11:45:48,468 Stage-1 map = 78%,  reduce = 0%, Cumulative CPU 310.6 sec
2017-05-02 11:46:08,146 Stage-1 map = 85%,  reduce = 0%, Cumulative CPU 340.2 sec
2017-05-02 11:46:10,223 Stage-1 map = 93%,  reduce = 0%, Cumulative CPU 348.27 sec
2017-05-02 11:46:12,287 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 353.0 sec
2017-05-02 11:46:22,588 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 357.52 sec
MapReduce Total cumulative CPU time: 5 minutes 57 seconds 520 msec
Ended Job = job_1493104900716_622049
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 9  Reduce: 1   Cumulative CPU: 357.52 sec   HDFS Read: 1776606433 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 5 minutes 57 seconds 520 msec
OK
Time taken: 133.739 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 11:46:34 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/23/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170423(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170423;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170423 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170423';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='23');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='23') location '2017/04/23';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='23')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 11:46:38 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:46:38 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.468 seconds
OK
Time taken: 0.416 seconds
OK
Time taken: 0.4 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170423
Table transit_dw.tmp_abnormal_ratio_20170423 stats: [numFiles=1, numRows=0, totalSize=181, rawDataSize=0]
OK
Time taken: 0.465 seconds
Query ID = busbi_20170502114645_b979c70a-5824-4d6e-b949-f723e2a31c38
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_622281, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_622281/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_622281
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 11:47:24,755 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:47:32,120 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 4.83 sec
2017-05-02 11:47:47,754 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 11.59 sec
MapReduce Total cumulative CPU time: 11 seconds 590 msec
Ended Job = job_1493104900716_622281
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_11-46-45_555_6323085216698046547-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/d1d248c4-d2fd-49db-bd6e-ae5e6cb5aec0/_tmp_space.db/af2e40d0-dd66-4815-bb2a-6d8621cee4b9
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6148, rawDataSize=6124]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 11.59 sec   HDFS Read: 19338 HDFS Write: 6245 SUCCESS
Total MapReduce CPU Time Spent: 11 seconds 590 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 67.01 seconds
Dropped the partition year=2017/month=04/day=23
OK
Time taken: 0.161 seconds
OK
Time taken: 0.068 seconds
Query ID = busbi_20170502114752_b9d4a675-f3f3-4508-a06a-99637952b19e
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_622365, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_622365/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_622365
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 11:48:23,873 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:48:31,160 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.44 sec
MapReduce Total cumulative CPU time: 2 seconds 440 msec
Ended Job = job_1493104900716_622365
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_11-47-52_797_7219828095986303414-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=23)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/23/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=23} stats: [numFiles=1, numRows=24, totalSize=1839, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 2.44 sec   HDFS Read: 10493 HDFS Write: 1959 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 440 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 40.47 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 11:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 11:48:50 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 11:48:50 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.025 seconds
Query ID = busbi_20170502114918_8a583c2d-4acd-4964-bc8c-073e479ac941
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 165
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_622445, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_622445/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_622445
Hadoop job information for Stage-3: number of mappers: 152; number of reducers: 165
2017-05-02 11:50:56,138 Stage-3 map = 0%,  reduce = 0%
2017-05-02 11:51:27,034 Stage-3 map = 3%,  reduce = 0%, Cumulative CPU 554.87 sec
2017-05-02 11:51:28,069 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 891.33 sec
2017-05-02 11:51:29,108 Stage-3 map = 7%,  reduce = 0%, Cumulative CPU 1696.79 sec
2017-05-02 11:51:30,150 Stage-3 map = 13%,  reduce = 0%, Cumulative CPU 2108.11 sec
2017-05-02 11:51:31,185 Stage-3 map = 15%,  reduce = 0%, Cumulative CPU 2232.7 sec
2017-05-02 11:51:32,247 Stage-3 map = 23%,  reduce = 0%, Cumulative CPU 2510.07 sec
2017-05-02 11:51:33,288 Stage-3 map = 30%,  reduce = 0%, Cumulative CPU 2837.31 sec
2017-05-02 11:51:34,318 Stage-3 map = 42%,  reduce = 0%, Cumulative CPU 3243.83 sec
2017-05-02 11:51:35,349 Stage-3 map = 52%,  reduce = 0%, Cumulative CPU 3443.93 sec
2017-05-02 11:51:36,379 Stage-3 map = 59%,  reduce = 0%, Cumulative CPU 3621.37 sec
2017-05-02 11:51:37,411 Stage-3 map = 65%,  reduce = 0%, Cumulative CPU 3833.57 sec
2017-05-02 11:51:38,444 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 3927.63 sec
2017-05-02 11:51:39,472 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 4031.8 sec
2017-05-02 11:51:40,513 Stage-3 map = 74%,  reduce = 0%, Cumulative CPU 4163.14 sec
2017-05-02 11:51:41,553 Stage-3 map = 75%,  reduce = 0%, Cumulative CPU 4218.32 sec
2017-05-02 11:51:42,590 Stage-3 map = 77%,  reduce = 0%, Cumulative CPU 4313.15 sec
2017-05-02 11:51:43,624 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 4419.3 sec
2017-05-02 11:51:44,659 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 4448.58 sec
2017-05-02 11:51:45,693 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 4519.01 sec
2017-05-02 11:51:46,722 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 4595.75 sec
2017-05-02 11:51:48,802 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 4672.22 sec
2017-05-02 11:51:49,847 Stage-3 map = 88%,  reduce = 0%, Cumulative CPU 4726.59 sec
2017-05-02 11:51:51,937 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 4777.32 sec
2017-05-02 11:51:52,979 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 4838.92 sec
2017-05-02 11:51:54,014 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 4869.62 sec
2017-05-02 11:51:56,091 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 4914.76 sec
2017-05-02 11:51:58,161 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 4962.68 sec
2017-05-02 11:51:59,197 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 4981.75 sec
2017-05-02 11:52:03,349 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 5027.39 sec
2017-05-02 11:52:05,410 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 4997.64 sec
2017-05-02 11:52:12,678 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 5022.69 sec
2017-05-02 11:52:24,264 Stage-3 map = 100%,  reduce = 1%, Cumulative CPU 5042.42 sec
2017-05-02 11:52:25,300 Stage-3 map = 100%,  reduce = 2%, Cumulative CPU 5049.94 sec
2017-05-02 11:52:26,331 Stage-3 map = 100%,  reduce = 17%, Cumulative CPU 5300.81 sec
2017-05-02 11:52:27,363 Stage-3 map = 100%,  reduce = 50%, Cumulative CPU 5883.05 sec
2017-05-02 11:52:28,401 Stage-3 map = 100%,  reduce = 53%, Cumulative CPU 5954.66 sec
2017-05-02 11:52:29,436 Stage-3 map = 100%,  reduce = 54%, Cumulative CPU 5967.17 sec
2017-05-02 11:52:30,479 Stage-3 map = 100%,  reduce = 56%, Cumulative CPU 6018.11 sec
2017-05-02 11:52:31,511 Stage-3 map = 100%,  reduce = 57%, Cumulative CPU 6032.43 sec
2017-05-02 11:52:32,549 Stage-3 map = 100%,  reduce = 65%, Cumulative CPU 6285.93 sec
2017-05-02 11:52:33,603 Stage-3 map = 100%,  reduce = 75%, Cumulative CPU 6629.23 sec
2017-05-02 11:52:34,644 Stage-3 map = 100%,  reduce = 88%, Cumulative CPU 7103.66 sec
2017-05-02 11:52:35,678 Stage-3 map = 100%,  reduce = 92%, Cumulative CPU 7253.31 sec
2017-05-02 11:52:36,717 Stage-3 map = 100%,  reduce = 93%, Cumulative CPU 7298.51 sec
2017-05-02 11:52:38,790 Stage-3 map = 100%,  reduce = 96%, Cumulative CPU 7388.85 sec
2017-05-02 11:52:41,924 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 7417.66 sec
2017-05-02 11:52:42,965 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 7443.65 sec
2017-05-02 11:52:45,060 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 7465.4 sec
2017-05-02 11:52:52,452 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 7555.95 sec
2017-05-02 11:53:52,762 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 7557.82 sec
MapReduce Total cumulative CPU time: 0 days 2 hours 5 minutes 57 seconds 820 msec
Ended Job = job_1493104900716_622445
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_622818, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_622818/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_622818
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 2
2017-05-02 11:54:30,636 Stage-4 map = 0%,  reduce = 0%
2017-05-02 11:54:44,061 Stage-4 map = 4%,  reduce = 0%, Cumulative CPU 9.81 sec
2017-05-02 11:54:47,159 Stage-4 map = 7%,  reduce = 0%, Cumulative CPU 12.33 sec
2017-05-02 11:54:50,255 Stage-4 map = 8%,  reduce = 0%, Cumulative CPU 14.43 sec
2017-05-02 11:54:53,354 Stage-4 map = 10%,  reduce = 0%, Cumulative CPU 27.38 sec
2017-05-02 11:54:56,429 Stage-4 map = 23%,  reduce = 0%, Cumulative CPU 44.84 sec
2017-05-02 11:54:59,514 Stage-4 map = 37%,  reduce = 0%, Cumulative CPU 52.19 sec
2017-05-02 11:55:01,571 Stage-4 map = 48%,  reduce = 0%, Cumulative CPU 57.45 sec
2017-05-02 11:55:02,600 Stage-4 map = 50%,  reduce = 0%, Cumulative CPU 62.02 sec
2017-05-02 11:55:03,623 Stage-4 map = 51%,  reduce = 0%, Cumulative CPU 64.34 sec
2017-05-02 11:55:05,671 Stage-4 map = 52%,  reduce = 0%, Cumulative CPU 68.71 sec
2017-05-02 11:55:08,776 Stage-4 map = 53%,  reduce = 0%, Cumulative CPU 73.4 sec
2017-05-02 11:55:09,803 Stage-4 map = 54%,  reduce = 0%, Cumulative CPU 75.29 sec
2017-05-02 11:55:12,879 Stage-4 map = 55%,  reduce = 0%, Cumulative CPU 77.52 sec
2017-05-02 11:55:15,965 Stage-4 map = 56%,  reduce = 0%, Cumulative CPU 79.48 sec
2017-05-02 11:55:19,040 Stage-4 map = 57%,  reduce = 0%, Cumulative CPU 81.64 sec
2017-05-02 11:55:21,106 Stage-4 map = 58%,  reduce = 0%, Cumulative CPU 82.83 sec
2017-05-02 11:55:22,132 Stage-4 map = 59%,  reduce = 0%, Cumulative CPU 85.85 sec
2017-05-02 11:55:24,189 Stage-4 map = 61%,  reduce = 0%, Cumulative CPU 87.53 sec
2017-05-02 11:55:25,223 Stage-4 map = 62%,  reduce = 0%, Cumulative CPU 89.75 sec
2017-05-02 11:55:27,276 Stage-4 map = 63%,  reduce = 0%, Cumulative CPU 91.79 sec
2017-05-02 11:55:28,304 Stage-4 map = 64%,  reduce = 0%, Cumulative CPU 94.01 sec
2017-05-02 11:55:30,359 Stage-4 map = 65%,  reduce = 0%, Cumulative CPU 97.52 sec
2017-05-02 11:55:31,394 Stage-4 map = 66%,  reduce = 0%, Cumulative CPU 100.17 sec
2017-05-02 11:55:33,448 Stage-4 map = 71%,  reduce = 0%, Cumulative CPU 103.52 sec
2017-05-02 11:55:34,470 Stage-4 map = 72%,  reduce = 0%, Cumulative CPU 106.13 sec
2017-05-02 11:55:35,498 Stage-4 map = 77%,  reduce = 0%, Cumulative CPU 109.32 sec
2017-05-02 11:55:37,555 Stage-4 map = 79%,  reduce = 0%, Cumulative CPU 112.67 sec
2017-05-02 11:55:40,639 Stage-4 map = 80%,  reduce = 0%, Cumulative CPU 115.42 sec
2017-05-02 11:55:43,720 Stage-4 map = 81%,  reduce = 0%, Cumulative CPU 119.22 sec
2017-05-02 11:55:46,797 Stage-4 map = 82%,  reduce = 0%, Cumulative CPU 124.95 sec
2017-05-02 11:55:49,874 Stage-4 map = 83%,  reduce = 0%, Cumulative CPU 131.28 sec
2017-05-02 11:55:52,946 Stage-4 map = 84%,  reduce = 0%, Cumulative CPU 137.46 sec
2017-05-02 11:56:05,255 Stage-4 map = 86%,  reduce = 0%, Cumulative CPU 150.48 sec
2017-05-02 11:56:08,336 Stage-4 map = 87%,  reduce = 0%, Cumulative CPU 153.83 sec
2017-05-02 11:56:11,404 Stage-4 map = 88%,  reduce = 0%, Cumulative CPU 156.37 sec
2017-05-02 11:56:14,493 Stage-4 map = 89%,  reduce = 0%, Cumulative CPU 159.4 sec
2017-05-02 11:56:23,736 Stage-4 map = 91%,  reduce = 0%, Cumulative CPU 170.11 sec
2017-05-02 11:56:26,820 Stage-4 map = 94%,  reduce = 0%, Cumulative CPU 173.51 sec
2017-05-02 11:56:37,079 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 181.79 sec
2017-05-02 11:56:58,605 Stage-4 map = 100%,  reduce = 32%, Cumulative CPU 198.92 sec
2017-05-02 11:56:59,628 Stage-4 map = 100%,  reduce = 63%, Cumulative CPU 207.74 sec
2017-05-02 11:57:01,675 Stage-4 map = 100%,  reduce = 70%, Cumulative CPU 224.37 sec
2017-05-02 11:57:04,749 Stage-4 map = 100%,  reduce = 77%, Cumulative CPU 231.39 sec
2017-05-02 11:57:07,830 Stage-4 map = 100%,  reduce = 83%, Cumulative CPU 240.14 sec
2017-05-02 11:57:10,920 Stage-4 map = 100%,  reduce = 91%, Cumulative CPU 247.72 sec
2017-05-02 11:57:14,004 Stage-4 map = 100%,  reduce = 98%, Cumulative CPU 254.76 sec
2017-05-02 11:57:15,033 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 257.3 sec
MapReduce Total cumulative CPU time: 4 minutes 17 seconds 300 msec
Ended Job = job_1493104900716_622818
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_623107, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_623107/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_623107
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 2
2017-05-02 11:57:38,839 Stage-1 map = 0%,  reduce = 0%
2017-05-02 11:57:46,011 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 2.99 sec
2017-05-02 11:58:32,000 Stage-1 map = 45%,  reduce = 0%, Cumulative CPU 67.82 sec
2017-05-02 11:58:37,110 Stage-1 map = 57%,  reduce = 0%, Cumulative CPU 93.69 sec
2017-05-02 11:58:41,197 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 93.33 sec
2017-05-02 11:58:44,287 Stage-1 map = 73%,  reduce = 0%, Cumulative CPU 100.44 sec
2017-05-02 11:58:47,357 Stage-1 map = 79%,  reduce = 0%, Cumulative CPU 106.63 sec
2017-05-02 11:59:04,746 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 126.79 sec
2017-05-02 11:59:07,803 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 130.75 sec
2017-05-02 11:59:16,983 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 140.56 sec
2017-05-02 11:59:33,309 Stage-1 map = 100%,  reduce = 73%, Cumulative CPU 166.34 sec
2017-05-02 11:59:36,369 Stage-1 map = 100%,  reduce = 81%, Cumulative CPU 174.16 sec
2017-05-02 11:59:39,444 Stage-1 map = 100%,  reduce = 89%, Cumulative CPU 182.21 sec
2017-05-02 11:59:41,484 Stage-1 map = 100%,  reduce = 92%, Cumulative CPU 184.48 sec
2017-05-02 11:59:42,506 Stage-1 map = 100%,  reduce = 94%, Cumulative CPU 187.8 sec
2017-05-02 11:59:45,564 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 191.07 sec
2017-05-02 11:59:48,627 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 194.33 sec
2017-05-02 11:59:49,651 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 195.97 sec
MapReduce Total cumulative CPU time: 3 minutes 15 seconds 970 msec
Ended Job = job_1493104900716_623107
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_623350, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_623350/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_623350
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 12:00:16,070 Stage-2 map = 0%,  reduce = 0%
2017-05-02 12:00:41,948 Stage-2 map = 10%,  reduce = 0%, Cumulative CPU 47.42 sec
2017-05-02 12:00:45,022 Stage-2 map = 14%,  reduce = 0%, Cumulative CPU 54.15 sec
2017-05-02 12:00:48,178 Stage-2 map = 31%,  reduce = 0%, Cumulative CPU 61.18 sec
2017-05-02 12:01:13,106 Stage-2 map = 50%,  reduce = 0%, Cumulative CPU 134.27 sec
2017-05-02 12:01:19,283 Stage-2 map = 74%,  reduce = 0%, Cumulative CPU 148.67 sec
2017-05-02 12:01:22,394 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 155.65 sec
2017-05-02 12:01:31,677 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 174.35 sec
2017-05-02 12:01:56,300 Stage-2 map = 100%,  reduce = 72%, Cumulative CPU 199.54 sec
2017-05-02 12:01:59,379 Stage-2 map = 100%,  reduce = 76%, Cumulative CPU 203.26 sec
2017-05-02 12:02:02,443 Stage-2 map = 100%,  reduce = 80%, Cumulative CPU 209.68 sec
2017-05-02 12:02:05,516 Stage-2 map = 100%,  reduce = 85%, Cumulative CPU 213.48 sec
2017-05-02 12:02:08,577 Stage-2 map = 100%,  reduce = 90%, Cumulative CPU 216.98 sec
2017-05-02 12:02:11,639 Stage-2 map = 100%,  reduce = 94%, Cumulative CPU 220.59 sec
2017-05-02 12:02:14,700 Stage-2 map = 100%,  reduce = 99%, Cumulative CPU 224.31 sec
2017-05-02 12:02:15,721 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 225.46 sec
MapReduce Total cumulative CPU time: 3 minutes 45 seconds 460 msec
Ended Job = job_1493104900716_623350
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 152  Reduce: 165   Cumulative CPU: 7558.9 sec   HDFS Read: 42211396293 HDFS Write: 502768174 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 2   Cumulative CPU: 257.3 sec   HDFS Read: 502830655 HDFS Write: 502750349 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 2   Cumulative CPU: 195.97 sec   HDFS Read: 502791798 HDFS Write: 501467863 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 225.46 sec   HDFS Read: 501483791 HDFS Write: 370793273 SUCCESS
Total MapReduce CPU Time Spent: 0 days 2 hours 17 minutes 17 seconds 630 msec
OK
Time taken: 779.358 seconds, Fetched: 5466116 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492790400, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 59.86}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 96.25}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 95.5}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 93.49}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 95.84}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.13}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 97.26}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 89.78}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 98.7}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.45}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.1}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 94.83}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 95.92}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 95.18}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 99.11}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.43}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.13}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.34}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 94.85}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 97.67}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 97.88}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 97.29}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 93.67}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:00:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170422' 
        and city_id = '7'
)q

17/05/02 12:03:47 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:03:47 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.151 seconds
Query ID = busbi_20170502120351_e1e26c4e-fdc4-4219-877d-746b44f9eb48
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_623811, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_623811/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_623811
Hadoop job information for Stage-1: number of mappers: 11; number of reducers: 1
2017-05-02 12:04:25,047 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:04:34,522 Stage-1 map = 9%,  reduce = 0%, Cumulative CPU 8.32 sec
2017-05-02 12:04:39,764 Stage-1 map = 15%,  reduce = 0%, Cumulative CPU 148.52 sec
2017-05-02 12:04:40,810 Stage-1 map = 30%,  reduce = 0%, Cumulative CPU 191.44 sec
2017-05-02 12:04:42,878 Stage-1 map = 42%,  reduce = 0%, Cumulative CPU 208.92 sec
2017-05-02 12:04:44,942 Stage-1 map = 61%,  reduce = 0%, Cumulative CPU 254.53 sec
2017-05-02 12:04:45,977 Stage-1 map = 76%,  reduce = 0%, Cumulative CPU 268.66 sec
2017-05-02 12:04:47,010 Stage-1 map = 82%,  reduce = 0%, Cumulative CPU 281.57 sec
2017-05-02 12:04:53,235 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 323.1 sec
2017-05-02 12:05:09,811 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 331.14 sec
MapReduce Total cumulative CPU time: 5 minutes 31 seconds 140 msec
Ended Job = job_1493104900716_623811
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 11  Reduce: 1   Cumulative CPU: 331.14 sec   HDFS Read: 2007701798 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 5 minutes 31 seconds 140 msec
OK
Time taken: 79.435 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:00:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 12:05:22 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/22/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170422(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170422;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170422 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170422';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='22');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='22') location '2017/04/22';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='22')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 12:05:26 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:05:26 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.636 seconds
OK
Time taken: 0.055 seconds
OK
Time taken: 0.392 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170422
Table transit_dw.tmp_abnormal_ratio_20170422 stats: [numFiles=1, numRows=0, totalSize=182, rawDataSize=0]
OK
Time taken: 0.421 seconds
Query ID = busbi_20170502120532_0db64332-abfb-4eaf-8bc1-5c7a194582e8
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_623986, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_623986/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_623986
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 12:05:57,010 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:06:14,663 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 12.23 sec
2017-05-02 12:06:35,385 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 23.48 sec
MapReduce Total cumulative CPU time: 23 seconds 480 msec
Ended Job = job_1493104900716_623986
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_12-05-32_137_3420183561115182799-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/610f8acd-a5d7-47c3-9c77-305f32165606/_tmp_space.db/764d05bd-8d14-45a7-8d29-d765417635c0
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6147, rawDataSize=6123]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 23.48 sec   HDFS Read: 19348 HDFS Write: 6244 SUCCESS
Total MapReduce CPU Time Spent: 23 seconds 480 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 67.057 seconds
Dropped the partition year=2017/month=04/day=22
OK
Time taken: 0.169 seconds
OK
Time taken: 0.157 seconds
Query ID = busbi_20170502120639_1233228e-da36-4fcd-a99e-62c48629b763
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_624092, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_624092/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_624092
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 12:06:58,071 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:07:11,498 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 6.74 sec
MapReduce Total cumulative CPU time: 6 seconds 740 msec
Ended Job = job_1493104900716_624092
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_12-06-39_524_3427826730068271831-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=22)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/22/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=22} stats: [numFiles=1, numRows=24, totalSize=1856, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 6.74 sec   HDFS Read: 10484 HDFS Write: 1976 SUCCESS
Total MapReduce CPU Time Spent: 6 seconds 740 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 34.454 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:00:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 12:07:29 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:07:29 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.032 seconds
Query ID = busbi_20170502120733_ecdc7b66-7f61-42c7-a05e-88e2e5d3d627
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 192
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_624198, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_624198/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_624198
Hadoop job information for Stage-3: number of mappers: 177; number of reducers: 192
2017-05-02 12:09:11,133 Stage-3 map = 0%,  reduce = 0%
2017-05-02 12:09:50,670 Stage-3 map = 3%,  reduce = 0%, Cumulative CPU 1034.14 sec
2017-05-02 12:09:51,716 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 1834.98 sec
2017-05-02 12:09:52,770 Stage-3 map = 6%,  reduce = 0%, Cumulative CPU 2370.78 sec
2017-05-02 12:09:53,820 Stage-3 map = 13%,  reduce = 0%, Cumulative CPU 2778.86 sec
2017-05-02 12:09:54,862 Stage-3 map = 19%,  reduce = 0%, Cumulative CPU 3055.82 sec
2017-05-02 12:09:55,911 Stage-3 map = 23%,  reduce = 0%, Cumulative CPU 3225.5 sec
2017-05-02 12:09:56,959 Stage-3 map = 32%,  reduce = 0%, Cumulative CPU 3545.39 sec
2017-05-02 12:09:57,996 Stage-3 map = 43%,  reduce = 0%, Cumulative CPU 3918.94 sec
2017-05-02 12:09:59,042 Stage-3 map = 54%,  reduce = 0%, Cumulative CPU 4318.46 sec
2017-05-02 12:10:00,080 Stage-3 map = 60%,  reduce = 0%, Cumulative CPU 4511.06 sec
2017-05-02 12:10:01,118 Stage-3 map = 67%,  reduce = 0%, Cumulative CPU 4664.29 sec
2017-05-02 12:10:02,155 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 4892.86 sec
2017-05-02 12:10:03,193 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 5024.26 sec
2017-05-02 12:10:04,238 Stage-3 map = 73%,  reduce = 0%, Cumulative CPU 5093.01 sec
2017-05-02 12:10:05,272 Stage-3 map = 74%,  reduce = 0%, Cumulative CPU 5266.3 sec
2017-05-02 12:10:06,314 Stage-3 map = 75%,  reduce = 0%, Cumulative CPU 5358.88 sec
2017-05-02 12:10:07,353 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 5426.43 sec
2017-05-02 12:10:08,391 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 5550.58 sec
2017-05-02 12:10:10,468 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 5650.44 sec
2017-05-02 12:10:11,504 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 5733.77 sec
2017-05-02 12:10:12,538 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 5793.21 sec
2017-05-02 12:10:14,619 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 5900.99 sec
2017-05-02 12:10:15,662 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 5946.51 sec
2017-05-02 12:10:17,767 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 6039.47 sec
2017-05-02 12:10:18,809 Stage-3 map = 88%,  reduce = 0%, Cumulative CPU 6091.03 sec
2017-05-02 12:10:19,861 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 6115.31 sec
2017-05-02 12:10:20,908 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 6179.87 sec
2017-05-02 12:10:22,999 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 6231.96 sec
2017-05-02 12:10:24,032 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 6289.68 sec
2017-05-02 12:10:25,098 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 6321.09 sec
2017-05-02 12:10:26,136 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 6345.25 sec
2017-05-02 12:10:28,214 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 6398.6 sec
2017-05-02 12:10:29,251 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 6415.6 sec
2017-05-02 12:10:30,293 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 6400.22 sec
2017-05-02 12:10:31,350 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 6416.47 sec
2017-05-02 12:10:33,419 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 6430.4 sec
2017-05-02 12:10:54,081 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 6492.65 sec
2017-05-02 12:11:06,923 Stage-3 map = 100%,  reduce = 1%, Cumulative CPU 6502.77 sec
2017-05-02 12:11:07,962 Stage-3 map = 100%,  reduce = 30%, Cumulative CPU 7081.72 sec
2017-05-02 12:11:08,995 Stage-3 map = 100%,  reduce = 68%, Cumulative CPU 7923.46 sec
2017-05-02 12:11:10,028 Stage-3 map = 100%,  reduce = 75%, Cumulative CPU 8087.63 sec
2017-05-02 12:11:11,064 Stage-3 map = 100%,  reduce = 78%, Cumulative CPU 8161.45 sec
2017-05-02 12:11:12,096 Stage-3 map = 100%,  reduce = 79%, Cumulative CPU 8173.94 sec
2017-05-02 12:11:13,137 Stage-3 map = 100%,  reduce = 81%, Cumulative CPU 8242.1 sec
2017-05-02 12:11:14,169 Stage-3 map = 100%,  reduce = 86%, Cumulative CPU 8440.3 sec
2017-05-02 12:11:15,210 Stage-3 map = 100%,  reduce = 88%, Cumulative CPU 8484.06 sec
2017-05-02 12:11:16,248 Stage-3 map = 100%,  reduce = 89%, Cumulative CPU 8525.53 sec
2017-05-02 12:11:17,313 Stage-3 map = 100%,  reduce = 90%, Cumulative CPU 8589.66 sec
2017-05-02 12:11:18,356 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 8911.35 sec
2017-05-02 12:11:19,398 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 8955.18 sec
2017-05-02 12:11:20,445 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 8974.15 sec
2017-05-02 12:11:41,130 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 9070.49 sec
MapReduce Total cumulative CPU time: 0 days 2 hours 31 minutes 10 seconds 490 msec
Ended Job = job_1493104900716_624198
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_624601, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_624601/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_624601
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 3
2017-05-02 12:12:17,801 Stage-4 map = 0%,  reduce = 0%
2017-05-02 12:12:34,259 Stage-4 map = 9%,  reduce = 0%, Cumulative CPU 40.1 sec
2017-05-02 12:12:37,344 Stage-4 map = 17%,  reduce = 0%, Cumulative CPU 49.68 sec
2017-05-02 12:12:40,439 Stage-4 map = 24%,  reduce = 0%, Cumulative CPU 59.15 sec
2017-05-02 12:12:43,516 Stage-4 map = 32%,  reduce = 0%, Cumulative CPU 69.73 sec
2017-05-02 12:12:46,605 Stage-4 map = 39%,  reduce = 0%, Cumulative CPU 79.92 sec
2017-05-02 12:12:49,687 Stage-4 map = 44%,  reduce = 0%, Cumulative CPU 90.02 sec
2017-05-02 12:12:52,770 Stage-4 map = 46%,  reduce = 0%, Cumulative CPU 99.03 sec
2017-05-02 12:12:55,844 Stage-4 map = 49%,  reduce = 0%, Cumulative CPU 110.06 sec
2017-05-02 12:12:56,866 Stage-4 map = 60%,  reduce = 0%, Cumulative CPU 111.22 sec
2017-05-02 12:12:58,942 Stage-4 map = 63%,  reduce = 0%, Cumulative CPU 122.04 sec
2017-05-02 12:13:02,032 Stage-4 map = 66%,  reduce = 0%, Cumulative CPU 134.65 sec
2017-05-02 12:13:05,117 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 147.79 sec
2017-05-02 12:13:17,472 Stage-4 map = 73%,  reduce = 0%, Cumulative CPU 171.67 sec
2017-05-02 12:13:20,591 Stage-4 map = 75%,  reduce = 0%, Cumulative CPU 176.01 sec
2017-05-02 12:13:23,681 Stage-4 map = 78%,  reduce = 0%, Cumulative CPU 181.19 sec
2017-05-02 12:13:32,920 Stage-4 map = 82%,  reduce = 0%, Cumulative CPU 198.82 sec
2017-05-02 12:13:36,016 Stage-4 map = 92%,  reduce = 0%, Cumulative CPU 209.05 sec
2017-05-02 12:13:39,091 Stage-4 map = 93%,  reduce = 0%, Cumulative CPU 215.42 sec
2017-05-02 12:13:42,177 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 221.69 sec
2017-05-02 12:14:03,749 Stage-4 map = 100%,  reduce = 48%, Cumulative CPU 253.0 sec
2017-05-02 12:14:06,839 Stage-4 map = 100%,  reduce = 59%, Cumulative CPU 262.95 sec
2017-05-02 12:14:09,951 Stage-4 map = 100%,  reduce = 67%, Cumulative CPU 273.34 sec
2017-05-02 12:14:13,038 Stage-4 map = 100%,  reduce = 68%, Cumulative CPU 311.59 sec
2017-05-02 12:14:16,119 Stage-4 map = 100%,  reduce = 72%, Cumulative CPU 333.96 sec
2017-05-02 12:14:19,194 Stage-4 map = 100%,  reduce = 76%, Cumulative CPU 344.38 sec
2017-05-02 12:14:22,278 Stage-4 map = 100%,  reduce = 81%, Cumulative CPU 355.67 sec
2017-05-02 12:14:25,369 Stage-4 map = 100%,  reduce = 86%, Cumulative CPU 369.12 sec
2017-05-02 12:14:28,455 Stage-4 map = 100%,  reduce = 89%, Cumulative CPU 385.16 sec
2017-05-02 12:14:31,547 Stage-4 map = 100%,  reduce = 93%, Cumulative CPU 398.31 sec
2017-05-02 12:14:34,628 Stage-4 map = 100%,  reduce = 94%, Cumulative CPU 402.33 sec
2017-05-02 12:14:35,680 Stage-4 map = 100%,  reduce = 96%, Cumulative CPU 409.22 sec
2017-05-02 12:14:37,736 Stage-4 map = 100%,  reduce = 97%, Cumulative CPU 412.36 sec
2017-05-02 12:14:38,765 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 422.6 sec
2017-05-02 12:14:40,814 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 427.42 sec
MapReduce Total cumulative CPU time: 7 minutes 7 seconds 420 msec
Ended Job = job_1493104900716_624601
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_624886, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_624886/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_624886
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 3
2017-05-02 12:14:57,616 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:15:13,054 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 7.9 sec
2017-05-02 12:15:27,460 Stage-1 map = 39%,  reduce = 0%, Cumulative CPU 66.1 sec
2017-05-02 12:15:42,849 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 87.24 sec
2017-05-02 12:15:45,930 Stage-1 map = 59%,  reduce = 0%, Cumulative CPU 95.14 sec
2017-05-02 12:15:49,011 Stage-1 map = 65%,  reduce = 0%, Cumulative CPU 101.96 sec
2017-05-02 12:15:52,083 Stage-1 map = 72%,  reduce = 0%, Cumulative CPU 111.39 sec
2017-05-02 12:15:58,244 Stage-1 map = 80%,  reduce = 0%, Cumulative CPU 130.77 sec
2017-05-02 12:16:12,648 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 107.48 sec
2017-05-02 12:16:15,724 Stage-1 map = 96%,  reduce = 0%, Cumulative CPU 111.15 sec
2017-05-02 12:16:21,876 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 117.34 sec
2017-05-02 12:16:36,230 Stage-1 map = 100%,  reduce = 57%, Cumulative CPU 141.35 sec
2017-05-02 12:16:37,251 Stage-1 map = 100%,  reduce = 80%, Cumulative CPU 153.92 sec
2017-05-02 12:16:39,303 Stage-1 map = 100%,  reduce = 82%, Cumulative CPU 157.66 sec
2017-05-02 12:16:40,333 Stage-1 map = 100%,  reduce = 86%, Cumulative CPU 161.27 sec
2017-05-02 12:16:42,382 Stage-1 map = 100%,  reduce = 88%, Cumulative CPU 165.47 sec
2017-05-02 12:16:43,404 Stage-1 map = 100%,  reduce = 93%, Cumulative CPU 169.91 sec
2017-05-02 12:16:44,430 Stage-1 map = 100%,  reduce = 95%, Cumulative CPU 171.76 sec
2017-05-02 12:16:45,457 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 175.14 sec
2017-05-02 12:16:48,535 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 178.39 sec
2017-05-02 12:16:49,556 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 180.46 sec
MapReduce Total cumulative CPU time: 3 minutes 0 seconds 460 msec
Ended Job = job_1493104900716_624886
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_625093, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_625093/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_625093
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 12:17:21,586 Stage-2 map = 0%,  reduce = 0%
2017-05-02 12:17:37,271 Stage-2 map = 7%,  reduce = 0%, Cumulative CPU 13.34 sec
2017-05-02 12:17:49,848 Stage-2 map = 20%,  reduce = 0%, Cumulative CPU 47.78 sec
2017-05-02 12:17:57,083 Stage-2 map = 27%,  reduce = 0%, Cumulative CPU 65.22 sec
2017-05-02 12:18:02,253 Stage-2 map = 40%,  reduce = 0%, Cumulative CPU 76.28 sec
2017-05-02 12:18:07,391 Stage-2 map = 57%,  reduce = 0%, Cumulative CPU 89.73 sec
2017-05-02 12:18:21,775 Stage-2 map = 75%,  reduce = 0%, Cumulative CPU 121.27 sec
2017-05-02 12:18:40,561 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 144.7 sec
2017-05-02 12:18:49,922 Stage-2 map = 87%,  reduce = 0%, Cumulative CPU 155.42 sec
2017-05-02 12:18:53,024 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 158.83 sec
2017-05-02 12:19:16,626 Stage-2 map = 100%,  reduce = 78%, Cumulative CPU 182.61 sec
2017-05-02 12:19:19,719 Stage-2 map = 100%,  reduce = 85%, Cumulative CPU 186.01 sec
2017-05-02 12:19:22,804 Stage-2 map = 100%,  reduce = 92%, Cumulative CPU 189.75 sec
2017-05-02 12:19:25,910 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 194.57 sec
MapReduce Total cumulative CPU time: 3 minutes 14 seconds 570 msec
Ended Job = job_1493104900716_625093
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 177  Reduce: 192   Cumulative CPU: 9070.49 sec   HDFS Read: 49063428731 HDFS Write: 585504739 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 3   Cumulative CPU: 427.42 sec   HDFS Read: 585578416 HDFS Write: 585483644 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 3   Cumulative CPU: 180.46 sec   HDFS Read: 585534585 HDFS Write: 584316165 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 194.57 sec   HDFS Read: 584331992 HDFS Write: 431331242 SUCCESS
Total MapReduce CPU Time Spent: 0 days 2 hours 44 minutes 32 seconds 940 msec
OK
Time taken: 714.351 seconds, Fetched: 6392528 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492704000, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 67.33}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 97.28}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 96.57}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 95.48}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 96.49}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.09}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 97.44}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 92.12}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 99.36}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.4}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.13}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 95.4}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 96.71}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 96.35}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 99.02}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.56}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.12}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.04}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 95.13}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 97.77}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.37}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 97.51}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 94.82}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:20:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170421' 
        and city_id = '7'
)q

17/05/02 12:21:33 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:21:33 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.058 seconds
Query ID = busbi_20170502122137_e4812ca3-48de-4f4e-88d3-ee3fdf335121
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_625515, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_625515/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_625515
Hadoop job information for Stage-1: number of mappers: 13; number of reducers: 1
2017-05-02 12:21:56,633 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:22:11,329 Stage-1 map = 8%,  reduce = 0%, Cumulative CPU 200.33 sec
2017-05-02 12:22:12,367 Stage-1 map = 38%,  reduce = 0%, Cumulative CPU 274.68 sec
2017-05-02 12:22:14,439 Stage-1 map = 54%,  reduce = 0%, Cumulative CPU 290.43 sec
2017-05-02 12:22:16,520 Stage-1 map = 69%,  reduce = 0%, Cumulative CPU 346.84 sec
2017-05-02 12:22:17,556 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 369.09 sec
2017-05-02 12:22:24,811 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 372.54 sec
MapReduce Total cumulative CPU time: 6 minutes 12 seconds 540 msec
Ended Job = job_1493104900716_625515
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 13  Reduce: 1   Cumulative CPU: 372.54 sec   HDFS Read: 2497277616 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 6 minutes 12 seconds 540 msec
OK
Time taken: 49.445 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:20:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 12:22:39 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/21/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170421(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170421;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170421 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170421';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='21');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='21') location '2017/04/21';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='21')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 12:22:43 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:22:43 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.265 seconds
OK
Time taken: 0.06 seconds
OK
Time taken: 4.604 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170421
Table transit_dw.tmp_abnormal_ratio_20170421 stats: [numFiles=1, numRows=0, totalSize=180, rawDataSize=0]
OK
Time taken: 28.708 seconds
Query ID = busbi_20170502122348_d350bf71-b1ca-4011-b28b-d813d5ad44ab
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_625612, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_625612/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_625612
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 12:24:26,417 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:24:33,863 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 4.73 sec
2017-05-02 12:24:42,164 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 8.33 sec
MapReduce Total cumulative CPU time: 8 seconds 330 msec
Ended Job = job_1493104900716_625612
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_12-23-48_902_7373717011991347291-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/66dd8482-dc0d-4529-a1c2-8440915e7273/_tmp_space.db/6faaecdb-7109-43e6-a98b-54ae649b58b1
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6147, rawDataSize=6123]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 8.33 sec   HDFS Read: 19326 HDFS Write: 6244 SUCCESS
Total MapReduce CPU Time Spent: 8 seconds 330 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 57.945 seconds
Dropped the partition year=2017/month=04/day=21
OK
Time taken: 0.161 seconds
OK
Time taken: 0.067 seconds
Query ID = busbi_20170502122447_cafe6119-09c0-4bcb-8fb0-0dde2951dd10
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_625712, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_625712/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_625712
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 12:24:59,409 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:25:07,641 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.82 sec
MapReduce Total cumulative CPU time: 2 seconds 820 msec
Ended Job = job_1493104900716_625712
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_12-24-47_079_1588037320518429072-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=21)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/21/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=21} stats: [numFiles=1, numRows=24, totalSize=1830, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 2.82 sec   HDFS Read: 10492 HDFS Write: 1950 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 820 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 22.452 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:20:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 12:25:24 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:25:24 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.983 seconds
Query ID = busbi_20170502122529_7e61acbc-83cc-4782-a309-48d84aebbecf
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 174
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_625774, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_625774/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_625774
Hadoop job information for Stage-3: number of mappers: 161; number of reducers: 174
2017-05-02 12:25:45,030 Stage-3 map = 0%,  reduce = 0%
2017-05-02 12:26:14,686 Stage-3 map = 2%,  reduce = 0%, Cumulative CPU 629.31 sec
2017-05-02 12:26:17,795 Stage-3 map = 7%,  reduce = 0%, Cumulative CPU 933.19 sec
2017-05-02 12:26:18,829 Stage-3 map = 8%,  reduce = 0%, Cumulative CPU 970.17 sec
2017-05-02 12:26:19,874 Stage-3 map = 9%,  reduce = 0%, Cumulative CPU 1230.02 sec
2017-05-02 12:26:20,905 Stage-3 map = 15%,  reduce = 0%, Cumulative CPU 1546.59 sec
2017-05-02 12:26:21,969 Stage-3 map = 20%,  reduce = 0%, Cumulative CPU 1953.23 sec
2017-05-02 12:26:23,000 Stage-3 map = 22%,  reduce = 0%, Cumulative CPU 2281.57 sec
2017-05-02 12:26:24,030 Stage-3 map = 24%,  reduce = 0%, Cumulative CPU 2490.64 sec
2017-05-02 12:26:25,062 Stage-3 map = 25%,  reduce = 0%, Cumulative CPU 2740.05 sec
2017-05-02 12:26:26,088 Stage-3 map = 26%,  reduce = 0%, Cumulative CPU 2930.04 sec
2017-05-02 12:26:29,179 Stage-3 map = 27%,  reduce = 0%, Cumulative CPU 3561.97 sec
2017-05-02 12:26:30,211 Stage-3 map = 28%,  reduce = 0%, Cumulative CPU 3733.31 sec
2017-05-02 12:26:32,270 Stage-3 map = 29%,  reduce = 0%, Cumulative CPU 4195.41 sec
2017-05-02 12:26:34,335 Stage-3 map = 30%,  reduce = 0%, Cumulative CPU 4634.67 sec
2017-05-02 12:26:35,367 Stage-3 map = 31%,  reduce = 0%, Cumulative CPU 4821.9 sec
2017-05-02 12:26:37,433 Stage-3 map = 32%,  reduce = 0%, Cumulative CPU 5097.18 sec
2017-05-02 12:26:38,458 Stage-3 map = 33%,  reduce = 0%, Cumulative CPU 5317.57 sec
2017-05-02 12:26:39,487 Stage-3 map = 34%,  reduce = 0%, Cumulative CPU 5463.68 sec
2017-05-02 12:26:41,560 Stage-3 map = 36%,  reduce = 0%, Cumulative CPU 5840.81 sec
2017-05-02 12:26:42,593 Stage-3 map = 37%,  reduce = 0%, Cumulative CPU 5977.79 sec
2017-05-02 12:26:43,618 Stage-3 map = 39%,  reduce = 0%, Cumulative CPU 6102.88 sec
2017-05-02 12:26:44,647 Stage-3 map = 40%,  reduce = 0%, Cumulative CPU 6287.35 sec
2017-05-02 12:26:45,687 Stage-3 map = 43%,  reduce = 0%, Cumulative CPU 6433.87 sec
2017-05-02 12:26:46,720 Stage-3 map = 46%,  reduce = 0%, Cumulative CPU 6597.01 sec
2017-05-02 12:26:47,753 Stage-3 map = 48%,  reduce = 0%, Cumulative CPU 6754.72 sec
2017-05-02 12:26:48,810 Stage-3 map = 49%,  reduce = 0%, Cumulative CPU 6883.17 sec
2017-05-02 12:26:50,880 Stage-3 map = 51%,  reduce = 0%, Cumulative CPU 7135.04 sec
2017-05-02 12:26:51,923 Stage-3 map = 53%,  reduce = 0%, Cumulative CPU 7258.6 sec
2017-05-02 12:26:52,957 Stage-3 map = 55%,  reduce = 0%, Cumulative CPU 7349.12 sec
2017-05-02 12:26:53,996 Stage-3 map = 57%,  reduce = 0%, Cumulative CPU 7483.71 sec
2017-05-02 12:26:55,025 Stage-3 map = 59%,  reduce = 0%, Cumulative CPU 7596.16 sec
2017-05-02 12:26:56,063 Stage-3 map = 60%,  reduce = 0%, Cumulative CPU 7669.52 sec
2017-05-02 12:26:57,090 Stage-3 map = 61%,  reduce = 0%, Cumulative CPU 7773.49 sec
2017-05-02 12:26:58,114 Stage-3 map = 64%,  reduce = 0%, Cumulative CPU 7874.27 sec
2017-05-02 12:26:59,142 Stage-3 map = 65%,  reduce = 0%, Cumulative CPU 7952.37 sec
2017-05-02 12:27:00,175 Stage-3 map = 67%,  reduce = 0%, Cumulative CPU 8040.57 sec
2017-05-02 12:27:01,201 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 8120.34 sec
2017-05-02 12:27:02,226 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 8177.28 sec
2017-05-02 12:27:03,252 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 8255.56 sec
2017-05-02 12:27:04,283 Stage-3 map = 73%,  reduce = 0%, Cumulative CPU 8331.01 sec
2017-05-02 12:27:05,341 Stage-3 map = 74%,  reduce = 0%, Cumulative CPU 8392.94 sec
2017-05-02 12:27:07,420 Stage-3 map = 75%,  reduce = 0%, Cumulative CPU 8527.01 sec
2017-05-02 12:27:08,459 Stage-3 map = 77%,  reduce = 0%, Cumulative CPU 8591.7 sec
2017-05-02 12:27:09,492 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 8632.12 sec
2017-05-02 12:27:10,529 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 8701.58 sec
2017-05-02 12:27:11,565 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 8754.9 sec
2017-05-02 12:27:12,609 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 8806.69 sec
2017-05-02 12:27:13,634 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 8862.73 sec
2017-05-02 12:27:14,662 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 8906.04 sec
2017-05-02 12:27:15,695 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 8951.78 sec
2017-05-02 12:27:17,758 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 9034.95 sec
2017-05-02 12:27:18,792 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 9075.21 sec
2017-05-02 12:27:19,825 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 9135.56 sec
2017-05-02 12:27:20,876 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 9167.54 sec
2017-05-02 12:27:21,904 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 9198.94 sec
2017-05-02 12:27:22,935 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 9235.99 sec
2017-05-02 12:27:23,965 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 9254.46 sec
2017-05-02 12:27:24,992 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 9241.29 sec
2017-05-02 12:27:26,022 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 9268.79 sec
2017-05-02 12:27:28,105 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 9290.47 sec
2017-05-02 12:27:29,131 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 9307.31 sec
2017-05-02 12:27:36,363 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 9117.01 sec
2017-05-02 12:27:37,389 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 9123.16 sec
2017-05-02 12:27:55,911 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 9210.29 sec
2017-05-02 12:28:24,638 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 9274.24 sec
2017-05-02 12:28:34,111 Stage-3 map = 100%,  reduce = 5%, Cumulative CPU 9349.91 sec
2017-05-02 12:28:35,139 Stage-3 map = 100%,  reduce = 34%, Cumulative CPU 9835.43 sec
2017-05-02 12:28:36,169 Stage-3 map = 100%,  reduce = 50%, Cumulative CPU 10138.25 sec
2017-05-02 12:28:37,192 Stage-3 map = 100%,  reduce = 60%, Cumulative CPU 10327.24 sec
2017-05-02 12:28:38,217 Stage-3 map = 100%,  reduce = 63%, Cumulative CPU 10397.72 sec
2017-05-02 12:28:39,244 Stage-3 map = 100%,  reduce = 66%, Cumulative CPU 10451.29 sec
2017-05-02 12:28:40,267 Stage-3 map = 100%,  reduce = 70%, Cumulative CPU 10605.31 sec
2017-05-02 12:28:41,293 Stage-3 map = 100%,  reduce = 75%, Cumulative CPU 10786.61 sec
2017-05-02 12:28:42,317 Stage-3 map = 100%,  reduce = 77%, Cumulative CPU 10860.58 sec
2017-05-02 12:28:43,343 Stage-3 map = 100%,  reduce = 81%, Cumulative CPU 10994.55 sec
2017-05-02 12:28:44,367 Stage-3 map = 100%,  reduce = 87%, Cumulative CPU 11237.92 sec
2017-05-02 12:28:45,399 Stage-3 map = 100%,  reduce = 91%, Cumulative CPU 11374.61 sec
2017-05-02 12:28:46,422 Stage-3 map = 100%,  reduce = 92%, Cumulative CPU 11406.01 sec
2017-05-02 12:28:47,451 Stage-3 map = 100%,  reduce = 93%, Cumulative CPU 11438.34 sec
2017-05-02 12:28:48,478 Stage-3 map = 100%,  reduce = 94%, Cumulative CPU 11487.46 sec
2017-05-02 12:28:51,563 Stage-3 map = 98%,  reduce = 95%, Cumulative CPU 11301.39 sec
2017-05-02 12:28:53,618 Stage-3 map = 98%,  reduce = 96%, Cumulative CPU 11334.27 sec
2017-05-02 12:28:59,772 Stage-3 map = 98%,  reduce = 97%, Cumulative CPU 11408.52 sec
2017-05-02 12:29:01,821 Stage-3 map = 98%,  reduce = 98%, Cumulative CPU 11417.25 sec
2017-05-02 12:29:12,137 Stage-3 map = 99%,  reduce = 98%, Cumulative CPU 11523.64 sec
2017-05-02 12:29:39,926 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 11561.21 sec
2017-05-02 12:29:41,976 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11573.84 sec
2017-05-02 12:29:55,333 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 11664.5 sec
MapReduce Total cumulative CPU time: 0 days 3 hours 14 minutes 24 seconds 500 msec
Ended Job = job_1493104900716_625774
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_626170, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_626170/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_626170
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 3
2017-05-02 12:30:08,527 Stage-4 map = 0%,  reduce = 0%
2017-05-02 12:30:20,942 Stage-4 map = 22%,  reduce = 0%
2017-05-02 12:30:21,967 Stage-4 map = 33%,  reduce = 0%, Cumulative CPU 28.17 sec
2017-05-02 12:30:22,989 Stage-4 map = 44%,  reduce = 0%, Cumulative CPU 30.19 sec
2017-05-02 12:30:24,012 Stage-4 map = 47%,  reduce = 0%, Cumulative CPU 33.59 sec
2017-05-02 12:30:25,045 Stage-4 map = 51%,  reduce = 0%, Cumulative CPU 36.95 sec
2017-05-02 12:30:27,088 Stage-4 map = 54%,  reduce = 0%, Cumulative CPU 40.02 sec
2017-05-02 12:30:28,110 Stage-4 map = 58%,  reduce = 0%, Cumulative CPU 43.54 sec
2017-05-02 12:30:30,175 Stage-4 map = 61%,  reduce = 0%, Cumulative CPU 47.01 sec
2017-05-02 12:30:31,193 Stage-4 map = 63%,  reduce = 0%, Cumulative CPU 51.25 sec
2017-05-02 12:30:33,240 Stage-4 map = 66%,  reduce = 0%, Cumulative CPU 57.45 sec
2017-05-02 12:30:34,262 Stage-4 map = 68%,  reduce = 0%, Cumulative CPU 63.72 sec
2017-05-02 12:30:36,309 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 71.5 sec
2017-05-02 12:30:39,375 Stage-4 map = 73%,  reduce = 0%, Cumulative CPU 77.59 sec
2017-05-02 12:30:42,435 Stage-4 map = 78%,  reduce = 0%, Cumulative CPU 84.12 sec
2017-05-02 12:30:45,523 Stage-4 map = 83%,  reduce = 0%, Cumulative CPU 91.69 sec
2017-05-02 12:30:48,675 Stage-4 map = 93%,  reduce = 0%, Cumulative CPU 98.35 sec
2017-05-02 12:30:51,740 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 104.79 sec
2017-05-02 12:31:05,011 Stage-4 map = 100%,  reduce = 67%, Cumulative CPU 141.51 sec
2017-05-02 12:31:08,081 Stage-4 map = 100%,  reduce = 79%, Cumulative CPU 158.96 sec
2017-05-02 12:31:11,151 Stage-4 map = 100%,  reduce = 90%, Cumulative CPU 170.58 sec
2017-05-02 12:31:13,230 Stage-4 map = 100%,  reduce = 93%, Cumulative CPU 173.75 sec
2017-05-02 12:31:14,253 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 183.0 sec
2017-05-02 12:31:15,277 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 184.6 sec
MapReduce Total cumulative CPU time: 3 minutes 4 seconds 600 msec
Ended Job = job_1493104900716_626170
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_626402, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_626402/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_626402
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 3
2017-05-02 12:31:51,223 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:32:08,754 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 6.27 sec
2017-05-02 12:32:33,548 Stage-1 map = 47%,  reduce = 0%, Cumulative CPU 65.13 sec
2017-05-02 12:32:36,623 Stage-1 map = 61%,  reduce = 0%, Cumulative CPU 75.99 sec
2017-05-02 12:32:42,781 Stage-1 map = 73%,  reduce = 0%, Cumulative CPU 94.22 sec
2017-05-02 12:32:45,853 Stage-1 map = 79%,  reduce = 0%, Cumulative CPU 104.95 sec
2017-05-02 12:33:04,340 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 87.45 sec
2017-05-02 12:33:10,550 Stage-1 map = 96%,  reduce = 0%, Cumulative CPU 94.7 sec
2017-05-02 12:33:13,641 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 97.79 sec
2017-05-02 12:33:27,968 Stage-1 map = 100%,  reduce = 81%, Cumulative CPU 134.68 sec
2017-05-02 12:33:31,059 Stage-1 map = 100%,  reduce = 88%, Cumulative CPU 141.85 sec
2017-05-02 12:33:34,128 Stage-1 map = 100%,  reduce = 96%, Cumulative CPU 151.06 sec
2017-05-02 12:33:37,190 Stage-1 map = 100%,  reduce = 98%, Cumulative CPU 154.43 sec
2017-05-02 12:33:40,264 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 157.05 sec
MapReduce Total cumulative CPU time: 2 minutes 37 seconds 50 msec
Ended Job = job_1493104900716_626402
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_626716, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_626716/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_626716
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 12:34:16,115 Stage-2 map = 0%,  reduce = 0%
2017-05-02 12:34:29,458 Stage-2 map = 5%,  reduce = 0%, Cumulative CPU 22.03 sec
2017-05-02 12:34:32,536 Stage-2 map = 11%,  reduce = 0%, Cumulative CPU 29.79 sec
2017-05-02 12:34:41,790 Stage-2 map = 34%,  reduce = 0%, Cumulative CPU 54.45 sec
2017-05-02 12:34:44,866 Stage-2 map = 40%,  reduce = 0%, Cumulative CPU 66.86 sec
2017-05-02 12:34:47,948 Stage-2 map = 53%,  reduce = 0%, Cumulative CPU 77.26 sec
2017-05-02 12:34:51,039 Stage-2 map = 70%,  reduce = 0%, Cumulative CPU 85.48 sec
2017-05-02 12:35:03,393 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 103.39 sec
2017-05-02 12:35:09,569 Stage-2 map = 87%,  reduce = 0%, Cumulative CPU 110.32 sec
2017-05-02 12:35:12,643 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 113.57 sec
2017-05-02 12:35:31,212 Stage-2 map = 100%,  reduce = 77%, Cumulative CPU 131.76 sec
2017-05-02 12:35:34,309 Stage-2 map = 100%,  reduce = 84%, Cumulative CPU 137.1 sec
2017-05-02 12:35:37,432 Stage-2 map = 100%,  reduce = 91%, Cumulative CPU 140.97 sec
2017-05-02 12:35:40,510 Stage-2 map = 100%,  reduce = 97%, Cumulative CPU 144.61 sec
2017-05-02 12:35:41,544 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 147.21 sec
MapReduce Total cumulative CPU time: 2 minutes 27 seconds 210 msec
Ended Job = job_1493104900716_626716
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 161  Reduce: 174   Cumulative CPU: 11664.5 sec   HDFS Read: 44341669419 HDFS Write: 528840875 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 3   Cumulative CPU: 184.6 sec   HDFS Read: 528909134 HDFS Write: 528821790 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 3   Cumulative CPU: 157.05 sec   HDFS Read: 528875514 HDFS Write: 527745948 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 147.21 sec   HDFS Read: 527761178 HDFS Write: 389404201 SUCCESS
Total MapReduce CPU Time Spent: 0 days 3 hours 22 minutes 33 seconds 360 msec
OK
Time taken: 615.507 seconds, Fetched: 5780180 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492617600, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 70.19}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 98.05}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 96.7}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 96.14}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 96.79}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.34}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 97.7}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 92.17}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 99.29}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.43}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.27}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 95.81}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 96.89}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 96.06}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 98.95}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.34}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.21}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 97.91}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 95.87}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 98.12}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.83}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 97.8}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 94.78}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:30:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170420' 
        and city_id = '7'
)q

17/05/02 12:37:41 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:37:41 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.661 seconds
Query ID = busbi_20170502123812_b8f5427e-ad23-42b7-bcc4-528cd7c66aa4
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_627134, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_627134/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_627134
Hadoop job information for Stage-1: number of mappers: 12; number of reducers: 1
2017-05-02 12:39:25,186 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:39:49,643 Stage-1 map = 8%,  reduce = 0%, Cumulative CPU 67.9 sec
2017-05-02 12:39:58,899 Stage-1 map = 11%,  reduce = 0%, Cumulative CPU 360.13 sec
2017-05-02 12:40:03,052 Stage-1 map = 14%,  reduce = 0%, Cumulative CPU 417.8 sec
2017-05-02 12:40:04,082 Stage-1 map = 17%,  reduce = 0%, Cumulative CPU 436.51 sec
2017-05-02 12:40:05,107 Stage-1 map = 22%,  reduce = 0%, Cumulative CPU 461.99 sec
2017-05-02 12:40:07,174 Stage-1 map = 31%,  reduce = 0%, Cumulative CPU 487.01 sec
2017-05-02 12:40:08,221 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 505.37 sec
2017-05-02 12:40:09,265 Stage-1 map = 36%,  reduce = 0%, Cumulative CPU 518.99 sec
2017-05-02 12:40:10,317 Stage-1 map = 42%,  reduce = 0%, Cumulative CPU 538.66 sec
2017-05-02 12:40:11,352 Stage-1 map = 44%,  reduce = 0%, Cumulative CPU 555.04 sec
2017-05-02 12:40:13,453 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 588.1 sec
2017-05-02 12:40:14,499 Stage-1 map = 61%,  reduce = 0%, Cumulative CPU 608.07 sec
2017-05-02 12:40:15,524 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 619.49 sec
2017-05-02 12:40:20,665 Stage-1 map = 83%,  reduce = 0%, Cumulative CPU 678.3 sec
2017-05-02 12:40:21,689 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 685.27 sec
2017-05-02 12:40:22,713 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 689.08 sec
2017-05-02 12:40:36,062 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 696.21 sec
MapReduce Total cumulative CPU time: 11 minutes 36 seconds 210 msec
Ended Job = job_1493104900716_627134
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 12  Reduce: 1   Cumulative CPU: 696.21 sec   HDFS Read: 2277989191 HDFS Write: 6 SUCCESS
Total MapReduce CPU Time Spent: 11 minutes 36 seconds 210 msec
OK
Time taken: 146.841 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 12:40:50 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/20/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170420(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170420;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170420 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170420';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='20');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='20') location '2017/04/20';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='20')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 12:40:54 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:40:54 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.23 seconds
OK
Time taken: 0.066 seconds
OK
Time taken: 0.975 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170420
Table transit_dw.tmp_abnormal_ratio_20170420 stats: [numFiles=1, numRows=0, totalSize=177, rawDataSize=0]
OK
Time taken: 0.403 seconds
Query ID = busbi_20170502124100_71801fdc-319d-4010-8125-1ff991d8b6f6
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_627404, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_627404/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_627404
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 12:41:51,258 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:41:59,879 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 6.89 sec
2017-05-02 12:42:26,085 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 17.54 sec
MapReduce Total cumulative CPU time: 17 seconds 540 msec
Ended Job = job_1493104900716_627404
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_12-41-00_660_3965881015533628341-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/853edaf2-31fe-45a4-884a-a4f65028d53d/_tmp_space.db/27670732-5ad2-4334-a59a-594496ca44d4
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6148, rawDataSize=6124]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 17.54 sec   HDFS Read: 19329 HDFS Write: 6245 SUCCESS
Total MapReduce CPU Time Spent: 17 seconds 540 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 91.087 seconds
Dropped the partition year=2017/month=04/day=20
OK
Time taken: 0.179 seconds
OK
Time taken: 0.153 seconds
Query ID = busbi_20170502124232_61f24c14-efc6-4bc1-a95b-7576d1ac442b
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_627555, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_627555/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_627555
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 12:42:59,393 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:43:11,420 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 3.32 sec
MapReduce Total cumulative CPU time: 3 seconds 320 msec
Ended Job = job_1493104900716_627555
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_12-42-32_081_8917808867135564993-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=20)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/20/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=20} stats: [numFiles=1, numRows=24, totalSize=1828, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 3.32 sec   HDFS Read: 10493 HDFS Write: 1948 SUCCESS
Total MapReduce CPU Time Spent: 3 seconds 320 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 47.393 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 12:43:35 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:43:35 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.247 seconds
Query ID = busbi_20170502124340_602144bb-8afe-430e-89cd-e67352ccd9cc
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 174
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_627671, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_627671/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_627671
Hadoop job information for Stage-3: number of mappers: 162; number of reducers: 174
2017-05-02 12:44:09,919 Stage-3 map = 0%,  reduce = 0%
2017-05-02 12:44:38,320 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 33.78 sec
2017-05-02 12:44:39,361 Stage-3 map = 6%,  reduce = 0%, Cumulative CPU 1252.25 sec
2017-05-02 12:44:40,394 Stage-3 map = 9%,  reduce = 0%, Cumulative CPU 2013.66 sec
2017-05-02 12:44:41,431 Stage-3 map = 10%,  reduce = 0%, Cumulative CPU 2190.42 sec
2017-05-02 12:44:42,472 Stage-3 map = 23%,  reduce = 0%, Cumulative CPU 2551.42 sec
2017-05-02 12:44:43,527 Stage-3 map = 31%,  reduce = 0%, Cumulative CPU 2963.67 sec
2017-05-02 12:44:44,558 Stage-3 map = 45%,  reduce = 0%, Cumulative CPU 3386.74 sec
2017-05-02 12:44:45,592 Stage-3 map = 63%,  reduce = 0%, Cumulative CPU 3610.43 sec
2017-05-02 12:44:46,623 Stage-3 map = 68%,  reduce = 0%, Cumulative CPU 3753.48 sec
2017-05-02 12:44:47,657 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 3880.65 sec
2017-05-02 12:44:48,685 Stage-3 map = 73%,  reduce = 0%, Cumulative CPU 3915.09 sec
2017-05-02 12:44:49,714 Stage-3 map = 74%,  reduce = 0%, Cumulative CPU 4022.76 sec
2017-05-02 12:44:50,742 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 4112.87 sec
2017-05-02 12:44:51,770 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 4156.28 sec
2017-05-02 12:44:52,799 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 4254.28 sec
2017-05-02 12:44:53,827 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 4331.61 sec
2017-05-02 12:44:55,891 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 4429.17 sec
2017-05-02 12:44:56,930 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 4494.28 sec
2017-05-02 12:44:57,967 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 4578.1 sec
2017-05-02 12:44:58,995 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 4634.84 sec
2017-05-02 12:45:00,027 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 4698.48 sec
2017-05-02 12:45:01,069 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 4733.98 sec
2017-05-02 12:45:02,098 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 4772.19 sec
2017-05-02 12:45:03,130 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 4802.05 sec
2017-05-02 12:45:07,300 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 4874.93 sec
2017-05-02 12:45:10,403 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 4911.86 sec
2017-05-02 12:45:17,639 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 4965.11 sec
2017-05-02 12:45:19,706 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 4989.63 sec
2017-05-02 12:45:28,009 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 5033.41 sec
2017-05-02 12:45:34,201 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 5016.2 sec
2017-05-02 12:45:44,794 Stage-3 map = 100%,  reduce = 57%, Cumulative CPU 6031.26 sec
2017-05-02 12:45:45,828 Stage-3 map = 100%,  reduce = 65%, Cumulative CPU 6219.57 sec
2017-05-02 12:45:46,861 Stage-3 map = 100%,  reduce = 66%, Cumulative CPU 6231.14 sec
2017-05-02 12:45:47,891 Stage-3 map = 100%,  reduce = 68%, Cumulative CPU 6294.15 sec
2017-05-02 12:45:48,922 Stage-3 map = 100%,  reduce = 70%, Cumulative CPU 6335.5 sec
2017-05-02 12:45:49,952 Stage-3 map = 100%,  reduce = 72%, Cumulative CPU 6371.41 sec
2017-05-02 12:45:50,990 Stage-3 map = 100%,  reduce = 80%, Cumulative CPU 6556.82 sec
2017-05-02 12:45:53,059 Stage-3 map = 100%,  reduce = 93%, Cumulative CPU 7009.8 sec
2017-05-02 12:45:54,087 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 7162.25 sec
2017-05-02 12:45:55,117 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 7232.27 sec
2017-05-02 12:45:57,174 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 7270.02 sec
2017-05-02 12:46:00,267 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 7307.23 sec
MapReduce Total cumulative CPU time: 0 days 2 hours 1 minutes 47 seconds 230 msec
Ended Job = job_1493104900716_627671
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_627959, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_627959/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_627959
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 3
2017-05-02 12:46:30,061 Stage-4 map = 0%,  reduce = 0%
2017-05-02 12:46:43,643 Stage-4 map = 8%,  reduce = 0%, Cumulative CPU 17.46 sec
2017-05-02 12:46:46,754 Stage-4 map = 14%,  reduce = 0%, Cumulative CPU 22.67 sec
2017-05-02 12:46:48,806 Stage-4 map = 21%,  reduce = 0%, Cumulative CPU 35.58 sec
2017-05-02 12:46:49,831 Stage-4 map = 27%,  reduce = 0%, Cumulative CPU 42.83 sec
2017-05-02 12:46:51,886 Stage-4 map = 33%,  reduce = 0%, Cumulative CPU 45.32 sec
2017-05-02 12:46:52,933 Stage-4 map = 37%,  reduce = 0%, Cumulative CPU 50.06 sec
2017-05-02 12:46:55,000 Stage-4 map = 45%,  reduce = 0%, Cumulative CPU 53.5 sec
2017-05-02 12:46:56,033 Stage-4 map = 51%,  reduce = 0%, Cumulative CPU 63.37 sec
2017-05-02 12:46:58,100 Stage-4 map = 53%,  reduce = 0%, Cumulative CPU 67.33 sec
2017-05-02 12:46:59,144 Stage-4 map = 55%,  reduce = 0%, Cumulative CPU 78.65 sec
2017-05-02 12:47:00,178 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 81.63 sec
2017-05-02 12:47:02,239 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 90.45 sec
2017-05-02 12:47:05,327 Stage-4 map = 72%,  reduce = 0%, Cumulative CPU 96.91 sec
2017-05-02 12:47:07,404 Stage-4 map = 75%,  reduce = 0%, Cumulative CPU 100.07 sec
2017-05-02 12:47:08,430 Stage-4 map = 78%,  reduce = 0%, Cumulative CPU 103.34 sec
2017-05-02 12:47:10,481 Stage-4 map = 80%,  reduce = 0%, Cumulative CPU 110.31 sec
2017-05-02 12:47:13,554 Stage-4 map = 89%,  reduce = 0%, Cumulative CPU 117.01 sec
2017-05-02 12:47:16,634 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 123.42 sec
2017-05-02 12:47:37,302 Stage-4 map = 100%,  reduce = 50%, Cumulative CPU 157.29 sec
2017-05-02 12:47:40,425 Stage-4 map = 100%,  reduce = 62%, Cumulative CPU 166.93 sec
2017-05-02 12:47:43,536 Stage-4 map = 100%,  reduce = 65%, Cumulative CPU 181.61 sec
2017-05-02 12:47:44,564 Stage-4 map = 100%,  reduce = 67%, Cumulative CPU 187.97 sec
2017-05-02 12:47:46,624 Stage-4 map = 100%,  reduce = 69%, Cumulative CPU 212.18 sec
2017-05-02 12:47:47,689 Stage-4 map = 100%,  reduce = 70%, Cumulative CPU 226.79 sec
2017-05-02 12:47:49,758 Stage-4 map = 100%,  reduce = 74%, Cumulative CPU 234.28 sec
2017-05-02 12:47:50,798 Stage-4 map = 100%,  reduce = 75%, Cumulative CPU 237.85 sec
2017-05-02 12:47:52,861 Stage-4 map = 100%,  reduce = 81%, Cumulative CPU 247.97 sec
2017-05-02 12:47:55,964 Stage-4 map = 100%,  reduce = 86%, Cumulative CPU 258.85 sec
2017-05-02 12:47:59,059 Stage-4 map = 100%,  reduce = 92%, Cumulative CPU 275.07 sec
2017-05-02 12:48:02,142 Stage-4 map = 100%,  reduce = 97%, Cumulative CPU 288.57 sec
2017-05-02 12:48:04,190 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 296.82 sec
MapReduce Total cumulative CPU time: 4 minutes 56 seconds 820 msec
Ended Job = job_1493104900716_627959
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_628145, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_628145/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_628145
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 3
2017-05-02 12:48:36,545 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:48:44,849 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 3.08 sec
2017-05-02 12:48:58,222 Stage-1 map = 56%,  reduce = 0%, Cumulative CPU 44.07 sec
2017-05-02 12:49:01,307 Stage-1 map = 64%,  reduce = 0%, Cumulative CPU 56.68 sec
2017-05-02 12:49:07,504 Stage-1 map = 68%,  reduce = 0%, Cumulative CPU 75.52 sec
2017-05-02 12:49:10,589 Stage-1 map = 76%,  reduce = 0%, Cumulative CPU 82.57 sec
2017-05-02 12:49:13,661 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 89.64 sec
2017-05-02 12:49:16,737 Stage-1 map = 93%,  reduce = 0%, Cumulative CPU 93.43 sec
2017-05-02 12:49:19,819 Stage-1 map = 96%,  reduce = 0%, Cumulative CPU 96.58 sec
2017-05-02 12:49:22,893 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 99.67 sec
2017-05-02 12:49:37,273 Stage-1 map = 100%,  reduce = 22%, Cumulative CPU 108.7 sec
2017-05-02 12:49:40,340 Stage-1 map = 100%,  reduce = 26%, Cumulative CPU 116.25 sec
2017-05-02 12:49:43,430 Stage-1 map = 100%,  reduce = 30%, Cumulative CPU 119.79 sec
2017-05-02 12:49:44,452 Stage-1 map = 100%,  reduce = 52%, Cumulative CPU 128.68 sec
2017-05-02 12:49:46,497 Stage-1 map = 100%,  reduce = 73%, Cumulative CPU 146.61 sec
2017-05-02 12:49:47,521 Stage-1 map = 100%,  reduce = 75%, Cumulative CPU 158.82 sec
2017-05-02 12:49:49,563 Stage-1 map = 100%,  reduce = 79%, Cumulative CPU 162.46 sec
2017-05-02 12:49:50,588 Stage-1 map = 100%,  reduce = 84%, Cumulative CPU 166.66 sec
2017-05-02 12:49:53,670 Stage-1 map = 100%,  reduce = 89%, Cumulative CPU 182.57 sec
2017-05-02 12:49:55,728 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 188.06 sec
2017-05-02 12:49:58,796 Stage-1 map = 100%,  reduce = 92%, Cumulative CPU 191.52 sec
2017-05-02 12:50:01,879 Stage-1 map = 100%,  reduce = 93%, Cumulative CPU 195.08 sec
2017-05-02 12:50:04,945 Stage-1 map = 100%,  reduce = 94%, Cumulative CPU 200.23 sec
2017-05-02 12:50:08,013 Stage-1 map = 100%,  reduce = 95%, Cumulative CPU 204.64 sec
2017-05-02 12:50:11,080 Stage-1 map = 100%,  reduce = 96%, Cumulative CPU 207.9 sec
2017-05-02 12:50:14,158 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 211.16 sec
2017-05-02 12:50:17,234 Stage-1 map = 100%,  reduce = 98%, Cumulative CPU 214.44 sec
2017-05-02 12:50:20,330 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 218.07 sec
2017-05-02 12:50:23,413 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 220.89 sec
MapReduce Total cumulative CPU time: 3 minutes 40 seconds 890 msec
Ended Job = job_1493104900716_628145
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_628387, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_628387/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_628387
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 12:50:46,017 Stage-2 map = 0%,  reduce = 0%
2017-05-02 12:51:01,363 Stage-2 map = 6%,  reduce = 0%, Cumulative CPU 26.58 sec
2017-05-02 12:51:07,503 Stage-2 map = 28%,  reduce = 0%, Cumulative CPU 40.48 sec
2017-05-02 12:51:10,571 Stage-2 map = 34%,  reduce = 0%, Cumulative CPU 54.03 sec
2017-05-02 12:51:13,641 Stage-2 map = 48%,  reduce = 0%, Cumulative CPU 63.48 sec
2017-05-02 12:51:16,718 Stage-2 map = 70%,  reduce = 0%, Cumulative CPU 70.62 sec
2017-05-02 12:51:25,952 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 84.8 sec
2017-05-02 12:51:35,191 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 94.98 sec
2017-05-02 12:51:52,629 Stage-2 map = 100%,  reduce = 81%, Cumulative CPU 112.95 sec
2017-05-02 12:51:55,714 Stage-2 map = 100%,  reduce = 89%, Cumulative CPU 116.23 sec
2017-05-02 12:51:58,801 Stage-2 map = 100%,  reduce = 97%, Cumulative CPU 119.68 sec
2017-05-02 12:51:59,827 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 120.98 sec
MapReduce Total cumulative CPU time: 2 minutes 0 seconds 980 msec
Ended Job = job_1493104900716_628387
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 162  Reduce: 174   Cumulative CPU: 7307.23 sec   HDFS Read: 44311758006 HDFS Write: 535251441 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 3   Cumulative CPU: 296.82 sec   HDFS Read: 535319700 HDFS Write: 535232356 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 3   Cumulative CPU: 220.89 sec   HDFS Read: 535282683 HDFS Write: 534124643 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 120.98 sec   HDFS Read: 534138637 HDFS Write: 393804126 SUCCESS
Total MapReduce CPU Time Spent: 0 days 2 hours 12 minutes 25 seconds 920 msec
OK
Time taken: 501.981 seconds, Fetched: 5866519 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492531200, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 70.28}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 97.87}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 96.8}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 95.8}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 96.64}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.56}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 97.44}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 92.95}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 99.38}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.53}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.17}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 95.32}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 96.83}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 96.42}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 99.17}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.54}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.27}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.27}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 96.2}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 98.06}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.67}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 98.01}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 96.3}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:50:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170419' 
        and city_id = '7'
)q

17/05/02 12:54:35 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:54:35 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.81 seconds
Query ID = busbi_20170502125440_68c5bfef-8e36-422c-8b7f-6704b5b4aa8d
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_628699, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_628699/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_628699
Hadoop job information for Stage-1: number of mappers: 12; number of reducers: 1
2017-05-02 12:55:13,767 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:55:29,762 Stage-1 map = 6%,  reduce = 0%, Cumulative CPU 68.49 sec
2017-05-02 12:55:30,805 Stage-1 map = 8%,  reduce = 0%, Cumulative CPU 74.22 sec
2017-05-02 12:55:32,878 Stage-1 map = 11%,  reduce = 0%, Cumulative CPU 124.5 sec
2017-05-02 12:55:35,977 Stage-1 map = 22%,  reduce = 0%, Cumulative CPU 226.11 sec
2017-05-02 12:55:37,017 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 229.49 sec
2017-05-02 12:55:44,262 Stage-1 map = 42%,  reduce = 0%, Cumulative CPU 300.58 sec
2017-05-02 12:55:45,290 Stage-1 map = 47%,  reduce = 0%, Cumulative CPU 311.02 sec
2017-05-02 12:55:48,395 Stage-1 map = 49%,  reduce = 0%, Cumulative CPU 370.02 sec
2017-05-02 12:55:51,479 Stage-1 map = 53%,  reduce = 0%, Cumulative CPU 421.16 sec
2017-05-02 12:55:52,507 Stage-1 map = 56%,  reduce = 0%, Cumulative CPU 421.91 sec
2017-05-02 12:55:53,540 Stage-1 map = 61%,  reduce = 0%, Cumulative CPU 443.4 sec
2017-05-02 12:55:54,570 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 455.08 sec
2017-05-02 12:55:55,601 Stage-1 map = 72%,  reduce = 0%, Cumulative CPU 436.92 sec
2017-05-02 12:55:56,634 Stage-1 map = 78%,  reduce = 0%, Cumulative CPU 458.55 sec
2017-05-02 12:55:57,671 Stage-1 map = 83%,  reduce = 0%, Cumulative CPU 459.87 sec
2017-05-02 12:56:05,920 Stage-1 map = 86%,  reduce = 0%, Cumulative CPU 456.53 sec
2017-05-02 12:56:09,013 Stage-1 map = 92%,  reduce = 0%, Cumulative CPU 465.11 sec
2017-05-02 12:56:10,039 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 469.84 sec
2017-05-02 12:56:21,387 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 489.13 sec
2017-05-02 12:56:28,611 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 492.62 sec
MapReduce Total cumulative CPU time: 8 minutes 12 seconds 620 msec
Ended Job = job_1493104900716_628699
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 12  Reduce: 1   Cumulative CPU: 492.62 sec   HDFS Read: 2240706187 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 8 minutes 12 seconds 620 msec
OK
Time taken: 111.168 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:50:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 12:56:43 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/19/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170419(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170419;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170419 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170419';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='19');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='19') location '2017/04/19';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='19')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 12:56:47 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:56:47 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.427 seconds
OK
Time taken: 0.063 seconds
OK
Time taken: 0.306 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170419
Table transit_dw.tmp_abnormal_ratio_20170419 stats: [numFiles=1, numRows=0, totalSize=181, rawDataSize=0]
OK
Time taken: 0.445 seconds
Query ID = busbi_20170502125653_1f557791-6446-4a40-9555-40691ec1fc8f
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_628913, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_628913/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_628913
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 12:57:19,056 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:57:26,570 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 5.32 sec
2017-05-02 12:57:34,940 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 9.51 sec
MapReduce Total cumulative CPU time: 9 seconds 510 msec
Ended Job = job_1493104900716_628913
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_12-56-53_376_1301053930438036226-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/c5b66170-a62b-4425-a9a7-14bd02f898d2/_tmp_space.db/b47e9172-1a1d-4c21-b8a1-be5fce38f386
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6154, rawDataSize=6130]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 9.51 sec   HDFS Read: 19174 HDFS Write: 6251 SUCCESS
Total MapReduce CPU Time Spent: 9 seconds 510 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 45.024 seconds
Dropped the partition year=2017/month=04/day=19
OK
Time taken: 0.171 seconds
OK
Time taken: 0.069 seconds
Query ID = busbi_20170502125738_eb3930bc-280a-49f7-9836-e4f04fc2ee5c
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_628953, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_628953/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_628953
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 12:58:00,049 Stage-1 map = 0%,  reduce = 0%
2017-05-02 12:58:07,472 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.63 sec
MapReduce Total cumulative CPU time: 2 seconds 630 msec
Ended Job = job_1493104900716_628953
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_12-57-38_648_9026781479026719339-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=19)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/19/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=19} stats: [numFiles=1, numRows=24, totalSize=1841, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 2.63 sec   HDFS Read: 10499 HDFS Write: 1961 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 630 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 30.457 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 12:50:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 12:58:24 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 12:58:24 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.309 seconds
Query ID = busbi_20170502125829_0e0749c3-60ed-42da-a556-daf05a4f5b54
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 175
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_629049, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_629049/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_629049
Hadoop job information for Stage-3: number of mappers: 165; number of reducers: 175
2017-05-02 12:58:56,242 Stage-3 map = 0%,  reduce = 0%
2017-05-02 12:59:19,212 Stage-3 map = 5%,  reduce = 0%, Cumulative CPU 984.21 sec
2017-05-02 12:59:20,247 Stage-3 map = 8%,  reduce = 0%, Cumulative CPU 1913.61 sec
2017-05-02 12:59:22,313 Stage-3 map = 18%,  reduce = 0%, Cumulative CPU 2417.42 sec
2017-05-02 12:59:23,343 Stage-3 map = 29%,  reduce = 0%, Cumulative CPU 2802.41 sec
2017-05-02 12:59:24,381 Stage-3 map = 41%,  reduce = 0%, Cumulative CPU 3268.56 sec
2017-05-02 12:59:25,416 Stage-3 map = 54%,  reduce = 0%, Cumulative CPU 3606.07 sec
2017-05-02 12:59:26,470 Stage-3 map = 61%,  reduce = 0%, Cumulative CPU 3911.07 sec
2017-05-02 12:59:27,502 Stage-3 map = 64%,  reduce = 0%, Cumulative CPU 4172.91 sec
2017-05-02 12:59:28,567 Stage-3 map = 68%,  reduce = 0%, Cumulative CPU 4290.4 sec
2017-05-02 12:59:29,597 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 4413.11 sec
2017-05-02 12:59:30,626 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 4551.16 sec
2017-05-02 12:59:31,662 Stage-3 map = 75%,  reduce = 0%, Cumulative CPU 4636.37 sec
2017-05-02 12:59:32,689 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 4719.98 sec
2017-05-02 12:59:33,718 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 4807.0 sec
2017-05-02 12:59:34,746 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 4859.26 sec
2017-05-02 12:59:35,777 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 4915.15 sec
2017-05-02 12:59:36,815 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 4990.72 sec
2017-05-02 12:59:37,847 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 5037.38 sec
2017-05-02 12:59:38,885 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 5088.83 sec
2017-05-02 12:59:39,912 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 5174.44 sec
2017-05-02 12:59:40,939 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 5227.13 sec
2017-05-02 12:59:41,970 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 5274.35 sec
2017-05-02 12:59:42,999 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 5313.75 sec
2017-05-02 12:59:44,026 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 5356.88 sec
2017-05-02 12:59:45,065 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 5374.2 sec
2017-05-02 12:59:47,120 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 5408.79 sec
2017-05-02 12:59:50,201 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 5440.95 sec
2017-05-02 12:59:53,279 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 5471.4 sec
2017-05-02 12:59:56,360 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 5480.88 sec
2017-05-02 13:00:06,826 Stage-3 map = 100%,  reduce = 38%, Cumulative CPU 6127.14 sec
2017-05-02 13:00:07,878 Stage-3 map = 100%,  reduce = 51%, Cumulative CPU 6383.99 sec
2017-05-02 13:00:08,916 Stage-3 map = 100%,  reduce = 52%, Cumulative CPU 6406.27 sec
2017-05-02 13:00:09,947 Stage-3 map = 100%,  reduce = 53%, Cumulative CPU 6417.79 sec
2017-05-02 13:00:10,988 Stage-3 map = 100%,  reduce = 58%, Cumulative CPU 6540.34 sec
2017-05-02 13:00:13,072 Stage-3 map = 100%,  reduce = 69%, Cumulative CPU 6909.44 sec
2017-05-02 13:00:14,107 Stage-3 map = 100%,  reduce = 76%, Cumulative CPU 7217.29 sec
2017-05-02 13:00:15,135 Stage-3 map = 100%,  reduce = 88%, Cumulative CPU 7662.06 sec
2017-05-02 13:00:16,168 Stage-3 map = 100%,  reduce = 93%, Cumulative CPU 7856.1 sec
2017-05-02 13:00:17,201 Stage-3 map = 100%,  reduce = 95%, Cumulative CPU 7948.67 sec
2017-05-02 13:00:18,225 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 8089.41 sec
2017-05-02 13:00:22,340 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 8203.53 sec
2017-05-02 13:01:23,103 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 8766.17 sec
2017-05-02 13:02:23,770 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 8944.33 sec
2017-05-02 13:03:24,319 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9033.01 sec
2017-05-02 13:04:25,045 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9099.32 sec
2017-05-02 13:05:25,630 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9166.71 sec
2017-05-02 13:06:26,393 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9231.96 sec
2017-05-02 13:07:27,009 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9293.99 sec
2017-05-02 13:08:27,549 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9359.27 sec
2017-05-02 13:09:28,157 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9424.39 sec
2017-05-02 13:10:28,630 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9491.87 sec
2017-05-02 13:11:29,101 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9553.29 sec
2017-05-02 13:12:29,708 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9619.0 sec
2017-05-02 13:13:30,439 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9684.72 sec
2017-05-02 13:14:31,045 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9750.34 sec
2017-05-02 13:15:31,465 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9812.66 sec
2017-05-02 13:16:31,934 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9877.45 sec
2017-05-02 13:17:32,241 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9942.33 sec
2017-05-02 13:18:32,376 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10007.6 sec
2017-05-02 13:18:35,430 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 10010.91 sec
MapReduce Total cumulative CPU time: 0 days 2 hours 46 minutes 50 seconds 910 msec
Ended Job = job_1493104900716_629049
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_630913, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_630913/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_630913
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 3
2017-05-02 13:19:08,044 Stage-4 map = 0%,  reduce = 0%
2017-05-02 13:19:20,416 Stage-4 map = 30%,  reduce = 0%, Cumulative CPU 30.06 sec
2017-05-02 13:19:23,511 Stage-4 map = 48%,  reduce = 0%, Cumulative CPU 41.43 sec
2017-05-02 13:19:26,594 Stage-4 map = 55%,  reduce = 0%, Cumulative CPU 48.45 sec
2017-05-02 13:19:29,696 Stage-4 map = 62%,  reduce = 0%, Cumulative CPU 55.46 sec
2017-05-02 13:19:32,788 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 68.67 sec
2017-05-02 13:19:35,873 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 77.88 sec
2017-05-02 13:19:38,997 Stage-4 map = 72%,  reduce = 0%, Cumulative CPU 84.32 sec
2017-05-02 13:19:42,081 Stage-4 map = 77%,  reduce = 0%, Cumulative CPU 89.92 sec
2017-05-02 13:19:45,153 Stage-4 map = 78%,  reduce = 0%, Cumulative CPU 96.58 sec
2017-05-02 13:19:48,223 Stage-4 map = 85%,  reduce = 0%, Cumulative CPU 103.48 sec
2017-05-02 13:19:51,295 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 109.89 sec
2017-05-02 13:20:07,730 Stage-4 map = 100%,  reduce = 66%, Cumulative CPU 140.95 sec
2017-05-02 13:20:10,792 Stage-4 map = 100%,  reduce = 71%, Cumulative CPU 172.37 sec
2017-05-02 13:20:13,856 Stage-4 map = 100%,  reduce = 81%, Cumulative CPU 183.65 sec
2017-05-02 13:20:16,919 Stage-4 map = 100%,  reduce = 90%, Cumulative CPU 197.06 sec
2017-05-02 13:20:19,981 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 211.8 sec
2017-05-02 13:20:21,002 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 213.53 sec
MapReduce Total cumulative CPU time: 3 minutes 33 seconds 530 msec
Ended Job = job_1493104900716_630913
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_631041, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_631041/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_631041
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 3
2017-05-02 13:20:38,400 Stage-1 map = 0%,  reduce = 0%
2017-05-02 13:20:45,568 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 2.97 sec
2017-05-02 13:20:59,913 Stage-1 map = 56%,  reduce = 0%, Cumulative CPU 44.71 sec
2017-05-02 13:21:02,984 Stage-1 map = 64%,  reduce = 0%, Cumulative CPU 55.11 sec
2017-05-02 13:21:09,139 Stage-1 map = 72%,  reduce = 0%, Cumulative CPU 73.8 sec
2017-05-02 13:21:12,215 Stage-1 map = 76%,  reduce = 0%, Cumulative CPU 80.55 sec
2017-05-02 13:21:15,284 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 86.59 sec
2017-05-02 13:21:18,361 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 90.51 sec
2017-05-02 13:21:21,420 Stage-1 map = 96%,  reduce = 0%, Cumulative CPU 93.61 sec
2017-05-02 13:21:24,485 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 96.67 sec
2017-05-02 13:21:41,807 Stage-1 map = 100%,  reduce = 41%, Cumulative CPU 121.13 sec
2017-05-02 13:21:42,825 Stage-1 map = 100%,  reduce = 61%, Cumulative CPU 133.76 sec
2017-05-02 13:21:44,860 Stage-1 map = 100%,  reduce = 70%, Cumulative CPU 142.57 sec
2017-05-02 13:21:45,878 Stage-1 map = 100%,  reduce = 72%, Cumulative CPU 155.69 sec
2017-05-02 13:21:47,918 Stage-1 map = 100%,  reduce = 78%, Cumulative CPU 168.56 sec
2017-05-02 13:21:48,951 Stage-1 map = 100%,  reduce = 79%, Cumulative CPU 173.75 sec
2017-05-02 13:21:51,010 Stage-1 map = 100%,  reduce = 81%, Cumulative CPU 180.02 sec
2017-05-02 13:21:52,027 Stage-1 map = 100%,  reduce = 83%, Cumulative CPU 183.56 sec
2017-05-02 13:21:54,064 Stage-1 map = 100%,  reduce = 85%, Cumulative CPU 187.12 sec
2017-05-02 13:21:55,083 Stage-1 map = 100%,  reduce = 86%, Cumulative CPU 190.64 sec
2017-05-02 13:21:57,119 Stage-1 map = 100%,  reduce = 88%, Cumulative CPU 194.14 sec
2017-05-02 13:21:58,139 Stage-1 map = 100%,  reduce = 89%, Cumulative CPU 199.03 sec
2017-05-02 13:22:00,186 Stage-1 map = 100%,  reduce = 91%, Cumulative CPU 204.15 sec
2017-05-02 13:22:01,204 Stage-1 map = 100%,  reduce = 92%, Cumulative CPU 207.99 sec
2017-05-02 13:22:03,250 Stage-1 map = 100%,  reduce = 94%, Cumulative CPU 211.76 sec
2017-05-02 13:22:04,271 Stage-1 map = 100%,  reduce = 95%, Cumulative CPU 215.14 sec
2017-05-02 13:22:05,293 Stage-1 map = 100%,  reduce = 96%, Cumulative CPU 216.97 sec
2017-05-02 13:22:07,332 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 220.3 sec
2017-05-02 13:22:10,387 Stage-1 map = 100%,  reduce = 98%, Cumulative CPU 224.14 sec
2017-05-02 13:22:13,438 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 227.43 sec
2017-05-02 13:22:16,494 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 231.07 sec
MapReduce Total cumulative CPU time: 3 minutes 51 seconds 70 msec
Ended Job = job_1493104900716_631041
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_631332, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_631332/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_631332
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 13:23:33,791 Stage-2 map = 0%,  reduce = 0%
2017-05-02 13:23:59,949 Stage-2 map = 6%,  reduce = 0%, Cumulative CPU 11.76 sec
2017-05-02 13:24:07,119 Stage-2 map = 11%,  reduce = 0%, Cumulative CPU 35.47 sec
2017-05-02 13:24:12,227 Stage-2 map = 25%,  reduce = 0%, Cumulative CPU 49.93 sec
2017-05-02 13:24:24,538 Stage-2 map = 38%,  reduce = 0%, Cumulative CPU 77.0 sec
2017-05-02 13:24:28,618 Stage-2 map = 60%,  reduce = 0%, Cumulative CPU 88.06 sec
2017-05-02 13:24:30,659 Stage-2 map = 77%,  reduce = 0%, Cumulative CPU 91.58 sec
2017-05-02 13:24:37,816 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 114.94 sec
2017-05-02 13:24:47,060 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 125.37 sec
2017-05-02 13:25:04,550 Stage-2 map = 100%,  reduce = 80%, Cumulative CPU 143.93 sec
2017-05-02 13:25:07,630 Stage-2 map = 100%,  reduce = 88%, Cumulative CPU 147.31 sec
2017-05-02 13:25:10,706 Stage-2 map = 100%,  reduce = 95%, Cumulative CPU 150.71 sec
2017-05-02 13:25:12,755 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 153.31 sec
MapReduce Total cumulative CPU time: 2 minutes 33 seconds 310 msec
Ended Job = job_1493104900716_631332
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 165  Reduce: 175   Cumulative CPU: 10025.07 sec   HDFS Read: 44727086178 HDFS Write: 532989225 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 3   Cumulative CPU: 213.53 sec   HDFS Read: 533057785 HDFS Write: 532969625 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 3   Cumulative CPU: 231.07 sec   HDFS Read: 533023796 HDFS Write: 531816975 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 153.31 sec   HDFS Read: 531831359 HDFS Write: 390641052 SUCCESS
Total MapReduce CPU Time Spent: 0 days 2 hours 57 minutes 2 seconds 980 msec
OK
Time taken: 1604.121 seconds, Fetched: 5904071 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492444800, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 69.47}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 97.79}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 96.75}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 95.92}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 96.63}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.37}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 97.23}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 92.47}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 99.36}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.2}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.05}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 96}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 96.9}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 95.87}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 98.86}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.36}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.08}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 97.98}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 96.24}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 98.3}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.41}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 97.83}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 95.58}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 13:20:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170418' 
        and city_id = '7'
)q

17/05/02 13:26:59 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 13:26:59 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.942 seconds
Query ID = busbi_20170502132704_b6842acc-c0a3-46a3-b5a8-a764210b6fa5
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_631951, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_631951/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_631951
Hadoop job information for Stage-1: number of mappers: 12; number of reducers: 1
2017-05-02 13:27:43,241 Stage-1 map = 0%,  reduce = 0%
2017-05-02 13:27:56,819 Stage-1 map = 8%,  reduce = 0%, Cumulative CPU 89.77 sec
2017-05-02 13:27:58,901 Stage-1 map = 14%,  reduce = 0%, Cumulative CPU 132.62 sec
2017-05-02 13:27:59,938 Stage-1 map = 17%,  reduce = 0%, Cumulative CPU 219.67 sec
2017-05-02 13:28:03,046 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 283.75 sec
2017-05-02 13:28:04,079 Stage-1 map = 42%,  reduce = 0%, Cumulative CPU 302.86 sec
2017-05-02 13:28:06,143 Stage-1 map = 53%,  reduce = 0%, Cumulative CPU 335.58 sec
2017-05-02 13:28:08,204 Stage-1 map = 75%,  reduce = 0%, Cumulative CPU 356.71 sec
2017-05-02 13:28:09,233 Stage-1 map = 83%,  reduce = 0%, Cumulative CPU 373.87 sec
2017-05-02 13:28:18,516 Stage-1 map = 86%,  reduce = 0%, Cumulative CPU 427.18 sec
2017-05-02 13:28:19,546 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 431.77 sec
2017-05-02 13:28:28,862 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 435.19 sec
MapReduce Total cumulative CPU time: 7 minutes 15 seconds 190 msec
Ended Job = job_1493104900716_631951
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 12  Reduce: 1   Cumulative CPU: 435.19 sec   HDFS Read: 2293500212 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 7 minutes 15 seconds 190 msec
OK
Time taken: 85.457 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 13:20:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 13:28:40 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/18/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170418(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170418;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170418 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170418';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='18');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='18') location '2017/04/18';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='18')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 13:28:44 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 13:28:44 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.067 seconds
OK
Time taken: 0.072 seconds
OK
Time taken: 0.271 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170418
Table transit_dw.tmp_abnormal_ratio_20170418 stats: [numFiles=1, numRows=0, totalSize=180, rawDataSize=0]
OK
Time taken: 0.422 seconds
Query ID = busbi_20170502132849_c6227a79-5a5d-4a63-b6ef-44f3f0d3ceff
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_632192, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_632192/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_632192
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 13:29:17,327 Stage-1 map = 0%,  reduce = 0%
2017-05-02 13:29:24,622 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 2.06 sec
2017-05-02 13:29:26,683 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 5.41 sec
2017-05-02 13:29:34,943 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 9.1 sec
MapReduce Total cumulative CPU time: 9 seconds 100 msec
Ended Job = job_1493104900716_632192
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_13-28-49_366_2858672480116506584-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/7d437d08-663a-43b7-8f76-959fdbea3917/_tmp_space.db/45891311-9de3-44f6-9d4f-85793f38eced
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6150, rawDataSize=6126]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 9.1 sec   HDFS Read: 19136 HDFS Write: 6247 SUCCESS
Total MapReduce CPU Time Spent: 9 seconds 100 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 49.114 seconds
Dropped the partition year=2017/month=04/day=18
OK
Time taken: 0.188 seconds
OK
Time taken: 0.08 seconds
Query ID = busbi_20170502132938_2efa5f26-5e6e-4239-934b-c16ac6d37c9c
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_632305, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_632305/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_632305
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 13:30:02,134 Stage-1 map = 0%,  reduce = 0%
2017-05-02 13:30:09,461 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 3.55 sec
MapReduce Total cumulative CPU time: 3 seconds 550 msec
Ended Job = job_1493104900716_632305
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_13-29-38_752_8323724401038279120-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=18)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/18/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=18} stats: [numFiles=1, numRows=24, totalSize=1851, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 3.55 sec   HDFS Read: 10487 HDFS Write: 1971 SUCCESS
Total MapReduce CPU Time Spent: 3 seconds 550 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 34.55 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 13:30:02 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 13:30:31 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 13:30:31 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.522 seconds
Query ID = busbi_20170502133036_a831fb14-2db1-45b4-a97e-4bb07a7ed8f8
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 174
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_632466, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_632466/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_632466
Hadoop job information for Stage-3: number of mappers: 162; number of reducers: 174
2017-05-02 13:31:12,381 Stage-3 map = 0%,  reduce = 0%
2017-05-02 13:31:38,236 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 269.86 sec
2017-05-02 13:31:39,267 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 962.49 sec
2017-05-02 13:31:40,301 Stage-3 map = 7%,  reduce = 0%, Cumulative CPU 1827.64 sec
2017-05-02 13:31:41,329 Stage-3 map = 11%,  reduce = 0%, Cumulative CPU 1931.25 sec
2017-05-02 13:31:42,360 Stage-3 map = 16%,  reduce = 0%, Cumulative CPU 2215.92 sec
2017-05-02 13:31:43,405 Stage-3 map = 29%,  reduce = 0%, Cumulative CPU 3058.6 sec
2017-05-02 13:31:44,438 Stage-3 map = 42%,  reduce = 0%, Cumulative CPU 3578.42 sec
2017-05-02 13:31:45,469 Stage-3 map = 51%,  reduce = 0%, Cumulative CPU 3826.96 sec
2017-05-02 13:31:46,517 Stage-3 map = 61%,  reduce = 0%, Cumulative CPU 4099.64 sec
2017-05-02 13:31:47,548 Stage-3 map = 64%,  reduce = 0%, Cumulative CPU 4245.2 sec
2017-05-02 13:31:48,580 Stage-3 map = 67%,  reduce = 0%, Cumulative CPU 4351.65 sec
2017-05-02 13:31:49,611 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 4476.06 sec
2017-05-02 13:31:50,642 Stage-3 map = 70%,  reduce = 0%, Cumulative CPU 4553.5 sec
2017-05-02 13:31:51,672 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 4611.3 sec
2017-05-02 13:31:52,708 Stage-3 map = 73%,  reduce = 0%, Cumulative CPU 4720.62 sec
2017-05-02 13:31:53,740 Stage-3 map = 75%,  reduce = 0%, Cumulative CPU 4794.29 sec
2017-05-02 13:31:54,774 Stage-3 map = 77%,  reduce = 0%, Cumulative CPU 4840.77 sec
2017-05-02 13:31:55,814 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 4926.36 sec
2017-05-02 13:31:56,848 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 4997.78 sec
2017-05-02 13:31:57,886 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 5038.34 sec
2017-05-02 13:31:58,919 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 5115.36 sec
2017-05-02 13:31:59,949 Stage-3 map = 88%,  reduce = 0%, Cumulative CPU 5213.29 sec
2017-05-02 13:32:00,977 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 5251.74 sec
2017-05-02 13:32:02,007 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 5287.44 sec
2017-05-02 13:32:03,046 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 5330.65 sec
2017-05-02 13:32:04,077 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 5367.01 sec
2017-05-02 13:32:05,111 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 5381.87 sec
2017-05-02 13:32:07,187 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 5399.88 sec
2017-05-02 13:32:30,893 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 5401.05 sec
2017-05-02 13:32:40,404 Stage-3 map = 100%,  reduce = 11%, Cumulative CPU 5599.58 sec
2017-05-02 13:32:41,430 Stage-3 map = 100%,  reduce = 37%, Cumulative CPU 6098.7 sec
2017-05-02 13:32:42,464 Stage-3 map = 100%,  reduce = 56%, Cumulative CPU 6476.54 sec
2017-05-02 13:32:43,498 Stage-3 map = 100%,  reduce = 62%, Cumulative CPU 6594.22 sec
2017-05-02 13:32:44,534 Stage-3 map = 100%,  reduce = 68%, Cumulative CPU 6724.55 sec
2017-05-02 13:32:45,563 Stage-3 map = 100%,  reduce = 76%, Cumulative CPU 6918.48 sec
2017-05-02 13:32:46,588 Stage-3 map = 100%,  reduce = 85%, Cumulative CPU 7092.82 sec
2017-05-02 13:32:48,653 Stage-3 map = 100%,  reduce = 89%, Cumulative CPU 7293.98 sec
2017-05-02 13:32:49,683 Stage-3 map = 100%,  reduce = 90%, Cumulative CPU 7315.76 sec
2017-05-02 13:32:50,712 Stage-3 map = 100%,  reduce = 92%, Cumulative CPU 7415.69 sec
2017-05-02 13:32:53,803 Stage-3 map = 100%,  reduce = 94%, Cumulative CPU 7559.45 sec
2017-05-02 13:32:54,837 Stage-3 map = 100%,  reduce = 95%, Cumulative CPU 7615.04 sec
2017-05-02 13:32:55,868 Stage-3 map = 100%,  reduce = 96%, Cumulative CPU 7669.32 sec
2017-05-02 13:32:56,900 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 7725.68 sec
2017-05-02 13:32:57,931 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 7795.33 sec
2017-05-02 13:33:03,073 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 7955.14 sec
2017-05-02 13:34:03,773 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 8783.79 sec
2017-05-02 13:35:04,301 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9330.9 sec
2017-05-02 13:36:04,875 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9737.62 sec
2017-05-02 13:37:05,503 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9948.29 sec
2017-05-02 13:38:06,207 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10134.8 sec
2017-05-02 13:39:06,831 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10319.87 sec
2017-05-02 13:40:07,582 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10453.14 sec
2017-05-02 13:41:08,072 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10574.92 sec
2017-05-02 13:42:08,771 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10699.53 sec
2017-05-02 13:43:09,364 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10826.63 sec
2017-05-02 13:44:09,910 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10954.08 sec
2017-05-02 13:45:10,596 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11081.94 sec
2017-05-02 13:46:11,161 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11208.64 sec
2017-05-02 13:47:11,954 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11332.38 sec
2017-05-02 13:48:12,693 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11400.74 sec
2017-05-02 13:49:13,364 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11463.94 sec
2017-05-02 13:50:14,189 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11525.74 sec
2017-05-02 13:51:14,651 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11588.4 sec
2017-05-02 13:52:15,262 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11651.28 sec
2017-05-02 13:52:29,608 Stage-3 map = 99%,  reduce = 99%, Cumulative CPU 11609.26 sec
2017-05-02 13:53:14,549 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11680.52 sec
2017-05-02 13:54:14,962 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11743.59 sec
2017-05-02 13:55:15,428 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11806.53 sec
2017-05-02 13:56:15,839 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11869.68 sec
2017-05-02 13:57:16,449 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11932.72 sec
2017-05-02 13:58:17,009 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11996.39 sec
2017-05-02 13:59:17,394 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12055.69 sec
2017-05-02 14:00:18,084 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12118.08 sec
2017-05-02 14:01:18,458 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12180.88 sec
2017-05-02 14:02:19,006 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12243.12 sec
2017-05-02 14:03:19,498 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12306.47 sec
2017-05-02 14:04:19,952 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12369.23 sec
2017-05-02 14:05:20,431 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12429.42 sec
2017-05-02 14:06:20,912 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12491.97 sec
2017-05-02 14:07:21,471 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12554.32 sec
2017-05-02 14:08:21,843 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12617.19 sec
2017-05-02 14:09:22,378 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12679.93 sec
2017-05-02 14:10:22,962 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12742.44 sec
2017-05-02 14:11:23,400 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12802.27 sec
2017-05-02 14:12:23,954 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12865.21 sec
2017-05-02 14:13:24,555 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12927.22 sec
2017-05-02 14:14:24,821 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12990.0 sec
2017-05-02 14:15:25,212 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13053.29 sec
2017-05-02 14:16:25,588 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13112.89 sec
2017-05-02 14:17:26,290 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13175.79 sec
2017-05-02 14:18:26,768 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13238.82 sec
2017-05-02 14:19:27,506 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13301.32 sec
2017-05-02 14:20:11,695 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 13348.47 sec
2017-05-02 14:21:12,235 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 13409.15 sec
2017-05-02 14:22:12,737 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 13472.22 sec
2017-05-02 14:23:12,940 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 13528.28 sec
MapReduce Total cumulative CPU time: 0 days 3 hours 45 minutes 28 seconds 280 msec
Ended Job = job_1493104900716_632466
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_639216, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_639216/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_639216
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 3
2017-05-02 14:24:32,966 Stage-4 map = 0%,  reduce = 0%
2017-05-02 14:24:56,588 Stage-4 map = 2%,  reduce = 0%, Cumulative CPU 37.51 sec
2017-05-02 14:24:59,657 Stage-4 map = 7%,  reduce = 0%, Cumulative CPU 48.49 sec
2017-05-02 14:25:02,737 Stage-4 map = 14%,  reduce = 0%, Cumulative CPU 58.48 sec
2017-05-02 14:25:05,817 Stage-4 map = 24%,  reduce = 0%, Cumulative CPU 68.68 sec
2017-05-02 14:25:08,898 Stage-4 map = 33%,  reduce = 0%, Cumulative CPU 78.25 sec
2017-05-02 14:25:11,967 Stage-4 map = 35%,  reduce = 0%, Cumulative CPU 87.37 sec
2017-05-02 14:25:15,039 Stage-4 map = 37%,  reduce = 0%, Cumulative CPU 93.74 sec
2017-05-02 14:25:17,084 Stage-4 map = 48%,  reduce = 0%, Cumulative CPU 99.18 sec
2017-05-02 14:25:18,111 Stage-4 map = 50%,  reduce = 0%, Cumulative CPU 106.77 sec
2017-05-02 14:25:21,208 Stage-4 map = 51%,  reduce = 0%, Cumulative CPU 109.18 sec
2017-05-02 14:25:22,231 Stage-4 map = 52%,  reduce = 0%, Cumulative CPU 112.14 sec
2017-05-02 14:25:24,270 Stage-4 map = 53%,  reduce = 0%, Cumulative CPU 116.15 sec
2017-05-02 14:25:27,324 Stage-4 map = 54%,  reduce = 0%, Cumulative CPU 121.98 sec
2017-05-02 14:25:28,349 Stage-4 map = 55%,  reduce = 0%, Cumulative CPU 124.53 sec
2017-05-02 14:25:30,401 Stage-4 map = 56%,  reduce = 0%, Cumulative CPU 127.66 sec
2017-05-02 14:25:31,421 Stage-4 map = 57%,  reduce = 0%, Cumulative CPU 130.59 sec
2017-05-02 14:25:33,474 Stage-4 map = 58%,  reduce = 0%, Cumulative CPU 134.16 sec
2017-05-02 14:25:34,496 Stage-4 map = 60%,  reduce = 0%, Cumulative CPU 137.46 sec
2017-05-02 14:25:36,552 Stage-4 map = 61%,  reduce = 0%, Cumulative CPU 142.22 sec
2017-05-02 14:25:37,570 Stage-4 map = 62%,  reduce = 0%, Cumulative CPU 146.04 sec
2017-05-02 14:25:39,626 Stage-4 map = 63%,  reduce = 0%, Cumulative CPU 151.98 sec
2017-05-02 14:25:40,645 Stage-4 map = 64%,  reduce = 0%, Cumulative CPU 157.39 sec
2017-05-02 14:25:42,687 Stage-4 map = 65%,  reduce = 0%, Cumulative CPU 126.43 sec
2017-05-02 14:25:44,730 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 133.34 sec
2017-05-02 14:25:45,748 Stage-4 map = 68%,  reduce = 0%, Cumulative CPU 139.69 sec
2017-05-02 14:25:48,807 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 147.5 sec
2017-05-02 14:25:50,858 Stage-4 map = 71%,  reduce = 0%, Cumulative CPU 150.42 sec
2017-05-02 14:25:53,934 Stage-4 map = 73%,  reduce = 0%, Cumulative CPU 156.09 sec
2017-05-02 14:26:00,076 Stage-4 map = 77%,  reduce = 0%, Cumulative CPU 162.96 sec
2017-05-02 14:26:01,096 Stage-4 map = 78%,  reduce = 0%, Cumulative CPU 171.52 sec
2017-05-02 14:26:03,134 Stage-4 map = 82%,  reduce = 0%, Cumulative CPU 174.74 sec
2017-05-02 14:26:06,227 Stage-4 map = 85%,  reduce = 0%, Cumulative CPU 181.06 sec
2017-05-02 14:26:11,346 Stage-4 map = 88%,  reduce = 0%, Cumulative CPU 186.67 sec
2017-05-02 14:26:14,419 Stage-4 map = 89%,  reduce = 0%, Cumulative CPU 189.44 sec
2017-05-02 14:26:32,801 Stage-4 map = 93%,  reduce = 0%, Cumulative CPU 207.5 sec
2017-05-02 14:26:39,011 Stage-4 map = 96%,  reduce = 0%, Cumulative CPU 214.01 sec
2017-05-02 14:26:45,153 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 220.44 sec
2017-05-02 14:27:12,818 Stage-4 map = 100%,  reduce = 14%, Cumulative CPU 233.59 sec
2017-05-02 14:27:14,865 Stage-4 map = 100%,  reduce = 43%, Cumulative CPU 253.5 sec
2017-05-02 14:27:15,881 Stage-4 map = 100%,  reduce = 46%, Cumulative CPU 256.88 sec
2017-05-02 14:27:17,919 Stage-4 map = 100%,  reduce = 51%, Cumulative CPU 263.37 sec
2017-05-02 14:27:18,942 Stage-4 map = 100%,  reduce = 55%, Cumulative CPU 266.68 sec
2017-05-02 14:27:20,988 Stage-4 map = 100%,  reduce = 61%, Cumulative CPU 273.37 sec
2017-05-02 14:27:23,038 Stage-4 map = 100%,  reduce = 63%, Cumulative CPU 282.72 sec
2017-05-02 14:27:24,054 Stage-4 map = 100%,  reduce = 67%, Cumulative CPU 290.69 sec
2017-05-02 14:27:26,125 Stage-4 map = 100%,  reduce = 68%, Cumulative CPU 302.14 sec
2017-05-02 14:27:28,171 Stage-4 map = 100%,  reduce = 69%, Cumulative CPU 327.53 sec
2017-05-02 14:27:29,190 Stage-4 map = 100%,  reduce = 70%, Cumulative CPU 331.23 sec
2017-05-02 14:27:31,232 Stage-4 map = 100%,  reduce = 72%, Cumulative CPU 344.21 sec
2017-05-02 14:27:32,249 Stage-4 map = 100%,  reduce = 74%, Cumulative CPU 347.94 sec
2017-05-02 14:27:34,311 Stage-4 map = 100%,  reduce = 76%, Cumulative CPU 354.02 sec
2017-05-02 14:27:35,344 Stage-4 map = 100%,  reduce = 77%, Cumulative CPU 358.74 sec
2017-05-02 14:27:37,428 Stage-4 map = 100%,  reduce = 79%, Cumulative CPU 366.0 sec
2017-05-02 14:27:38,452 Stage-4 map = 100%,  reduce = 80%, Cumulative CPU 369.13 sec
2017-05-02 14:27:40,495 Stage-4 map = 100%,  reduce = 81%, Cumulative CPU 372.54 sec
2017-05-02 14:27:41,526 Stage-4 map = 100%,  reduce = 83%, Cumulative CPU 382.1 sec
2017-05-02 14:27:43,575 Stage-4 map = 100%,  reduce = 85%, Cumulative CPU 386.78 sec
2017-05-02 14:27:44,602 Stage-4 map = 100%,  reduce = 87%, Cumulative CPU 395.61 sec
2017-05-02 14:27:46,640 Stage-4 map = 100%,  reduce = 88%, Cumulative CPU 398.65 sec
2017-05-02 14:27:47,669 Stage-4 map = 100%,  reduce = 90%, Cumulative CPU 405.74 sec
2017-05-02 14:27:49,714 Stage-4 map = 100%,  reduce = 91%, Cumulative CPU 413.2 sec
2017-05-02 14:27:50,736 Stage-4 map = 100%,  reduce = 92%, Cumulative CPU 417.93 sec
2017-05-02 14:27:52,769 Stage-4 map = 100%,  reduce = 93%, Cumulative CPU 422.56 sec
2017-05-02 14:27:53,792 Stage-4 map = 100%,  reduce = 95%, Cumulative CPU 427.47 sec
2017-05-02 14:27:55,833 Stage-4 map = 100%,  reduce = 96%, Cumulative CPU 431.1 sec
2017-05-02 14:27:56,868 Stage-4 map = 100%,  reduce = 97%, Cumulative CPU 434.58 sec
2017-05-02 14:27:59,949 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 442.41 sec
2017-05-02 14:28:01,991 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 446.97 sec
MapReduce Total cumulative CPU time: 7 minutes 26 seconds 970 msec
Ended Job = job_1493104900716_639216
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_639754, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_639754/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_639754
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 3
2017-05-02 14:28:52,296 Stage-1 map = 0%,  reduce = 0%
2017-05-02 14:29:01,003 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 3.03 sec
2017-05-02 14:29:14,614 Stage-1 map = 46%,  reduce = 0%, Cumulative CPU 38.95 sec
2017-05-02 14:29:15,660 Stage-1 map = 56%,  reduce = 0%, Cumulative CPU 42.51 sec
2017-05-02 14:29:17,758 Stage-1 map = 60%,  reduce = 0%, Cumulative CPU 48.78 sec
2017-05-02 14:29:18,792 Stage-1 map = 64%,  reduce = 0%, Cumulative CPU 54.78 sec
2017-05-02 14:29:23,981 Stage-1 map = 73%,  reduce = 0%, Cumulative CPU 68.44 sec
2017-05-02 14:29:27,100 Stage-1 map = 76%,  reduce = 0%, Cumulative CPU 75.31 sec
2017-05-02 14:29:30,212 Stage-1 map = 79%,  reduce = 0%, Cumulative CPU 81.04 sec
2017-05-02 14:29:31,244 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 84.42 sec
2017-05-02 14:29:34,333 Stage-1 map = 93%,  reduce = 0%, Cumulative CPU 88.46 sec
2017-05-02 14:29:37,416 Stage-1 map = 96%,  reduce = 0%, Cumulative CPU 91.65 sec
2017-05-02 14:29:40,496 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 94.73 sec
2017-05-02 14:30:05,110 Stage-1 map = 100%,  reduce = 53%, Cumulative CPU 127.04 sec
2017-05-02 14:30:08,176 Stage-1 map = 100%,  reduce = 65%, Cumulative CPU 144.31 sec
2017-05-02 14:30:11,249 Stage-1 map = 100%,  reduce = 73%, Cumulative CPU 163.65 sec
2017-05-02 14:30:14,318 Stage-1 map = 100%,  reduce = 79%, Cumulative CPU 178.43 sec
2017-05-02 14:30:18,409 Stage-1 map = 100%,  reduce = 81%, Cumulative CPU 196.07 sec
2017-05-02 14:30:21,469 Stage-1 map = 100%,  reduce = 83%, Cumulative CPU 203.93 sec
2017-05-02 14:30:24,534 Stage-1 map = 100%,  reduce = 86%, Cumulative CPU 212.22 sec
2017-05-02 14:30:26,798 Stage-1 map = 100%,  reduce = 87%, Cumulative CPU 219.96 sec
2017-05-02 14:30:27,827 Stage-1 map = 100%,  reduce = 89%, Cumulative CPU 224.43 sec
2017-05-02 14:30:29,884 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 228.03 sec
2017-05-02 14:30:30,912 Stage-1 map = 100%,  reduce = 91%, Cumulative CPU 231.81 sec
2017-05-02 14:30:32,974 Stage-1 map = 100%,  reduce = 92%, Cumulative CPU 235.12 sec
2017-05-02 14:30:34,002 Stage-1 map = 100%,  reduce = 94%, Cumulative CPU 240.51 sec
2017-05-02 14:30:37,080 Stage-1 map = 100%,  reduce = 96%, Cumulative CPU 247.27 sec
2017-05-02 14:30:38,100 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 248.93 sec
2017-05-02 14:30:40,138 Stage-1 map = 100%,  reduce = 98%, Cumulative CPU 252.51 sec
2017-05-02 14:30:46,261 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 259.22 sec
2017-05-02 14:30:48,303 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 261.87 sec
MapReduce Total cumulative CPU time: 4 minutes 21 seconds 870 msec
Ended Job = job_1493104900716_639754
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_640189, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_640189/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_640189
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 14:31:43,805 Stage-2 map = 0%,  reduce = 0%
2017-05-02 14:31:57,591 Stage-2 map = 5%,  reduce = 0%, Cumulative CPU 10.23 sec
2017-05-02 14:32:10,020 Stage-2 map = 26%,  reduce = 0%, Cumulative CPU 27.16 sec
2017-05-02 14:32:16,304 Stage-2 map = 34%,  reduce = 0%, Cumulative CPU 50.39 sec
2017-05-02 14:32:19,408 Stage-2 map = 50%,  reduce = 0%, Cumulative CPU 57.35 sec
2017-05-02 14:32:29,747 Stage-2 map = 57%,  reduce = 0%, Cumulative CPU 69.79 sec
2017-05-02 14:33:07,044 Stage-2 map = 70%,  reduce = 0%, Cumulative CPU 120.45 sec
2017-05-02 14:33:52,142 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 167.69 sec
2017-05-02 14:34:16,725 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 192.54 sec
2017-05-02 14:34:56,652 Stage-2 map = 100%,  reduce = 68%, Cumulative CPU 221.28 sec
2017-05-02 14:34:59,739 Stage-2 map = 100%,  reduce = 71%, Cumulative CPU 225.52 sec
2017-05-02 14:35:02,890 Stage-2 map = 100%,  reduce = 75%, Cumulative CPU 228.79 sec
2017-05-02 14:35:05,980 Stage-2 map = 100%,  reduce = 79%, Cumulative CPU 233.37 sec
2017-05-02 14:35:09,108 Stage-2 map = 100%,  reduce = 82%, Cumulative CPU 235.86 sec
2017-05-02 14:35:12,211 Stage-2 map = 100%,  reduce = 86%, Cumulative CPU 238.47 sec
2017-05-02 14:35:15,317 Stage-2 map = 100%,  reduce = 91%, Cumulative CPU 241.53 sec
2017-05-02 14:35:18,433 Stage-2 map = 100%,  reduce = 96%, Cumulative CPU 245.35 sec
2017-05-02 14:35:21,522 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 248.38 sec
MapReduce Total cumulative CPU time: 4 minutes 8 seconds 380 msec
Ended Job = job_1493104900716_640189
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 162  Reduce: 174   Cumulative CPU: 13531.18 sec   HDFS Read: 44396547525 HDFS Write: 544782833 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 3   Cumulative CPU: 446.97 sec   HDFS Read: 544851092 HDFS Write: 544763048 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 3   Cumulative CPU: 261.87 sec   HDFS Read: 544814868 HDFS Write: 543198671 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 248.38 sec   HDFS Read: 543213529 HDFS Write: 398266186 SUCCESS
Total MapReduce CPU Time Spent: 0 days 4 hours 1 minutes 28 seconds 400 msec
OK
Time taken: 3888.213 seconds, Fetched: 6063590 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492358400, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 70.39}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 97.99}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 96.65}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 95.71}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 97.08}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.51}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 96.98}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 92.58}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 98.89}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.62}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.02}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 95.94}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 97.33}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 96.61}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 99.3}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.54}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.29}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.68}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 96}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 98.42}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.82}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 98.34}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 96.16}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 14:30:02 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170417' 
        and city_id = '7'
)q

17/05/02 14:36:59 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 14:36:59 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.234 seconds
Query ID = busbi_20170502143704_60f71ffe-30db-4662-bb4a-fa0969b3b03d
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_641047, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_641047/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_641047
Hadoop job information for Stage-1: number of mappers: 12; number of reducers: 1
2017-05-02 14:37:34,514 Stage-1 map = 0%,  reduce = 0%
2017-05-02 14:37:46,960 Stage-1 map = 8%,  reduce = 0%, Cumulative CPU 12.75 sec
2017-05-02 14:38:36,347 Stage-1 map = 11%,  reduce = 0%, Cumulative CPU 170.59 sec
2017-05-02 14:38:37,371 Stage-1 map = 17%,  reduce = 0%, Cumulative CPU 171.49 sec
2017-05-02 14:38:44,557 Stage-1 map = 28%,  reduce = 0%, Cumulative CPU 194.33 sec
2017-05-02 14:38:45,587 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 195.62 sec
2017-05-02 14:38:47,681 Stage-1 map = 39%,  reduce = 0%, Cumulative CPU 214.08 sec
2017-05-02 14:38:48,726 Stage-1 map = 53%,  reduce = 0%, Cumulative CPU 247.24 sec
2017-05-02 14:38:50,803 Stage-1 map = 69%,  reduce = 0%, Cumulative CPU 279.17 sec
2017-05-02 14:38:52,872 Stage-1 map = 75%,  reduce = 0%, Cumulative CPU 286.79 sec
2017-05-02 14:39:12,625 Stage-1 map = 83%,  reduce = 0%, Cumulative CPU 374.48 sec
2017-05-02 14:39:19,803 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 398.32 sec
2017-05-02 14:39:20,828 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 404.24 sec
2017-05-02 14:39:31,162 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 408.85 sec
MapReduce Total cumulative CPU time: 6 minutes 48 seconds 850 msec
Ended Job = job_1493104900716_641047
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 12  Reduce: 1   Cumulative CPU: 408.85 sec   HDFS Read: 2241945272 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 6 minutes 48 seconds 850 msec
OK
Time taken: 149.483 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 14:30:02 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 14:39:45 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/17/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170417(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170417;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170417 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170417';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='17');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='17') location '2017/04/17';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='17')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 14:39:49 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 14:39:49 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.261 seconds
OK
Time taken: 0.053 seconds
OK
Time taken: 0.405 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170417
Table transit_dw.tmp_abnormal_ratio_20170417 stats: [numFiles=1, numRows=0, totalSize=182, rawDataSize=0]
OK
Time taken: 0.413 seconds
Query ID = busbi_20170502143955_e4dedbb3-6d8b-4086-8104-e06939e147d9
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_641298, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_641298/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_641298
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 14:40:32,896 Stage-1 map = 0%,  reduce = 0%
2017-05-02 14:40:43,351 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 6.3 sec
2017-05-02 14:40:50,667 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 11.63 sec
MapReduce Total cumulative CPU time: 11 seconds 630 msec
Ended Job = job_1493104900716_641298
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_14-39-55_244_1482656471693001598-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/7de9ce41-61d3-40a2-939d-51cb50075dfd/_tmp_space.db/65b32b19-95ba-4e04-b048-e3cf0c5fec1a
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6047, rawDataSize=6023]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 11.63 sec   HDFS Read: 18842 HDFS Write: 6144 SUCCESS
Total MapReduce CPU Time Spent: 11 seconds 630 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 60.896 seconds
Dropped the partition year=2017/month=04/day=17
OK
Time taken: 0.182 seconds
OK
Time taken: 0.078 seconds
Query ID = busbi_20170502144056_f3d2645c-dbee-4b26-8c30-91ca757f91d9
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_641470, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_641470/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_641470
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 14:41:28,255 Stage-1 map = 0%,  reduce = 0%
2017-05-02 14:41:35,576 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.96 sec
MapReduce Total cumulative CPU time: 2 seconds 960 msec
Ended Job = job_1493104900716_641470
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_14-40-56_402_5647382503879776174-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=17)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/17/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=17} stats: [numFiles=1, numRows=24, totalSize=1713, rawDataSize=29968]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 2.96 sec   HDFS Read: 10384 HDFS Write: 1833 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 960 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 42.479 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 14:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  245G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 14:41:54 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 14:41:54 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.297 seconds
Query ID = busbi_20170502144159_20e62a40-53a8-4542-8101-fcc6d528333f
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 149
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_641643, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_641643/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_641643
Hadoop job information for Stage-3: number of mappers: 140; number of reducers: 149
2017-05-02 14:42:36,476 Stage-3 map = 0%,  reduce = 0%
2017-05-02 14:43:02,010 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 744.39 sec
2017-05-02 14:43:03,047 Stage-3 map = 6%,  reduce = 0%, Cumulative CPU 1184.95 sec
2017-05-02 14:43:04,092 Stage-3 map = 7%,  reduce = 0%, Cumulative CPU 1615.31 sec
2017-05-02 14:43:05,133 Stage-3 map = 14%,  reduce = 0%, Cumulative CPU 1845.54 sec
2017-05-02 14:43:06,161 Stage-3 map = 18%,  reduce = 0%, Cumulative CPU 2029.28 sec
2017-05-02 14:43:07,188 Stage-3 map = 22%,  reduce = 0%, Cumulative CPU 2299.17 sec
2017-05-02 14:43:08,221 Stage-3 map = 31%,  reduce = 0%, Cumulative CPU 2495.84 sec
2017-05-02 14:43:09,253 Stage-3 map = 39%,  reduce = 0%, Cumulative CPU 2664.43 sec
2017-05-02 14:43:10,290 Stage-3 map = 45%,  reduce = 0%, Cumulative CPU 2889.18 sec
2017-05-02 14:43:11,320 Stage-3 map = 47%,  reduce = 0%, Cumulative CPU 3023.99 sec
2017-05-02 14:43:12,351 Stage-3 map = 52%,  reduce = 0%, Cumulative CPU 3120.79 sec
2017-05-02 14:43:13,391 Stage-3 map = 59%,  reduce = 0%, Cumulative CPU 3329.0 sec
2017-05-02 14:43:14,433 Stage-3 map = 60%,  reduce = 0%, Cumulative CPU 3412.42 sec
2017-05-02 14:43:15,468 Stage-3 map = 61%,  reduce = 0%, Cumulative CPU 3468.59 sec
2017-05-02 14:43:16,500 Stage-3 map = 66%,  reduce = 0%, Cumulative CPU 3618.63 sec
2017-05-02 14:43:17,529 Stage-3 map = 67%,  reduce = 0%, Cumulative CPU 3670.88 sec
2017-05-02 14:43:18,559 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 3769.47 sec
2017-05-02 14:43:19,593 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 3873.16 sec
2017-05-02 14:43:20,621 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 3938.16 sec
2017-05-02 14:43:21,650 Stage-3 map = 73%,  reduce = 0%, Cumulative CPU 3966.2 sec
2017-05-02 14:43:22,684 Stage-3 map = 75%,  reduce = 0%, Cumulative CPU 4102.5 sec
2017-05-02 14:43:24,740 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 4227.1 sec
2017-05-02 14:43:25,770 Stage-3 map = 77%,  reduce = 0%, Cumulative CPU 4306.68 sec
2017-05-02 14:43:27,844 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 4383.66 sec
2017-05-02 14:43:28,873 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 4448.94 sec
2017-05-02 14:43:29,901 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 4503.62 sec
2017-05-02 14:43:31,987 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 4608.57 sec
2017-05-02 14:43:33,023 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 4664.85 sec
2017-05-02 14:43:34,054 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 4679.56 sec
2017-05-02 14:43:35,083 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 4746.36 sec
2017-05-02 14:43:37,154 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 4819.23 sec
2017-05-02 14:43:38,201 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 4875.13 sec
2017-05-02 14:43:39,238 Stage-3 map = 88%,  reduce = 0%, Cumulative CPU 4900.46 sec
2017-05-02 14:43:41,311 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 4952.44 sec
2017-05-02 14:43:44,407 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 5020.76 sec
2017-05-02 14:43:47,521 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 5073.87 sec
2017-05-02 14:43:49,593 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 5092.3 sec
2017-05-02 14:43:52,693 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 5147.94 sec
2017-05-02 14:43:53,728 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 5159.7 sec
2017-05-02 14:43:55,826 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 5185.98 sec
2017-05-02 14:44:00,972 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 5230.8 sec
2017-05-02 14:44:09,266 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 5299.21 sec
2017-05-02 14:44:13,400 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 5294.07 sec
2017-05-02 14:44:21,669 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 5334.02 sec
2017-05-02 14:44:24,756 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 5347.11 sec
2017-05-02 14:44:29,009 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 5278.57 sec
2017-05-02 14:44:39,358 Stage-3 map = 99%,  reduce = 7%, Cumulative CPU 5312.35 sec
2017-05-02 14:44:40,395 Stage-3 map = 99%,  reduce = 14%, Cumulative CPU 5351.42 sec
2017-05-02 14:44:41,427 Stage-3 map = 99%,  reduce = 20%, Cumulative CPU 5390.8 sec
2017-05-02 14:44:42,458 Stage-3 map = 99%,  reduce = 22%, Cumulative CPU 5405.63 sec
2017-05-02 14:44:43,492 Stage-3 map = 99%,  reduce = 23%, Cumulative CPU 5420.82 sec
2017-05-02 14:44:44,522 Stage-3 map = 99%,  reduce = 24%, Cumulative CPU 5432.82 sec
2017-05-02 14:44:45,551 Stage-3 map = 99%,  reduce = 25%, Cumulative CPU 5451.05 sec
2017-05-02 14:44:46,576 Stage-3 map = 99%,  reduce = 26%, Cumulative CPU 5489.66 sec
2017-05-02 14:44:47,600 Stage-3 map = 99%,  reduce = 27%, Cumulative CPU 5501.34 sec
2017-05-02 14:44:49,656 Stage-3 map = 99%,  reduce = 28%, Cumulative CPU 5535.88 sec
2017-05-02 14:44:51,721 Stage-3 map = 100%,  reduce = 29%, Cumulative CPU 5565.6 sec
2017-05-02 14:44:52,757 Stage-3 map = 100%,  reduce = 33%, Cumulative CPU 5597.47 sec
2017-05-02 14:44:53,784 Stage-3 map = 100%,  reduce = 44%, Cumulative CPU 5718.67 sec
2017-05-02 14:44:54,822 Stage-3 map = 100%,  reduce = 72%, Cumulative CPU 6338.45 sec
2017-05-02 14:44:55,871 Stage-3 map = 100%,  reduce = 83%, Cumulative CPU 6681.2 sec
2017-05-02 14:44:56,909 Stage-3 map = 100%,  reduce = 89%, Cumulative CPU 6921.94 sec
2017-05-02 14:44:57,954 Stage-3 map = 100%,  reduce = 92%, Cumulative CPU 7095.89 sec
2017-05-02 14:44:59,025 Stage-3 map = 100%,  reduce = 94%, Cumulative CPU 7212.72 sec
2017-05-02 14:45:00,073 Stage-3 map = 100%,  reduce = 95%, Cumulative CPU 7294.82 sec
2017-05-02 14:45:02,133 Stage-3 map = 100%,  reduce = 96%, Cumulative CPU 7416.76 sec
2017-05-02 14:45:04,191 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 7521.85 sec
2017-05-02 14:45:05,223 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 7594.69 sec
2017-05-02 14:45:07,283 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 7670.43 sec
2017-05-02 14:46:08,126 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 8816.14 sec
2017-05-02 14:47:08,777 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9714.96 sec
2017-05-02 14:48:09,675 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10359.54 sec
2017-05-02 14:49:10,494 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10924.43 sec
2017-05-02 14:50:11,235 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11395.98 sec
2017-05-02 14:51:11,743 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11684.55 sec
2017-05-02 14:52:12,437 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11938.95 sec
2017-05-02 14:53:13,155 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12122.73 sec
2017-05-02 14:54:13,785 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12248.09 sec
2017-05-02 14:55:14,445 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12378.78 sec
2017-05-02 14:56:14,763 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12505.24 sec
2017-05-02 14:57:15,290 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12631.47 sec
2017-05-02 14:58:15,779 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12760.66 sec
2017-05-02 14:59:16,348 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12887.84 sec
2017-05-02 15:00:16,817 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13012.7 sec
2017-05-02 15:01:17,323 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13142.22 sec
2017-05-02 15:02:17,844 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13270.65 sec
2017-05-02 15:03:18,298 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13400.31 sec
2017-05-02 15:04:18,690 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13525.07 sec
2017-05-02 15:05:19,063 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13655.31 sec
2017-05-02 15:06:19,292 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13785.85 sec
2017-05-02 15:07:19,557 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13848.26 sec
2017-05-02 15:08:19,879 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13913.53 sec
2017-05-02 15:09:20,080 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13978.1 sec
2017-05-02 15:10:20,465 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14040.14 sec
2017-05-02 15:11:21,019 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14106.07 sec
2017-05-02 15:12:21,488 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14170.86 sec
2017-05-02 15:13:22,011 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14235.64 sec
2017-05-02 15:14:22,739 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14297.24 sec
2017-05-02 15:15:23,097 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14361.3 sec
2017-05-02 15:16:23,759 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14426.58 sec
2017-05-02 15:17:24,348 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14492.72 sec
2017-05-02 15:18:24,936 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14556.4 sec
2017-05-02 15:19:25,458 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14620.21 sec
2017-05-02 15:20:26,056 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14684.28 sec
2017-05-02 15:21:26,681 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14746.02 sec
2017-05-02 15:22:13,895 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 14797.7 sec
2017-05-02 15:23:14,356 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 14851.32 sec
MapReduce Total cumulative CPU time: 0 days 4 hours 7 minutes 31 seconds 320 msec
Ended Job = job_1493104900716_641643
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_646248, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_646248/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_646248
Hadoop job information for Stage-4: number of mappers: 2; number of reducers: 2
2017-05-02 15:24:40,869 Stage-4 map = 0%,  reduce = 0%
2017-05-02 15:24:56,912 Stage-4 map = 7%,  reduce = 0%, Cumulative CPU 19.61 sec
2017-05-02 15:25:00,021 Stage-4 map = 13%,  reduce = 0%, Cumulative CPU 26.49 sec
2017-05-02 15:25:03,159 Stage-4 map = 20%,  reduce = 0%, Cumulative CPU 33.33 sec
2017-05-02 15:25:06,276 Stage-4 map = 25%,  reduce = 0%, Cumulative CPU 40.27 sec
2017-05-02 15:25:09,376 Stage-4 map = 31%,  reduce = 0%, Cumulative CPU 48.16 sec
2017-05-02 15:25:12,494 Stage-4 map = 36%,  reduce = 0%, Cumulative CPU 55.46 sec
2017-05-02 15:25:15,612 Stage-4 map = 42%,  reduce = 0%, Cumulative CPU 63.12 sec
2017-05-02 15:25:18,709 Stage-4 map = 46%,  reduce = 0%, Cumulative CPU 70.87 sec
2017-05-02 15:25:21,819 Stage-4 map = 50%,  reduce = 0%, Cumulative CPU 81.19 sec
2017-05-02 15:25:25,010 Stage-4 map = 54%,  reduce = 0%, Cumulative CPU 93.65 sec
2017-05-02 15:25:28,200 Stage-4 map = 56%,  reduce = 0%, Cumulative CPU 103.13 sec
2017-05-02 15:25:31,291 Stage-4 map = 57%,  reduce = 0%, Cumulative CPU 109.79 sec
2017-05-02 15:25:34,365 Stage-4 map = 61%,  reduce = 0%, Cumulative CPU 115.33 sec
2017-05-02 15:25:37,429 Stage-4 map = 66%,  reduce = 0%, Cumulative CPU 119.89 sec
2017-05-02 15:25:40,492 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 126.52 sec
2017-05-02 15:25:43,589 Stage-4 map = 75%,  reduce = 0%, Cumulative CPU 133.63 sec
2017-05-02 15:25:46,685 Stage-4 map = 90%,  reduce = 0%, Cumulative CPU 140.38 sec
2017-05-02 15:25:49,775 Stage-4 map = 98%,  reduce = 0%, Cumulative CPU 144.01 sec
2017-05-02 15:25:50,805 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 147.24 sec
2017-05-02 15:26:08,291 Stage-4 map = 100%,  reduce = 32%, Cumulative CPU 163.93 sec
2017-05-02 15:26:11,383 Stage-4 map = 100%,  reduce = 35%, Cumulative CPU 172.49 sec
2017-05-02 15:26:13,456 Stage-4 map = 100%,  reduce = 58%, Cumulative CPU 183.77 sec
2017-05-02 15:26:14,508 Stage-4 map = 100%,  reduce = 62%, Cumulative CPU 187.42 sec
2017-05-02 15:26:16,582 Stage-4 map = 100%,  reduce = 66%, Cumulative CPU 190.69 sec
2017-05-02 15:26:17,606 Stage-4 map = 100%,  reduce = 70%, Cumulative CPU 195.11 sec
2017-05-02 15:26:19,667 Stage-4 map = 100%,  reduce = 75%, Cumulative CPU 198.44 sec
2017-05-02 15:26:20,694 Stage-4 map = 100%,  reduce = 78%, Cumulative CPU 202.35 sec
2017-05-02 15:26:22,746 Stage-4 map = 100%,  reduce = 84%, Cumulative CPU 219.47 sec
2017-05-02 15:26:25,838 Stage-4 map = 100%,  reduce = 86%, Cumulative CPU 226.74 sec
2017-05-02 15:26:28,906 Stage-4 map = 100%,  reduce = 88%, Cumulative CPU 230.12 sec
2017-05-02 15:26:31,967 Stage-4 map = 100%,  reduce = 90%, Cumulative CPU 233.81 sec
2017-05-02 15:26:35,027 Stage-4 map = 100%,  reduce = 92%, Cumulative CPU 238.92 sec
2017-05-02 15:26:38,096 Stage-4 map = 100%,  reduce = 94%, Cumulative CPU 243.17 sec
2017-05-02 15:26:41,157 Stage-4 map = 100%,  reduce = 96%, Cumulative CPU 246.49 sec
2017-05-02 15:26:44,216 Stage-4 map = 100%,  reduce = 98%, Cumulative CPU 246.49 sec
2017-05-02 15:26:48,303 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 254.36 sec
MapReduce Total cumulative CPU time: 4 minutes 14 seconds 360 msec
Ended Job = job_1493104900716_646248
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_646594, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_646594/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_646594
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 2
2017-05-02 15:27:25,540 Stage-1 map = 0%,  reduce = 0%
2017-05-02 15:27:34,854 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 3.61 sec
2017-05-02 15:27:45,396 Stage-1 map = 40%,  reduce = 0%, Cumulative CPU 40.38 sec
2017-05-02 15:27:51,690 Stage-1 map = 62%,  reduce = 0%, Cumulative CPU 55.12 sec
2017-05-02 15:27:52,734 Stage-1 map = 73%,  reduce = 0%, Cumulative CPU 56.01 sec
2017-05-02 15:28:01,202 Stage-1 map = 82%,  reduce = 0%, Cumulative CPU 72.14 sec
2017-05-02 15:28:10,596 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 82.17 sec
2017-05-02 15:28:13,731 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 85.86 sec
2017-05-02 15:28:20,035 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 92.49 sec
2017-05-02 15:28:34,711 Stage-1 map = 100%,  reduce = 35%, Cumulative CPU 106.35 sec
2017-05-02 15:28:36,782 Stage-1 map = 100%,  reduce = 70%, Cumulative CPU 117.8 sec
2017-05-02 15:28:37,821 Stage-1 map = 100%,  reduce = 74%, Cumulative CPU 121.36 sec
2017-05-02 15:28:39,877 Stage-1 map = 100%,  reduce = 80%, Cumulative CPU 125.25 sec
2017-05-02 15:28:40,904 Stage-1 map = 100%,  reduce = 83%, Cumulative CPU 129.67 sec
2017-05-02 15:28:42,954 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 133.98 sec
2017-05-02 15:28:44,000 Stage-1 map = 100%,  reduce = 95%, Cumulative CPU 139.11 sec
2017-05-02 15:28:47,078 Stage-1 map = 100%,  reduce = 98%, Cumulative CPU 142.48 sec
2017-05-02 15:28:50,162 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 145.5 sec
MapReduce Total cumulative CPU time: 2 minutes 25 seconds 500 msec
Ended Job = job_1493104900716_646594
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_646783, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_646783/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_646783
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 15:29:56,775 Stage-2 map = 0%,  reduce = 0%
2017-05-02 15:30:12,131 Stage-2 map = 3%,  reduce = 0%, Cumulative CPU 9.44 sec
2017-05-02 15:30:15,372 Stage-2 map = 9%,  reduce = 0%, Cumulative CPU 25.57 sec
2017-05-02 15:30:21,794 Stage-2 map = 26%,  reduce = 0%, Cumulative CPU 39.05 sec
2017-05-02 15:30:28,129 Stage-2 map = 50%,  reduce = 0%, Cumulative CPU 60.23 sec
2017-05-02 15:30:34,373 Stage-2 map = 67%,  reduce = 0%, Cumulative CPU 74.29 sec
2017-05-02 15:30:39,629 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 84.44 sec
2017-05-02 15:30:42,782 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 88.06 sec
2017-05-02 15:31:10,295 Stage-2 map = 100%,  reduce = 73%, Cumulative CPU 103.27 sec
2017-05-02 15:31:13,396 Stage-2 map = 100%,  reduce = 77%, Cumulative CPU 105.89 sec
2017-05-02 15:31:17,527 Stage-2 map = 100%,  reduce = 81%, Cumulative CPU 110.69 sec
2017-05-02 15:31:20,665 Stage-2 map = 100%,  reduce = 86%, Cumulative CPU 113.39 sec
2017-05-02 15:31:23,785 Stage-2 map = 100%,  reduce = 92%, Cumulative CPU 116.56 sec
2017-05-02 15:31:26,926 Stage-2 map = 100%,  reduce = 96%, Cumulative CPU 119.48 sec
2017-05-02 15:31:30,157 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 122.38 sec
MapReduce Total cumulative CPU time: 2 minutes 2 seconds 380 msec
Ended Job = job_1493104900716_646783
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 140  Reduce: 149   Cumulative CPU: 14854.76 sec   HDFS Read: 38036988042 HDFS Write: 456543491 SUCCESS
Stage-Stage-4: Map: 2  Reduce: 2   Cumulative CPU: 254.36 sec   HDFS Read: 456598930 HDFS Write: 456528186 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 2   Cumulative CPU: 145.5 sec   HDFS Read: 456572275 HDFS Write: 455073525 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 122.38 sec   HDFS Read: 455091228 HDFS Write: 333656594 SUCCESS
Total MapReduce CPU Time Spent: 0 days 4 hours 16 minutes 17 seconds 0 msec
OK
Time taken: 2974.642 seconds, Fetched: 5083008 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492272000, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 59.6}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 96.95}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 95.08}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 93.77}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 95.81}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 97.59}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 96.88}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 87.93}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 98.38}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.09}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 98.55}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 95}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 97.25}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 95.28}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 98.96}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.49}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.09}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.31}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 94.96}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 98.14}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 97.99}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 97.42}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 94.94}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 15:30:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  244G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170416' 
        and city_id = '7'
)q

17/05/02 15:32:59 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 15:32:59 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.515 seconds
Query ID = busbi_20170502153305_e6c0b300-4f44-4781-bfe6-2757b5c7f2c9
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_647283, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_647283/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_647283
Hadoop job information for Stage-1: number of mappers: 9; number of reducers: 1
2017-05-02 15:33:34,990 Stage-1 map = 0%,  reduce = 0%
2017-05-02 15:33:50,592 Stage-1 map = 7%,  reduce = 0%, Cumulative CPU 118.13 sec
2017-05-02 15:33:53,681 Stage-1 map = 11%,  reduce = 0%, Cumulative CPU 174.48 sec
2017-05-02 15:33:55,739 Stage-1 map = 37%,  reduce = 0%, Cumulative CPU 207.03 sec
2017-05-02 15:33:57,807 Stage-1 map = 44%,  reduce = 0%, Cumulative CPU 226.46 sec
2017-05-02 15:33:59,878 Stage-1 map = 52%,  reduce = 0%, Cumulative CPU 250.4 sec
2017-05-02 15:34:00,911 Stage-1 map = 78%,  reduce = 0%, Cumulative CPU 264.45 sec
2017-05-02 15:34:01,959 Stage-1 map = 85%,  reduce = 0%, Cumulative CPU 269.11 sec
2017-05-02 15:34:07,142 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 294.94 sec
2017-05-02 15:34:26,874 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 306.91 sec
MapReduce Total cumulative CPU time: 5 minutes 6 seconds 910 msec
Ended Job = job_1493104900716_647283
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 9  Reduce: 1   Cumulative CPU: 306.91 sec   HDFS Read: 1632893369 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 5 minutes 6 seconds 910 msec
OK
Time taken: 84.218 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 15:30:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  244G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 15:34:40 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/16/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170416(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170416;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170416 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170416';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='16');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='16') location '2017/04/16';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='16')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 15:34:44 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 15:34:44 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.795 seconds
OK
Time taken: 0.074 seconds
OK
Time taken: 0.444 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170416
Table transit_dw.tmp_abnormal_ratio_20170416 stats: [numFiles=1, numRows=0, totalSize=180, rawDataSize=0]
OK
Time taken: 0.551 seconds
Query ID = busbi_20170502153450_e61e4aca-e8a4-4f7a-8e7e-d4edc1ba84a8
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_647457, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_647457/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_647457
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 15:35:31,523 Stage-1 map = 0%,  reduce = 0%
2017-05-02 15:35:39,056 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 5.01 sec
2017-05-02 15:35:47,407 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 8.48 sec
MapReduce Total cumulative CPU time: 8 seconds 480 msec
Ended Job = job_1493104900716_647457
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_15-34-50_792_4939680746114454182-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/a133e002-7d4e-4899-aa58-d254c67e4fa9/_tmp_space.db/a4365f55-ee2b-45b1-ae9d-6197a1af3037
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6148, rawDataSize=6124]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 8.48 sec   HDFS Read: 19134 HDFS Write: 6245 SUCCESS
Total MapReduce CPU Time Spent: 8 seconds 480 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 61.285 seconds
Dropped the partition year=2017/month=04/day=16
OK
Time taken: 0.223 seconds
OK
Time taken: 0.073 seconds
Query ID = busbi_20170502153552_fbb6247a-8a14-4dfc-ba13-9c4848b20b33
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_647571, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_647571/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_647571
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 15:36:23,112 Stage-1 map = 0%,  reduce = 0%
2017-05-02 15:36:32,634 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.82 sec
MapReduce Total cumulative CPU time: 2 seconds 820 msec
Ended Job = job_1493104900716_647571
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_15-35-52_379_6372037277866553069-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=16)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/16/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=16} stats: [numFiles=1, numRows=24, totalSize=1838, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 2.82 sec   HDFS Read: 10493 HDFS Write: 1958 SUCCESS
Total MapReduce CPU Time Spent: 2 seconds 820 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 42.45 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 15:30:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  244G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
34G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
26G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 15:36:49 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 15:36:49 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.824 seconds
Query ID = busbi_20170502153655_2f8f1e0a-c459-48c5-9874-8d9b97a3efed
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 166
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_647664, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_647664/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_647664
Hadoop job information for Stage-3: number of mappers: 153; number of reducers: 166
2017-05-02 15:37:35,700 Stage-3 map = 0%,  reduce = 0%
2017-05-02 15:38:52,226 Stage-3 map = 0%,  reduce = 0%
2017-05-02 15:39:11,856 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 1226.11 sec
2017-05-02 15:39:12,907 Stage-3 map = 3%,  reduce = 0%, Cumulative CPU 1458.27 sec
2017-05-02 15:39:13,944 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 1622.86 sec
2017-05-02 15:39:14,979 Stage-3 map = 5%,  reduce = 0%, Cumulative CPU 1709.92 sec
2017-05-02 15:39:16,012 Stage-3 map = 9%,  reduce = 0%, Cumulative CPU 1951.23 sec
2017-05-02 15:39:17,054 Stage-3 map = 11%,  reduce = 0%, Cumulative CPU 2271.74 sec
2017-05-02 15:39:18,111 Stage-3 map = 13%,  reduce = 0%, Cumulative CPU 2458.61 sec
2017-05-02 15:39:19,180 Stage-3 map = 19%,  reduce = 0%, Cumulative CPU 2759.79 sec
2017-05-02 15:39:20,210 Stage-3 map = 23%,  reduce = 0%, Cumulative CPU 2973.13 sec
2017-05-02 15:39:21,250 Stage-3 map = 27%,  reduce = 0%, Cumulative CPU 3117.23 sec
2017-05-02 15:39:22,296 Stage-3 map = 31%,  reduce = 0%, Cumulative CPU 3399.62 sec
2017-05-02 15:39:23,330 Stage-3 map = 35%,  reduce = 0%, Cumulative CPU 3565.02 sec
2017-05-02 15:39:24,362 Stage-3 map = 39%,  reduce = 0%, Cumulative CPU 3689.69 sec
2017-05-02 15:39:25,420 Stage-3 map = 45%,  reduce = 0%, Cumulative CPU 3950.5 sec
2017-05-02 15:39:26,462 Stage-3 map = 50%,  reduce = 0%, Cumulative CPU 4101.29 sec
2017-05-02 15:39:27,483 Stage-3 map = 53%,  reduce = 0%, Cumulative CPU 4211.62 sec
2017-05-02 15:39:28,521 Stage-3 map = 56%,  reduce = 0%, Cumulative CPU 4356.76 sec
2017-05-02 15:39:29,547 Stage-3 map = 59%,  reduce = 0%, Cumulative CPU 4514.43 sec
2017-05-02 15:39:30,575 Stage-3 map = 60%,  reduce = 0%, Cumulative CPU 4624.65 sec
2017-05-02 15:39:31,613 Stage-3 map = 62%,  reduce = 0%, Cumulative CPU 4746.55 sec
2017-05-02 15:39:32,669 Stage-3 map = 64%,  reduce = 0%, Cumulative CPU 4870.41 sec
2017-05-02 15:39:33,712 Stage-3 map = 67%,  reduce = 0%, Cumulative CPU 4961.47 sec
2017-05-02 15:39:34,757 Stage-3 map = 68%,  reduce = 0%, Cumulative CPU 5027.93 sec
2017-05-02 15:39:35,793 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 5161.05 sec
2017-05-02 15:39:36,832 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 5245.28 sec
2017-05-02 15:39:37,873 Stage-3 map = 75%,  reduce = 0%, Cumulative CPU 5296.51 sec
2017-05-02 15:39:38,916 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 5406.82 sec
2017-05-02 15:39:39,948 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 5459.84 sec
2017-05-02 15:39:40,978 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 5519.23 sec
2017-05-02 15:39:42,014 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 5595.34 sec
2017-05-02 15:39:43,044 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 5631.68 sec
2017-05-02 15:39:44,070 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 5665.92 sec
2017-05-02 15:39:45,097 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 5723.94 sec
2017-05-02 15:39:46,135 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 5770.3 sec
2017-05-02 15:39:47,164 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 5806.36 sec
2017-05-02 15:39:49,225 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 5895.9 sec
2017-05-02 15:39:51,279 Stage-3 map = 88%,  reduce = 0%, Cumulative CPU 5940.04 sec
2017-05-02 15:39:52,309 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 6003.47 sec
2017-05-02 15:39:55,405 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 6064.13 sec
2017-05-02 15:39:56,434 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 6081.54 sec
2017-05-02 15:39:59,546 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 6157.52 sec
2017-05-02 15:40:01,609 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 6203.01 sec
2017-05-02 15:40:03,664 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 6238.5 sec
2017-05-02 15:40:04,692 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 6255.82 sec
2017-05-02 15:40:08,838 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 6283.81 sec
2017-05-02 15:40:10,902 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 6303.66 sec
2017-05-02 15:40:12,953 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 6332.88 sec
2017-05-02 15:40:15,007 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 6353.08 sec
2017-05-02 15:40:20,156 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 6370.41 sec
2017-05-02 15:40:31,864 Stage-3 map = 100%,  reduce = 13%, Cumulative CPU 6604.6 sec
2017-05-02 15:40:32,893 Stage-3 map = 100%,  reduce = 31%, Cumulative CPU 6930.92 sec
2017-05-02 15:40:33,918 Stage-3 map = 100%,  reduce = 41%, Cumulative CPU 7133.5 sec
2017-05-02 15:40:34,954 Stage-3 map = 100%,  reduce = 46%, Cumulative CPU 7240.82 sec
2017-05-02 15:40:35,985 Stage-3 map = 100%,  reduce = 59%, Cumulative CPU 7531.8 sec
2017-05-02 15:40:37,021 Stage-3 map = 100%,  reduce = 60%, Cumulative CPU 7557.78 sec
2017-05-02 15:40:38,063 Stage-3 map = 100%,  reduce = 62%, Cumulative CPU 7604.87 sec
2017-05-02 15:40:39,098 Stage-3 map = 100%,  reduce = 66%, Cumulative CPU 7732.89 sec
2017-05-02 15:40:40,131 Stage-3 map = 100%,  reduce = 72%, Cumulative CPU 7888.85 sec
2017-05-02 15:40:41,163 Stage-3 map = 100%,  reduce = 77%, Cumulative CPU 8070.94 sec
2017-05-02 15:40:42,200 Stage-3 map = 100%,  reduce = 80%, Cumulative CPU 8187.9 sec
2017-05-02 15:40:43,232 Stage-3 map = 100%,  reduce = 82%, Cumulative CPU 8253.36 sec
2017-05-02 15:40:44,260 Stage-3 map = 100%,  reduce = 86%, Cumulative CPU 8404.47 sec
2017-05-02 15:40:45,296 Stage-3 map = 100%,  reduce = 88%, Cumulative CPU 8528.39 sec
2017-05-02 15:40:46,327 Stage-3 map = 100%,  reduce = 90%, Cumulative CPU 8579.46 sec
2017-05-02 15:40:47,355 Stage-3 map = 100%,  reduce = 91%, Cumulative CPU 8682.75 sec
2017-05-02 15:40:48,390 Stage-3 map = 100%,  reduce = 93%, Cumulative CPU 8761.28 sec
2017-05-02 15:40:49,421 Stage-3 map = 100%,  reduce = 94%, Cumulative CPU 8789.28 sec
2017-05-02 15:40:50,455 Stage-3 map = 100%,  reduce = 95%, Cumulative CPU 8857.5 sec
2017-05-02 15:40:51,487 Stage-3 map = 100%,  reduce = 96%, Cumulative CPU 8931.59 sec
2017-05-02 15:40:53,543 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 8988.22 sec
2017-05-02 15:40:54,581 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 9055.41 sec
2017-05-02 15:40:55,626 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9090.64 sec
2017-05-02 15:41:56,408 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10216.24 sec
2017-05-02 15:42:57,220 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10862.71 sec
2017-05-02 15:43:58,001 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11356.52 sec
2017-05-02 15:44:58,808 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11857.56 sec
2017-05-02 15:45:59,649 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12319.03 sec
2017-05-02 15:47:00,447 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12760.17 sec
2017-05-02 15:48:01,116 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13185.11 sec
2017-05-02 15:49:01,286 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13529.75 sec
2017-05-02 15:50:01,972 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13729.26 sec
2017-05-02 15:51:02,711 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13916.69 sec
2017-05-02 15:52:03,384 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14103.38 sec
2017-05-02 15:53:03,964 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14230.45 sec
2017-05-02 15:54:04,315 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14355.2 sec
2017-05-02 15:55:04,943 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14482.77 sec
2017-05-02 15:56:05,733 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14609.52 sec
2017-05-02 15:57:06,326 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14671.63 sec
2017-05-02 15:58:06,967 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14736.96 sec
2017-05-02 15:59:07,585 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14802.03 sec
2017-05-02 16:00:08,205 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14866.8 sec
2017-05-02 16:01:09,219 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14928.51 sec
2017-05-02 16:02:09,431 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14994.14 sec
2017-05-02 16:03:10,106 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15056.08 sec
2017-05-02 16:04:10,710 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15121.28 sec
2017-05-02 16:05:11,169 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15186.77 sec
2017-05-02 16:06:11,609 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15249.4 sec
2017-05-02 16:07:12,208 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15311.85 sec
2017-05-02 16:08:12,628 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15377.47 sec
2017-05-02 16:09:12,758 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15439.69 sec
2017-05-02 16:10:13,093 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15504.88 sec
2017-05-02 16:11:13,512 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15567.18 sec
2017-05-02 16:12:14,074 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15632.32 sec
2017-05-02 16:13:14,586 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15695.08 sec
2017-05-02 16:14:14,875 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15754.45 sec
2017-05-02 16:15:15,193 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15816.66 sec
2017-05-02 16:16:15,840 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15881.86 sec
2017-05-02 16:17:16,572 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15947.52 sec
2017-05-02 16:18:17,174 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16009.6 sec
2017-05-02 16:19:17,672 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16074.94 sec
2017-05-02 16:20:18,042 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16140.27 sec
2017-05-02 16:21:18,705 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16202.05 sec
2017-05-02 16:22:19,279 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16267.03 sec
2017-05-02 16:23:19,732 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16332.16 sec
2017-05-02 16:24:20,155 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16394.27 sec
2017-05-02 16:25:20,524 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16459.25 sec
2017-05-02 16:26:20,922 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16520.81 sec
2017-05-02 16:26:54,769 Stage-3 map = 99%,  reduce = 99%, Cumulative CPU 16466.72 sec
2017-05-02 16:27:43,790 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13562.27 sec
2017-05-02 16:28:44,338 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13633.55 sec
2017-05-02 16:29:44,684 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13696.78 sec
2017-05-02 16:30:45,112 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13763.13 sec
2017-05-02 16:31:45,526 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13828.21 sec
2017-05-02 16:32:46,158 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13894.62 sec
2017-05-02 16:33:46,746 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13958.79 sec
2017-05-02 16:34:47,331 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14024.12 sec
2017-05-02 16:35:48,147 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14085.29 sec
2017-05-02 16:36:48,807 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14149.67 sec
2017-05-02 16:37:49,688 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14214.49 sec
2017-05-02 16:38:50,328 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14278.65 sec
2017-05-02 16:39:51,062 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14340.45 sec
2017-05-02 16:40:51,576 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14405.26 sec
2017-05-02 16:41:52,229 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14469.83 sec
2017-05-02 16:42:52,862 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14533.37 sec
2017-05-02 16:43:53,399 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14598.28 sec
2017-05-02 16:44:54,005 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14659.31 sec
2017-05-02 16:45:54,624 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14724.61 sec
2017-05-02 16:46:55,083 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14788.61 sec
2017-05-02 16:47:55,751 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14851.11 sec
2017-05-02 16:48:56,626 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14916.66 sec
2017-05-02 16:49:57,403 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14982.45 sec
2017-05-02 16:50:58,211 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15047.74 sec
2017-05-02 16:51:59,196 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15110.16 sec
2017-05-02 16:53:00,194 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15177.02 sec
2017-05-02 16:54:00,958 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15241.31 sec
2017-05-02 16:55:01,770 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15304.66 sec
2017-05-02 16:56:02,294 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15371.24 sec
2017-05-02 16:57:02,918 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15434.01 sec
2017-05-02 16:58:03,590 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15498.85 sec
2017-05-02 16:59:04,185 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15560.37 sec
2017-05-02 17:00:04,770 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15626.54 sec
2017-05-02 17:01:05,325 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15689.18 sec
2017-05-02 17:02:05,953 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15751.32 sec
2017-05-02 17:03:06,685 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15815.06 sec
2017-05-02 17:04:07,514 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15873.18 sec
2017-05-02 17:05:08,323 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15932.44 sec
2017-05-02 17:06:09,103 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15990.11 sec
2017-05-02 17:06:55,381 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 16036.71 sec
2017-05-02 17:07:55,981 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 16095.48 sec
2017-05-02 17:08:56,525 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 16156.08 sec
2017-05-02 17:09:57,157 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 16220.06 sec
2017-05-02 17:10:57,331 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 16280.59 sec
MapReduce Total cumulative CPU time: 0 days 4 hours 31 minutes 20 seconds 590 msec
Ended Job = job_1493104900716_647664
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_654702, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_654702/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_654702
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 2
2017-05-02 17:11:54,005 Stage-4 map = 0%,  reduce = 0%
2017-05-02 17:12:11,015 Stage-4 map = 22%,  reduce = 0%, Cumulative CPU 9.79 sec
2017-05-02 17:12:12,065 Stage-4 map = 38%,  reduce = 0%, Cumulative CPU 30.66 sec
2017-05-02 17:12:15,299 Stage-4 map = 43%,  reduce = 0%, Cumulative CPU 36.69 sec
2017-05-02 17:12:18,455 Stage-4 map = 46%,  reduce = 0%, Cumulative CPU 40.69 sec
2017-05-02 17:12:21,600 Stage-4 map = 50%,  reduce = 0%, Cumulative CPU 46.57 sec
2017-05-02 17:12:24,730 Stage-4 map = 53%,  reduce = 0%, Cumulative CPU 52.08 sec
2017-05-02 17:12:26,848 Stage-4 map = 55%,  reduce = 0%, Cumulative CPU 54.87 sec
2017-05-02 17:12:27,898 Stage-4 map = 57%,  reduce = 0%, Cumulative CPU 58.08 sec
2017-05-02 17:12:29,959 Stage-4 map = 59%,  reduce = 0%, Cumulative CPU 60.86 sec
2017-05-02 17:12:30,999 Stage-4 map = 61%,  reduce = 0%, Cumulative CPU 63.83 sec
2017-05-02 17:12:33,063 Stage-4 map = 63%,  reduce = 0%, Cumulative CPU 69.39 sec
2017-05-02 17:12:34,117 Stage-4 map = 65%,  reduce = 0%, Cumulative CPU 74.65 sec
2017-05-02 17:12:36,180 Stage-4 map = 66%,  reduce = 0%, Cumulative CPU 80.55 sec
2017-05-02 17:12:37,247 Stage-4 map = 68%,  reduce = 0%, Cumulative CPU 86.68 sec
2017-05-02 17:12:40,506 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 94.15 sec
2017-05-02 17:12:45,752 Stage-4 map = 71%,  reduce = 0%, Cumulative CPU 106.0 sec
2017-05-02 17:12:48,857 Stage-4 map = 73%,  reduce = 0%, Cumulative CPU 108.46 sec
2017-05-02 17:12:52,001 Stage-4 map = 77%,  reduce = 0%, Cumulative CPU 116.88 sec
2017-05-02 17:12:55,121 Stage-4 map = 81%,  reduce = 0%, Cumulative CPU 123.77 sec
2017-05-02 17:12:58,273 Stage-4 map = 83%,  reduce = 0%, Cumulative CPU 129.99 sec
2017-05-02 17:13:01,477 Stage-4 map = 89%,  reduce = 0%, Cumulative CPU 136.44 sec
2017-05-02 17:13:07,743 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 147.09 sec
2017-05-02 17:13:54,524 Stage-4 map = 100%,  reduce = 31%, Cumulative CPU 156.92 sec
2017-05-02 17:13:57,640 Stage-4 map = 100%,  reduce = 34%, Cumulative CPU 163.56 sec
2017-05-02 17:14:00,744 Stage-4 map = 100%,  reduce = 37%, Cumulative CPU 168.36 sec
2017-05-02 17:14:02,822 Stage-4 map = 100%,  reduce = 55%, Cumulative CPU 174.06 sec
2017-05-02 17:14:03,852 Stage-4 map = 100%,  reduce = 57%, Cumulative CPU 177.92 sec
2017-05-02 17:14:06,956 Stage-4 map = 100%,  reduce = 64%, Cumulative CPU 184.24 sec
2017-05-02 17:14:10,088 Stage-4 map = 100%,  reduce = 70%, Cumulative CPU 190.2 sec
2017-05-02 17:14:13,194 Stage-4 map = 100%,  reduce = 72%, Cumulative CPU 194.36 sec
2017-05-02 17:14:15,255 Stage-4 map = 100%,  reduce = 76%, Cumulative CPU 200.32 sec
2017-05-02 17:14:16,282 Stage-4 map = 100%,  reduce = 79%, Cumulative CPU 204.42 sec
2017-05-02 17:14:17,307 Stage-4 map = 100%,  reduce = 80%, Cumulative CPU 205.13 sec
2017-05-02 17:14:18,341 Stage-4 map = 100%,  reduce = 83%, Cumulative CPU 207.33 sec
2017-05-02 17:14:28,668 Stage-4 map = 100%,  reduce = 84%, Cumulative CPU 219.17 sec
2017-05-02 17:14:33,056 Stage-4 map = 100%,  reduce = 86%, Cumulative CPU 221.57 sec
2017-05-02 17:14:36,153 Stage-4 map = 100%,  reduce = 87%, Cumulative CPU 223.96 sec
2017-05-02 17:14:39,233 Stage-4 map = 100%,  reduce = 88%, Cumulative CPU 225.85 sec
2017-05-02 17:14:42,333 Stage-4 map = 100%,  reduce = 89%, Cumulative CPU 227.4 sec
2017-05-02 17:14:45,459 Stage-4 map = 100%,  reduce = 90%, Cumulative CPU 229.61 sec
2017-05-02 17:14:49,585 Stage-4 map = 100%,  reduce = 92%, Cumulative CPU 232.44 sec
2017-05-02 17:14:52,680 Stage-4 map = 100%,  reduce = 93%, Cumulative CPU 235.69 sec
2017-05-02 17:14:55,802 Stage-4 map = 100%,  reduce = 95%, Cumulative CPU 238.05 sec
2017-05-02 17:14:58,902 Stage-4 map = 100%,  reduce = 96%, Cumulative CPU 239.85 sec
2017-05-02 17:15:01,973 Stage-4 map = 100%,  reduce = 97%, Cumulative CPU 241.94 sec
2017-05-02 17:15:06,073 Stage-4 map = 100%,  reduce = 98%, Cumulative CPU 244.2 sec
2017-05-02 17:15:09,148 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 246.38 sec
2017-05-02 17:15:11,208 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 247.99 sec
MapReduce Total cumulative CPU time: 4 minutes 7 seconds 990 msec
Ended Job = job_1493104900716_654702
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 2
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_654993, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_654993/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_654993
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 2
2017-05-02 17:15:45,814 Stage-1 map = 0%,  reduce = 0%
2017-05-02 17:16:09,635 Stage-1 map = 12%,  reduce = 0%, Cumulative CPU 21.13 sec
2017-05-02 17:16:15,826 Stage-1 map = 45%,  reduce = 0%, Cumulative CPU 56.62 sec
2017-05-02 17:16:18,928 Stage-1 map = 56%,  reduce = 0%, Cumulative CPU 63.15 sec
2017-05-02 17:16:22,014 Stage-1 map = 61%,  reduce = 0%, Cumulative CPU 67.31 sec
2017-05-02 17:16:27,161 Stage-1 map = 67%,  reduce = 0%, Cumulative CPU 78.98 sec
2017-05-02 17:16:58,175 Stage-1 map = 79%,  reduce = 0%, Cumulative CPU 109.7 sec
2017-05-02 17:17:37,535 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 157.44 sec
2017-05-02 17:17:43,711 Stage-1 map = 90%,  reduce = 0%, Cumulative CPU 165.32 sec
2017-05-02 17:17:46,792 Stage-1 map = 94%,  reduce = 0%, Cumulative CPU 168.77 sec
2017-05-02 17:17:56,056 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 178.75 sec
2017-05-02 17:18:14,654 Stage-1 map = 100%,  reduce = 71%, Cumulative CPU 207.29 sec
2017-05-02 17:18:17,735 Stage-1 map = 100%,  reduce = 79%, Cumulative CPU 214.94 sec
2017-05-02 17:18:20,821 Stage-1 map = 100%,  reduce = 87%, Cumulative CPU 222.79 sec
2017-05-02 17:18:22,888 Stage-1 map = 100%,  reduce = 91%, Cumulative CPU 225.91 sec
2017-05-02 17:18:23,917 Stage-1 map = 100%,  reduce = 93%, Cumulative CPU 230.08 sec
2017-05-02 17:18:26,987 Stage-1 map = 100%,  reduce = 95%, Cumulative CPU 233.35 sec
2017-05-02 17:18:30,136 Stage-1 map = 100%,  reduce = 97%, Cumulative CPU 236.7 sec
2017-05-02 17:18:32,202 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 240.87 sec
2017-05-02 17:18:34,292 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 243.47 sec
MapReduce Total cumulative CPU time: 4 minutes 3 seconds 470 msec
Ended Job = job_1493104900716_654993
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_655249, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_655249/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_655249
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 17:19:13,863 Stage-2 map = 0%,  reduce = 0%
2017-05-02 17:19:37,634 Stage-2 map = 17%,  reduce = 0%, Cumulative CPU 36.54 sec
2017-05-02 17:19:39,678 Stage-2 map = 36%,  reduce = 0%, Cumulative CPU 40.63 sec
2017-05-02 17:19:55,075 Stage-2 map = 46%,  reduce = 0%, Cumulative CPU 85.46 sec
2017-05-02 17:19:56,099 Stage-2 map = 63%,  reduce = 0%, Cumulative CPU 88.68 sec
2017-05-02 17:19:58,154 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 95.35 sec
2017-05-02 17:20:01,243 Stage-2 map = 85%,  reduce = 0%, Cumulative CPU 102.09 sec
2017-05-02 17:20:04,312 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 106.72 sec
2017-05-02 17:20:21,736 Stage-2 map = 100%,  reduce = 80%, Cumulative CPU 123.39 sec
2017-05-02 17:20:24,819 Stage-2 map = 100%,  reduce = 88%, Cumulative CPU 126.9 sec
2017-05-02 17:20:27,933 Stage-2 map = 100%,  reduce = 96%, Cumulative CPU 130.42 sec
2017-05-02 17:20:28,966 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 132.48 sec
MapReduce Total cumulative CPU time: 2 minutes 12 seconds 480 msec
Ended Job = job_1493104900716_655249
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 153  Reduce: 166   Cumulative CPU: 16303.29 sec   HDFS Read: 42484568041 HDFS Write: 497989174 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 2   Cumulative CPU: 247.99 sec   HDFS Read: 498052126 HDFS Write: 497971014 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 2   Cumulative CPU: 243.47 sec   HDFS Read: 498014636 HDFS Write: 495364657 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 132.48 sec   HDFS Read: 495377692 HDFS Write: 363086871 SUCCESS
Total MapReduce CPU Time Spent: 0 days 4 hours 42 minutes 7 seconds 230 msec
OK
Time taken: 6216.975 seconds, Fetched: 5533938 row(s)
du: Êó†Ê≥ïËÆøÈóÆ"1.txt": Ê≤°ÊúâÈÇ£‰∏™Êñá‰ª∂ÊàñÁõÆÂΩï
bi_100.sh: line 74: [: -gt: unary operator expected
du: Êó†Ê≥ïËÆøÈóÆ"2.txt": Ê≤°ÊúâÈÇ£‰∏™Êñá‰ª∂ÊàñÁõÆÂΩï
bi_100.sh: line 80: [: -gt: unary operator expected
R not done!
du: Êó†Ê≥ïËÆøÈóÆ"3.txt": Ê≤°ÊúâÈÇ£‰∏™Êñá‰ª∂ÊàñÁõÆÂΩï
bi_100.sh: line 89: [: -gt: unary operator expected
R not done!
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 17:20:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  244G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
35G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
21G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 17:21:14 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 17:21:14 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.513 seconds
Query ID = busbi_20170502172119_5592515e-5ab7-4cea-9312-18fa1d2c4065
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 188
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_655411, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_655411/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_655411
Hadoop job information for Stage-3: number of mappers: 171; number of reducers: 188
2017-05-02 17:22:00,291 Stage-3 map = 0%,  reduce = 0%
2017-05-02 17:22:28,556 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 876.13 sec
2017-05-02 17:22:29,620 Stage-3 map = 2%,  reduce = 0%, Cumulative CPU 1147.54 sec
2017-05-02 17:22:30,670 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 1459.36 sec
2017-05-02 17:22:31,716 Stage-3 map = 6%,  reduce = 0%, Cumulative CPU 1924.28 sec
2017-05-02 17:22:32,769 Stage-3 map = 9%,  reduce = 0%, Cumulative CPU 2173.48 sec
2017-05-02 17:22:33,816 Stage-3 map = 12%,  reduce = 0%, Cumulative CPU 2530.33 sec
2017-05-02 17:22:34,854 Stage-3 map = 16%,  reduce = 0%, Cumulative CPU 2809.81 sec
2017-05-02 17:22:35,912 Stage-3 map = 20%,  reduce = 0%, Cumulative CPU 3089.5 sec
2017-05-02 17:22:36,959 Stage-3 map = 24%,  reduce = 0%, Cumulative CPU 3345.27 sec
2017-05-02 17:22:38,012 Stage-3 map = 29%,  reduce = 0%, Cumulative CPU 3566.19 sec
2017-05-02 17:22:39,055 Stage-3 map = 35%,  reduce = 0%, Cumulative CPU 3760.06 sec
2017-05-02 17:22:40,098 Stage-3 map = 39%,  reduce = 0%, Cumulative CPU 3920.39 sec
2017-05-02 17:22:41,144 Stage-3 map = 44%,  reduce = 0%, Cumulative CPU 4075.63 sec
2017-05-02 17:22:42,181 Stage-3 map = 48%,  reduce = 0%, Cumulative CPU 4203.37 sec
2017-05-02 17:22:43,223 Stage-3 map = 56%,  reduce = 0%, Cumulative CPU 4348.61 sec
2017-05-02 17:22:44,264 Stage-3 map = 60%,  reduce = 0%, Cumulative CPU 4487.49 sec
2017-05-02 17:22:45,295 Stage-3 map = 65%,  reduce = 0%, Cumulative CPU 4682.72 sec
2017-05-02 17:22:46,334 Stage-3 map = 67%,  reduce = 0%, Cumulative CPU 4809.0 sec
2017-05-02 17:22:47,377 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 4905.62 sec
2017-05-02 17:22:49,468 Stage-3 map = 70%,  reduce = 0%, Cumulative CPU 5116.96 sec
2017-05-02 17:22:50,512 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 5175.56 sec
2017-05-02 17:22:51,555 Stage-3 map = 74%,  reduce = 0%, Cumulative CPU 5277.29 sec
2017-05-02 17:22:53,639 Stage-3 map = 75%,  reduce = 0%, Cumulative CPU 5376.65 sec
2017-05-02 17:22:55,700 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 5493.9 sec
2017-05-02 17:22:58,793 Stage-3 map = 77%,  reduce = 0%, Cumulative CPU 5563.48 sec
2017-05-02 17:23:17,440 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 5650.71 sec
2017-05-02 17:23:18,481 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 5673.09 sec
2017-05-02 17:23:19,525 Stage-3 map = 80%,  reduce = 0%, Cumulative CPU 5695.87 sec
2017-05-02 17:23:21,586 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 5729.28 sec
2017-05-02 17:23:23,656 Stage-3 map = 82%,  reduce = 0%, Cumulative CPU 5762.76 sec
2017-05-02 17:23:26,771 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 5829.78 sec
2017-05-02 17:23:27,813 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 5875.06 sec
2017-05-02 17:23:29,876 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 5929.22 sec
2017-05-02 17:23:33,008 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 5993.53 sec
2017-05-02 17:23:35,085 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 6046.76 sec
2017-05-02 17:23:39,210 Stage-3 map = 88%,  reduce = 0%, Cumulative CPU 6119.1 sec
2017-05-02 17:23:40,244 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 6156.88 sec
2017-05-02 17:23:41,278 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 6160.96 sec
2017-05-02 17:23:42,304 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 6174.31 sec
2017-05-02 17:23:43,334 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 6203.93 sec
2017-05-02 17:23:44,373 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 6235.99 sec
2017-05-02 17:23:46,452 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 6267.48 sec
2017-05-02 17:23:47,491 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 6290.67 sec
2017-05-02 17:23:49,547 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 6318.91 sec
2017-05-02 17:23:51,639 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 6345.78 sec
2017-05-02 17:23:54,742 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 6382.75 sec
2017-05-02 17:23:58,880 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 6409.56 sec
2017-05-02 17:24:08,178 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 6438.36 sec
2017-05-02 17:24:22,270 Stage-3 map = 100%,  reduce = 2%, Cumulative CPU 6468.38 sec
2017-05-02 17:24:23,293 Stage-3 map = 100%,  reduce = 13%, Cumulative CPU 6713.26 sec
2017-05-02 17:24:24,340 Stage-3 map = 100%,  reduce = 25%, Cumulative CPU 6981.02 sec
2017-05-02 17:24:25,377 Stage-3 map = 100%,  reduce = 36%, Cumulative CPU 7224.32 sec
2017-05-02 17:24:26,406 Stage-3 map = 100%,  reduce = 45%, Cumulative CPU 7446.1 sec
2017-05-02 17:24:27,444 Stage-3 map = 100%,  reduce = 53%, Cumulative CPU 7633.05 sec
2017-05-02 17:24:28,468 Stage-3 map = 100%,  reduce = 60%, Cumulative CPU 7781.35 sec
2017-05-02 17:24:29,498 Stage-3 map = 100%,  reduce = 64%, Cumulative CPU 7899.86 sec
2017-05-02 17:24:30,522 Stage-3 map = 100%,  reduce = 67%, Cumulative CPU 7982.44 sec
2017-05-02 17:24:31,549 Stage-3 map = 100%,  reduce = 72%, Cumulative CPU 8069.7 sec
2017-05-02 17:24:32,582 Stage-3 map = 100%,  reduce = 73%, Cumulative CPU 8118.99 sec
2017-05-02 17:24:34,665 Stage-3 map = 100%,  reduce = 74%, Cumulative CPU 8197.63 sec
2017-05-02 17:24:35,696 Stage-3 map = 100%,  reduce = 75%, Cumulative CPU 8267.04 sec
2017-05-02 17:24:36,727 Stage-3 map = 100%,  reduce = 78%, Cumulative CPU 8408.91 sec
2017-05-02 17:24:37,758 Stage-3 map = 100%,  reduce = 79%, Cumulative CPU 8457.83 sec
2017-05-02 17:24:38,801 Stage-3 map = 100%,  reduce = 83%, Cumulative CPU 8584.18 sec
2017-05-02 17:24:39,841 Stage-3 map = 100%,  reduce = 85%, Cumulative CPU 8707.04 sec
2017-05-02 17:24:40,871 Stage-3 map = 100%,  reduce = 87%, Cumulative CPU 8767.94 sec
2017-05-02 17:24:41,911 Stage-3 map = 100%,  reduce = 89%, Cumulative CPU 8886.46 sec
2017-05-02 17:24:42,946 Stage-3 map = 100%,  reduce = 90%, Cumulative CPU 8973.4 sec
2017-05-02 17:24:43,997 Stage-3 map = 100%,  reduce = 91%, Cumulative CPU 9025.71 sec
2017-05-02 17:24:45,037 Stage-3 map = 100%,  reduce = 94%, Cumulative CPU 9103.89 sec
2017-05-02 17:24:46,064 Stage-3 map = 100%,  reduce = 95%, Cumulative CPU 9175.3 sec
2017-05-02 17:24:47,105 Stage-3 map = 100%,  reduce = 96%, Cumulative CPU 9233.83 sec
2017-05-02 17:24:49,172 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 9413.16 sec
2017-05-02 17:24:54,337 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9605.22 sec
2017-05-02 17:25:21,137 Stage-3 map = 99%,  reduce = 99%, Cumulative CPU 10130.85 sec
2017-05-02 17:25:50,980 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10593.25 sec
2017-05-02 17:26:51,500 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11272.39 sec
2017-05-02 17:27:52,276 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11899.23 sec
2017-05-02 17:28:53,016 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12430.19 sec
2017-05-02 17:29:53,636 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12907.52 sec
2017-05-02 17:30:54,443 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13394.42 sec
2017-05-02 17:31:55,302 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13764.97 sec
2017-05-02 17:32:56,183 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14078.8 sec
2017-05-02 17:33:56,202 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14337.01 sec
2017-05-02 17:34:56,793 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14582.78 sec
2017-05-02 17:35:57,272 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14825.17 sec
2017-05-02 17:36:57,867 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15048.81 sec
2017-05-02 17:37:58,465 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15171.73 sec
2017-05-02 17:38:58,983 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15298.58 sec
2017-05-02 17:39:59,497 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15418.44 sec
2017-05-02 17:40:59,820 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15540.02 sec
2017-05-02 17:42:00,311 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15661.15 sec
2017-05-02 17:43:00,782 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15777.25 sec
2017-05-02 17:44:01,271 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 15892.57 sec
2017-05-02 17:45:01,913 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16011.42 sec
2017-05-02 17:46:02,590 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16133.59 sec
2017-05-02 17:47:03,389 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16257.21 sec
2017-05-02 17:48:03,959 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16375.1 sec
2017-05-02 17:49:04,535 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16496.69 sec
2017-05-02 17:50:05,102 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16614.55 sec
2017-05-02 17:51:05,772 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16735.17 sec
2017-05-02 17:52:06,348 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16854.08 sec
2017-05-02 17:53:06,871 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 16978.41 sec
2017-05-02 17:54:07,368 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 17104.9 sec
2017-05-02 17:55:07,771 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 17228.58 sec
2017-05-02 17:56:08,346 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 17355.32 sec
2017-05-02 17:57:09,059 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 17484.86 sec
2017-05-02 17:58:09,576 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 17607.55 sec
2017-05-02 17:59:10,118 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 17733.03 sec
2017-05-02 18:00:10,754 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 17858.65 sec
2017-05-02 18:01:11,499 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 17988.71 sec
2017-05-02 18:02:11,948 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 18116.02 sec
2017-05-02 18:03:12,377 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 18243.1 sec
2017-05-02 18:04:12,827 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 18370.86 sec
2017-05-02 18:05:13,470 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 18499.95 sec
2017-05-02 18:06:14,017 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 18624.89 sec
2017-05-02 18:07:14,584 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 18756.07 sec
2017-05-02 18:08:15,152 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 18884.97 sec
2017-05-02 18:09:15,656 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 19012.0 sec
2017-05-02 18:10:16,175 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 19139.29 sec
2017-05-02 18:11:16,813 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 19266.32 sec
2017-05-02 18:12:17,287 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 19397.54 sec
2017-05-02 18:13:17,845 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 19525.39 sec
2017-05-02 18:14:18,537 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 19656.56 sec
2017-05-02 18:15:19,089 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 19782.31 sec
2017-05-02 18:16:19,669 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 19912.39 sec
2017-05-02 18:17:20,172 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 20040.48 sec
2017-05-02 18:18:20,717 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 20168.19 sec
2017-05-02 18:19:21,244 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 20296.29 sec
2017-05-02 18:20:21,570 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 20423.31 sec
2017-05-02 18:21:21,933 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 20548.61 sec
2017-05-02 18:22:22,414 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 20674.64 sec
2017-05-02 18:22:49,059 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 20710.58 sec
2017-05-02 18:23:49,282 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 20772.98 sec
2017-05-02 18:24:49,475 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 20839.94 sec
2017-05-02 18:25:49,859 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 20904.52 sec
2017-05-02 18:26:50,257 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 20919.92 sec
MapReduce Total cumulative CPU time: 0 days 5 hours 48 minutes 39 seconds 920 msec
Ended Job = job_1493104900716_655411
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_659130, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_659130/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_659130
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 3
2017-05-02 18:28:03,995 Stage-4 map = 0%,  reduce = 0%
2017-05-02 18:28:44,186 Stage-4 map = 1%,  reduce = 0%, Cumulative CPU 37.96 sec
2017-05-02 18:28:47,263 Stage-4 map = 2%,  reduce = 0%, Cumulative CPU 48.52 sec
2017-05-02 18:28:48,287 Stage-4 map = 3%,  reduce = 0%, Cumulative CPU 52.74 sec
2017-05-02 18:28:50,334 Stage-4 map = 4%,  reduce = 0%, Cumulative CPU 57.07 sec
2017-05-02 18:28:51,356 Stage-4 map = 6%,  reduce = 0%, Cumulative CPU 59.59 sec
2017-05-02 18:28:54,434 Stage-4 map = 8%,  reduce = 0%, Cumulative CPU 66.27 sec
2017-05-02 18:28:57,503 Stage-4 map = 10%,  reduce = 0%, Cumulative CPU 70.96 sec
2017-05-02 18:29:00,582 Stage-4 map = 11%,  reduce = 0%, Cumulative CPU 75.37 sec
2017-05-02 18:29:05,686 Stage-4 map = 12%,  reduce = 0%, Cumulative CPU 88.91 sec
2017-05-02 18:29:08,746 Stage-4 map = 13%,  reduce = 0%, Cumulative CPU 96.45 sec
2017-05-02 18:29:10,786 Stage-4 map = 21%,  reduce = 0%, Cumulative CPU 102.54 sec
2017-05-02 18:29:15,886 Stage-4 map = 22%,  reduce = 0%, Cumulative CPU 111.45 sec
2017-05-02 18:29:17,926 Stage-4 map = 25%,  reduce = 0%, Cumulative CPU 116.4 sec
2017-05-02 18:29:18,952 Stage-4 map = 26%,  reduce = 0%, Cumulative CPU 118.89 sec
2017-05-02 18:29:21,000 Stage-4 map = 29%,  reduce = 0%, Cumulative CPU 123.65 sec
2017-05-02 18:29:24,083 Stage-4 map = 31%,  reduce = 0%, Cumulative CPU 130.08 sec
2017-05-02 18:29:27,170 Stage-4 map = 34%,  reduce = 0%, Cumulative CPU 135.09 sec
2017-05-02 18:29:28,197 Stage-4 map = 36%,  reduce = 0%, Cumulative CPU 140.55 sec
2017-05-02 18:29:30,249 Stage-4 map = 38%,  reduce = 0%, Cumulative CPU 143.08 sec
2017-05-02 18:29:32,314 Stage-4 map = 39%,  reduce = 0%, Cumulative CPU 148.07 sec
2017-05-02 18:29:33,346 Stage-4 map = 40%,  reduce = 0%, Cumulative CPU 150.84 sec
2017-05-02 18:29:34,377 Stage-4 map = 41%,  reduce = 0%, Cumulative CPU 153.18 sec
2017-05-02 18:29:37,452 Stage-4 map = 42%,  reduce = 0%, Cumulative CPU 160.16 sec
2017-05-02 18:29:38,480 Stage-4 map = 43%,  reduce = 0%, Cumulative CPU 162.61 sec
2017-05-02 18:29:41,569 Stage-4 map = 44%,  reduce = 0%, Cumulative CPU 168.09 sec
2017-05-02 18:29:44,660 Stage-4 map = 45%,  reduce = 0%, Cumulative CPU 176.1 sec
2017-05-02 18:29:45,690 Stage-4 map = 46%,  reduce = 0%, Cumulative CPU 179.22 sec
2017-05-02 18:29:47,758 Stage-4 map = 47%,  reduce = 0%, Cumulative CPU 185.09 sec
2017-05-02 18:29:48,784 Stage-4 map = 48%,  reduce = 0%, Cumulative CPU 188.15 sec
2017-05-02 18:29:49,816 Stage-4 map = 59%,  reduce = 0%, Cumulative CPU 190.83 sec
2017-05-02 18:29:51,885 Stage-4 map = 60%,  reduce = 0%, Cumulative CPU 195.48 sec
2017-05-02 18:29:54,972 Stage-4 map = 61%,  reduce = 0%, Cumulative CPU 200.93 sec
2017-05-02 18:29:58,072 Stage-4 map = 62%,  reduce = 0%, Cumulative CPU 207.1 sec
2017-05-02 18:30:02,160 Stage-4 map = 63%,  reduce = 0%, Cumulative CPU 215.28 sec
2017-05-02 18:30:04,211 Stage-4 map = 64%,  reduce = 0%, Cumulative CPU 218.61 sec
2017-05-02 18:30:07,317 Stage-4 map = 65%,  reduce = 0%, Cumulative CPU 227.11 sec
2017-05-02 18:30:11,429 Stage-4 map = 66%,  reduce = 0%, Cumulative CPU 236.8 sec
2017-05-02 18:30:12,466 Stage-4 map = 67%,  reduce = 0%, Cumulative CPU 241.54 sec
2017-05-02 18:30:15,575 Stage-4 map = 68%,  reduce = 0%, Cumulative CPU 251.8 sec
2017-05-02 18:30:17,616 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 255.28 sec
2017-05-02 18:30:35,089 Stage-4 map = 71%,  reduce = 0%, Cumulative CPU 210.75 sec
2017-05-02 18:30:38,172 Stage-4 map = 73%,  reduce = 0%, Cumulative CPU 220.89 sec
2017-05-02 18:30:41,282 Stage-4 map = 75%,  reduce = 0%, Cumulative CPU 225.27 sec
2017-05-02 18:30:47,479 Stage-4 map = 83%,  reduce = 0%, Cumulative CPU 236.64 sec
2017-05-02 18:30:50,560 Stage-4 map = 88%,  reduce = 0%, Cumulative CPU 242.18 sec
2017-05-02 18:30:53,652 Stage-4 map = 89%,  reduce = 0%, Cumulative CPU 173.66 sec
2017-05-02 18:30:56,731 Stage-4 map = 90%,  reduce = 0%, Cumulative CPU 177.38 sec
2017-05-02 18:30:59,825 Stage-4 map = 96%,  reduce = 0%, Cumulative CPU 180.91 sec
2017-05-02 18:31:02,922 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 184.11 sec
2017-05-02 18:31:43,840 Stage-4 map = 100%,  reduce = 42%, Cumulative CPU 201.44 sec
2017-05-02 18:31:46,904 Stage-4 map = 100%,  reduce = 44%, Cumulative CPU 203.97 sec
2017-05-02 18:31:52,030 Stage-4 map = 100%,  reduce = 61%, Cumulative CPU 213.81 sec
2017-05-02 18:31:55,106 Stage-4 map = 100%,  reduce = 64%, Cumulative CPU 217.16 sec
2017-05-02 18:31:58,174 Stage-4 map = 100%,  reduce = 66%, Cumulative CPU 220.45 sec
2017-05-02 18:31:59,198 Stage-4 map = 100%,  reduce = 67%, Cumulative CPU 233.45 sec
2017-05-02 18:32:01,234 Stage-4 map = 100%,  reduce = 68%, Cumulative CPU 237.87 sec
2017-05-02 18:32:02,254 Stage-4 map = 100%,  reduce = 73%, Cumulative CPU 247.39 sec
2017-05-02 18:32:05,327 Stage-4 map = 100%,  reduce = 78%, Cumulative CPU 255.7 sec
2017-05-02 18:32:08,382 Stage-4 map = 100%,  reduce = 81%, Cumulative CPU 260.78 sec
2017-05-02 18:32:11,444 Stage-4 map = 100%,  reduce = 83%, Cumulative CPU 263.52 sec
2017-05-02 18:32:17,559 Stage-4 map = 100%,  reduce = 86%, Cumulative CPU 274.19 sec
2017-05-02 18:32:28,782 Stage-4 map = 100%,  reduce = 87%, Cumulative CPU 284.46 sec
2017-05-02 18:32:31,852 Stage-4 map = 100%,  reduce = 88%, Cumulative CPU 289.11 sec
2017-05-02 18:32:32,872 Stage-4 map = 100%,  reduce = 91%, Cumulative CPU 293.77 sec
2017-05-02 18:32:34,915 Stage-4 map = 100%,  reduce = 92%, Cumulative CPU 297.68 sec
2017-05-02 18:32:37,982 Stage-4 map = 100%,  reduce = 94%, Cumulative CPU 301.16 sec
2017-05-02 18:32:41,054 Stage-4 map = 100%,  reduce = 95%, Cumulative CPU 304.8 sec
2017-05-02 18:32:44,121 Stage-4 map = 100%,  reduce = 97%, Cumulative CPU 310.22 sec
2017-05-02 18:32:56,365 Stage-4 map = 100%,  reduce = 98%, Cumulative CPU 315.83 sec
2017-05-02 18:32:59,429 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 321.83 sec
2017-05-02 18:33:03,500 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 322.79 sec
2017-05-02 18:34:03,720 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 322.95 sec
2017-05-02 18:35:03,872 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 322.95 sec
MapReduce Total cumulative CPU time: 5 minutes 22 seconds 950 msec
Ended Job = job_1493104900716_659130
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_659560, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_659560/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_659560
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 3
2017-05-02 18:36:39,132 Stage-1 map = 0%,  reduce = 0%
2017-05-02 18:36:51,586 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 5.21 sec
2017-05-02 18:36:57,774 Stage-1 map = 39%,  reduce = 0%, Cumulative CPU 30.98 sec
2017-05-02 18:37:04,010 Stage-1 map = 44%,  reduce = 0%, Cumulative CPU 45.14 sec
2017-05-02 18:37:05,032 Stage-1 map = 53%,  reduce = 0%, Cumulative CPU 49.02 sec
2017-05-02 18:37:11,223 Stage-1 map = 57%,  reduce = 0%, Cumulative CPU 71.25 sec
2017-05-02 18:37:16,389 Stage-1 map = 69%,  reduce = 0%, Cumulative CPU 82.96 sec
2017-05-02 18:37:19,478 Stage-1 map = 74%,  reduce = 0%, Cumulative CPU 90.49 sec
2017-05-02 18:37:22,556 Stage-1 map = 76%,  reduce = 0%, Cumulative CPU 96.84 sec
2017-05-02 18:37:23,589 Stage-1 map = 85%,  reduce = 0%, Cumulative CPU 100.08 sec
2017-05-02 18:37:25,635 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 103.19 sec
2017-05-02 18:37:31,827 Stage-1 map = 96%,  reduce = 0%, Cumulative CPU 114.54 sec
2017-05-02 18:37:38,020 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 120.36 sec
2017-05-02 18:38:14,790 Stage-1 map = 100%,  reduce = 66%, Cumulative CPU 141.31 sec
2017-05-02 18:38:17,857 Stage-1 map = 100%,  reduce = 67%, Cumulative CPU 142.12 sec
2017-05-02 18:38:59,722 Stage-1 map = 100%,  reduce = 72%, Cumulative CPU 159.77 sec
2017-05-02 18:39:02,792 Stage-1 map = 100%,  reduce = 80%, Cumulative CPU 168.62 sec
2017-05-02 18:39:05,862 Stage-1 map = 100%,  reduce = 85%, Cumulative CPU 177.42 sec
2017-05-02 18:39:08,922 Stage-1 map = 100%,  reduce = 90%, Cumulative CPU 183.96 sec
2017-05-02 18:39:11,988 Stage-1 map = 100%,  reduce = 94%, Cumulative CPU 190.67 sec
2017-05-02 18:39:15,042 Stage-1 map = 100%,  reduce = 98%, Cumulative CPU 196.26 sec
2017-05-02 18:39:18,093 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 199.33 sec
2017-05-02 18:39:21,151 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 201.97 sec
MapReduce Total cumulative CPU time: 3 minutes 21 seconds 970 msec
Ended Job = job_1493104900716_659560
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_659716, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_659716/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_659716
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 18:42:33,317 Stage-2 map = 0%,  reduce = 0%
2017-05-02 18:43:33,713 Stage-2 map = 0%,  reduce = 0%, Cumulative CPU 35.5 sec
2017-05-02 18:44:04,484 Stage-2 map = 19%,  reduce = 0%, Cumulative CPU 41.04 sec
2017-05-02 18:44:13,726 Stage-2 map = 26%,  reduce = 0%, Cumulative CPU 54.81 sec
2017-05-02 18:44:14,757 Stage-2 map = 34%,  reduce = 0%, Cumulative CPU 59.1 sec
2017-05-02 18:44:20,931 Stage-2 map = 40%,  reduce = 0%, Cumulative CPU 74.12 sec
2017-05-02 18:44:24,017 Stage-2 map = 57%,  reduce = 0%, Cumulative CPU 81.13 sec
2017-05-02 18:44:56,833 Stage-2 map = 70%,  reduce = 0%, Cumulative CPU 109.97 sec
2017-05-02 18:45:09,160 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 126.11 sec
2017-05-02 18:45:18,411 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 136.41 sec
2017-05-02 18:45:49,087 Stage-2 map = 100%,  reduce = 67%, Cumulative CPU 142.3 sec
2017-05-02 18:46:13,652 Stage-2 map = 100%,  reduce = 76%, Cumulative CPU 154.14 sec
2017-05-02 18:46:16,732 Stage-2 map = 100%,  reduce = 78%, Cumulative CPU 155.75 sec
2017-05-02 18:46:29,004 Stage-2 map = 100%,  reduce = 88%, Cumulative CPU 161.17 sec
2017-05-02 18:46:32,077 Stage-2 map = 100%,  reduce = 96%, Cumulative CPU 164.79 sec
2017-05-02 18:46:35,144 Stage-2 map = 100%,  reduce = 99%, Cumulative CPU 166.37 sec
2017-05-02 18:46:42,297 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 168.36 sec
MapReduce Total cumulative CPU time: 2 minutes 48 seconds 360 msec
Ended Job = job_1493104900716_659716
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 171  Reduce: 188   Cumulative CPU: 20919.92 sec   HDFS Read: 47916508749 HDFS Write: 579628900 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 3   Cumulative CPU: 322.95 sec   HDFS Read: 579701373 HDFS Write: 579607805 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 3   Cumulative CPU: 202.25 sec   HDFS Read: 579656820 HDFS Write: 577949295 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 168.36 sec   HDFS Read: 577964642 HDFS Write: 423395581 SUCCESS
Total MapReduce CPU Time Spent: 0 days 6 hours 0 minutes 13 seconds 480 msec
OK
Time taken: 5134.48 seconds, Fetched: 6459532 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492099200, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 66.47}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 97.72}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 96.46}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 95.23}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 96.54}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.08}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 96.72}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 91.96}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 99.36}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.31}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 98.9}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 94.66}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 96.45}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 95.79}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 99.14}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.53}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.37}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.22}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 95.01}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 98.16}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.35}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 97.96}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 94.74}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 18:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  243G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
36G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
21G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170414' 
        and city_id = '7'
)q

17/05/02 18:49:04 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 18:49:04 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.217 seconds
Query ID = busbi_20170502184918_ea46d9f8-a9ba-4596-a3b4-461dac186b99
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_660074, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_660074/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_660074
Hadoop job information for Stage-1: number of mappers: 13; number of reducers: 1
2017-05-02 18:52:40,377 Stage-1 map = 0%,  reduce = 0%
2017-05-02 18:53:41,385 Stage-1 map = 0%,  reduce = 0%
2017-05-02 18:53:47,546 Stage-1 map = 8%,  reduce = 0%, Cumulative CPU 19.02 sec
2017-05-02 18:53:52,675 Stage-1 map = 13%,  reduce = 0%, Cumulative CPU 113.05 sec
2017-05-02 18:53:54,728 Stage-1 map = 18%,  reduce = 0%, Cumulative CPU 178.24 sec
2017-05-02 18:53:55,752 Stage-1 map = 23%,  reduce = 0%, Cumulative CPU 199.18 sec
2017-05-02 18:53:57,802 Stage-1 map = 28%,  reduce = 0%, Cumulative CPU 280.52 sec
2017-05-02 18:53:58,841 Stage-1 map = 44%,  reduce = 0%, Cumulative CPU 297.1 sec
2017-05-02 18:53:59,879 Stage-1 map = 62%,  reduce = 0%, Cumulative CPU 326.35 sec
2017-05-02 18:54:03,004 Stage-1 map = 64%,  reduce = 0%, Cumulative CPU 354.66 sec
2017-05-02 18:54:06,110 Stage-1 map = 69%,  reduce = 0%, Cumulative CPU 385.51 sec
2017-05-02 18:54:08,167 Stage-1 map = 74%,  reduce = 0%, Cumulative CPU 387.79 sec
2017-05-02 18:54:09,194 Stage-1 map = 85%,  reduce = 0%, Cumulative CPU 412.21 sec
2017-05-02 18:54:15,376 Stage-1 map = 95%,  reduce = 0%, Cumulative CPU 442.6 sec
2017-05-02 18:54:17,420 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 445.94 sec
2017-05-02 18:54:58,367 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 448.83 sec
MapReduce Total cumulative CPU time: 7 minutes 28 seconds 830 msec
Ended Job = job_1493104900716_660074
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 13  Reduce: 1   Cumulative CPU: 449.57 sec   HDFS Read: 2366591827 HDFS Write: 6 SUCCESS
Total MapReduce CPU Time Spent: 7 minutes 29 seconds 570 msec
OK
Time taken: 425.846 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 18:50:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  242G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
36G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
21G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 18:57:30 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/14/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170414(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170414;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170414 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170414';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='14');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='14') location '2017/04/14';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='14')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 18:57:55 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 18:57:55 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.03 seconds
OK
Time taken: 0.073 seconds
OK
Time taken: 5.807 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170414
Table transit_dw.tmp_abnormal_ratio_20170414 stats: [numFiles=1, numRows=0, totalSize=181, rawDataSize=0]
OK
Time taken: 59.989 seconds
Query ID = busbi_20170502185916_3a023101-0baf-4d08-9699-9abd0531be80
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_660504, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_660504/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_660504
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 19:01:31,772 Stage-1 map = 0%,  reduce = 0%
2017-05-02 19:01:40,293 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 3.81 sec
2017-05-02 19:01:41,334 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 6.51 sec
2017-05-02 19:01:51,821 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 9.84 sec
MapReduce Total cumulative CPU time: 9 seconds 840 msec
Ended Job = job_1493104900716_660504
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_18-59-16_796_891092054870279846-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/d6dea454-a5d0-44e2-a63a-3553f829aeb1/_tmp_space.db/7eded1e5-3ac6-4007-b079-80c5e66f858a
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6153, rawDataSize=6129]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 9.84 sec   HDFS Read: 19157 HDFS Write: 6250 SUCCESS
Total MapReduce CPU Time Spent: 9 seconds 840 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 160.231 seconds
Dropped the partition year=2017/month=04/day=14
OK
Time taken: 0.205 seconds
OK
Time taken: 0.081 seconds
Query ID = busbi_20170502190157_fd37ad13-f349-4210-ac28-ffd0d0bf3622
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_660761, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_660761/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_660761
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 19:03:03,341 Stage-1 map = 0%,  reduce = 0%
2017-05-02 19:03:53,937 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 9.14 sec
MapReduce Total cumulative CPU time: 9 seconds 140 msec
Ended Job = job_1493104900716_660761
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_19-01-57_318_1275167532683553535-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=14)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/14/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=14} stats: [numFiles=1, numRows=24, totalSize=1847, rawDataSize=30352]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 10.86 sec   HDFS Read: 10498 HDFS Write: 1967 SUCCESS
Total MapReduce CPU Time Spent: 10 seconds 860 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 201.48 seconds
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 19:00:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  242G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
36G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
21G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
17/05/02 19:06:11 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 19:06:11 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [/home/busbi/common/lib/jsonvisitor-1.0.jar] to class path
Added resources: [/home/busbi/common/lib/jsonvisitor-1.0.jar]
OK
Time taken: 1.035 seconds
Query ID = busbi_20170502190624_7b6caf7e-4c3c-4ed5-aa2c-d2a662122902
Total jobs = 4
Launching Job 1 out of 4
Number of reduce tasks not specified. Estimated from input data size: 171
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_661025, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_661025/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_661025
Hadoop job information for Stage-3: number of mappers: 158; number of reducers: 171
2017-05-02 19:12:39,413 Stage-3 map = 0%,  reduce = 0%
2017-05-02 19:13:46,553 Stage-3 map = 0%,  reduce = 0%
2017-05-02 19:14:33,164 Stage-3 map = 3%,  reduce = 0%, Cumulative CPU 1430.35 sec
2017-05-02 19:14:35,294 Stage-3 map = 8%,  reduce = 0%, Cumulative CPU 1882.55 sec
2017-05-02 19:14:36,369 Stage-3 map = 13%,  reduce = 0%, Cumulative CPU 2438.4 sec
2017-05-02 19:14:37,414 Stage-3 map = 14%,  reduce = 0%, Cumulative CPU 2599.17 sec
2017-05-02 19:14:38,476 Stage-3 map = 19%,  reduce = 0%, Cumulative CPU 2795.72 sec
2017-05-02 19:14:39,535 Stage-3 map = 24%,  reduce = 0%, Cumulative CPU 3161.22 sec
2017-05-02 19:14:40,701 Stage-3 map = 32%,  reduce = 0%, Cumulative CPU 3301.88 sec
2017-05-02 19:14:41,823 Stage-3 map = 38%,  reduce = 0%, Cumulative CPU 3478.5 sec
2017-05-02 19:14:42,888 Stage-3 map = 42%,  reduce = 0%, Cumulative CPU 3733.63 sec
2017-05-02 19:14:43,941 Stage-3 map = 47%,  reduce = 0%, Cumulative CPU 3829.75 sec
2017-05-02 19:14:44,985 Stage-3 map = 48%,  reduce = 0%, Cumulative CPU 3898.33 sec
2017-05-02 19:14:46,019 Stage-3 map = 52%,  reduce = 0%, Cumulative CPU 4062.62 sec
2017-05-02 19:14:47,059 Stage-3 map = 54%,  reduce = 0%, Cumulative CPU 4110.49 sec
2017-05-02 19:14:49,145 Stage-3 map = 58%,  reduce = 0%, Cumulative CPU 4295.97 sec
2017-05-02 19:14:50,179 Stage-3 map = 61%,  reduce = 0%, Cumulative CPU 4344.65 sec
2017-05-02 19:14:51,242 Stage-3 map = 64%,  reduce = 0%, Cumulative CPU 4411.97 sec
2017-05-02 19:14:52,326 Stage-3 map = 67%,  reduce = 0%, Cumulative CPU 4535.02 sec
2017-05-02 19:14:53,384 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 4572.95 sec
2017-05-02 19:14:54,419 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 4658.39 sec
2017-05-02 19:14:55,462 Stage-3 map = 76%,  reduce = 0%, Cumulative CPU 4755.22 sec
2017-05-02 19:14:56,506 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 4783.5 sec
2017-05-02 19:14:58,605 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 4875.23 sec
2017-05-02 19:14:59,810 Stage-3 map = 81%,  reduce = 0%, Cumulative CPU 4928.16 sec
2017-05-02 19:15:01,927 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 5025.35 sec
2017-05-02 19:15:04,068 Stage-3 map = 84%,  reduce = 0%, Cumulative CPU 5090.84 sec
2017-05-02 19:15:05,177 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 5123.08 sec
2017-05-02 19:15:06,247 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 5135.83 sec
2017-05-02 19:15:10,450 Stage-3 map = 87%,  reduce = 0%, Cumulative CPU 5246.09 sec
2017-05-02 19:15:12,584 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 5299.52 sec
2017-05-02 19:15:14,704 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 5353.59 sec
2017-05-02 19:15:16,840 Stage-3 map = 91%,  reduce = 0%, Cumulative CPU 5383.06 sec
2017-05-02 19:15:25,205 Stage-3 map = 92%,  reduce = 0%, Cumulative CPU 5492.69 sec
2017-05-02 19:15:29,382 Stage-3 map = 93%,  reduce = 0%, Cumulative CPU 5546.96 sec
2017-05-02 19:15:31,470 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 5569.72 sec
2017-05-02 19:15:36,716 Stage-3 map = 95%,  reduce = 0%, Cumulative CPU 5599.12 sec
2017-05-02 19:15:41,995 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 5641.39 sec
2017-05-02 19:15:46,203 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 5676.69 sec
2017-05-02 19:15:50,511 Stage-3 map = 98%,  reduce = 0%, Cumulative CPU 5704.78 sec
2017-05-02 19:15:54,644 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 5721.61 sec
2017-05-02 19:16:15,496 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 5766.72 sec
2017-05-02 19:16:35,044 Stage-3 map = 100%,  reduce = 1%, Cumulative CPU 5771.15 sec
2017-05-02 19:16:36,090 Stage-3 map = 100%,  reduce = 2%, Cumulative CPU 5775.96 sec
2017-05-02 19:16:45,538 Stage-3 map = 100%,  reduce = 15%, Cumulative CPU 5880.07 sec
2017-05-02 19:16:46,601 Stage-3 map = 100%,  reduce = 29%, Cumulative CPU 5953.94 sec
2017-05-02 19:16:47,642 Stage-3 map = 100%,  reduce = 40%, Cumulative CPU 6023.69 sec
2017-05-02 19:16:48,677 Stage-3 map = 100%,  reduce = 45%, Cumulative CPU 6056.17 sec
2017-05-02 19:16:49,722 Stage-3 map = 100%,  reduce = 48%, Cumulative CPU 6074.32 sec
2017-05-02 19:16:50,770 Stage-3 map = 100%,  reduce = 50%, Cumulative CPU 6083.81 sec
2017-05-02 19:16:51,840 Stage-3 map = 100%,  reduce = 54%, Cumulative CPU 6166.89 sec
2017-05-02 19:16:52,913 Stage-3 map = 100%,  reduce = 56%, Cumulative CPU 6205.54 sec
2017-05-02 19:16:53,969 Stage-3 map = 100%,  reduce = 58%, Cumulative CPU 6272.85 sec
2017-05-02 19:16:55,005 Stage-3 map = 100%,  reduce = 69%, Cumulative CPU 6639.91 sec
2017-05-02 19:16:56,042 Stage-3 map = 100%,  reduce = 75%, Cumulative CPU 6894.55 sec
2017-05-02 19:16:57,080 Stage-3 map = 100%,  reduce = 80%, Cumulative CPU 7035.09 sec
2017-05-02 19:16:58,117 Stage-3 map = 100%,  reduce = 82%, Cumulative CPU 7145.79 sec
2017-05-02 19:16:59,203 Stage-3 map = 100%,  reduce = 84%, Cumulative CPU 7227.07 sec
2017-05-02 19:17:00,252 Stage-3 map = 100%,  reduce = 86%, Cumulative CPU 7290.91 sec
2017-05-02 19:17:01,291 Stage-3 map = 100%,  reduce = 89%, Cumulative CPU 7385.77 sec
2017-05-02 19:17:02,352 Stage-3 map = 100%,  reduce = 90%, Cumulative CPU 7453.9 sec
2017-05-02 19:17:03,394 Stage-3 map = 100%,  reduce = 92%, Cumulative CPU 7525.74 sec
2017-05-02 19:17:05,484 Stage-3 map = 100%,  reduce = 93%, Cumulative CPU 7639.55 sec
2017-05-02 19:17:09,675 Stage-3 map = 100%,  reduce = 94%, Cumulative CPU 7841.47 sec
2017-05-02 19:17:11,795 Stage-3 map = 100%,  reduce = 95%, Cumulative CPU 7954.9 sec
2017-05-02 19:17:13,918 Stage-3 map = 100%,  reduce = 96%, Cumulative CPU 8109.33 sec
2017-05-02 19:17:15,018 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 8191.51 sec
2017-05-02 19:17:16,103 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 8296.29 sec
2017-05-02 19:17:18,202 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 8452.72 sec
2017-05-02 19:18:18,601 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 9572.42 sec
2017-05-02 19:19:18,717 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10233.22 sec
2017-05-02 19:20:19,740 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 10692.22 sec
2017-05-02 19:21:20,331 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11028.83 sec
2017-05-02 19:22:20,570 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11279.47 sec
2017-05-02 19:23:20,829 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11481.13 sec
2017-05-02 19:24:21,591 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11646.06 sec
2017-05-02 19:25:21,704 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11773.47 sec
2017-05-02 19:26:22,710 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 11900.02 sec
2017-05-02 19:27:23,424 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12026.32 sec
2017-05-02 19:28:24,113 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12154.25 sec
2017-05-02 19:29:24,920 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12280.55 sec
2017-05-02 19:30:25,838 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12407.89 sec
2017-05-02 19:31:26,492 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12531.95 sec
2017-05-02 19:32:26,818 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12656.85 sec
2017-05-02 19:33:27,503 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12734.78 sec
2017-05-02 19:34:28,012 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12799.75 sec
2017-05-02 19:35:28,563 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12862.98 sec
2017-05-02 19:36:29,204 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12928.58 sec
2017-05-02 19:37:29,834 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 12993.56 sec
2017-05-02 19:38:30,818 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13059.45 sec
2017-05-02 19:39:31,260 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13121.93 sec
2017-05-02 19:40:31,889 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13187.35 sec
2017-05-02 19:41:32,383 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13252.76 sec
2017-05-02 19:42:32,680 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13318.44 sec
2017-05-02 19:43:33,210 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13381.03 sec
2017-05-02 19:44:33,268 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13446.84 sec
2017-05-02 19:45:33,956 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13508.78 sec
2017-05-02 19:46:34,498 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13573.14 sec
2017-05-02 19:47:35,053 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13634.13 sec
2017-05-02 19:48:36,002 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13697.87 sec
2017-05-02 19:49:36,059 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13762.38 sec
2017-05-02 19:50:36,660 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13824.0 sec
2017-05-02 19:51:37,410 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13888.77 sec
2017-05-02 19:52:37,628 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 13955.08 sec
2017-05-02 19:53:38,519 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14020.3 sec
2017-05-02 19:54:39,460 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14085.5 sec
2017-05-02 19:55:39,600 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14147.63 sec
2017-05-02 19:56:40,548 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14211.81 sec
2017-05-02 19:57:41,378 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14276.68 sec
2017-05-02 19:58:41,536 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14339.55 sec
2017-05-02 19:59:41,627 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14405.23 sec
2017-05-02 20:00:42,516 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14471.09 sec
2017-05-02 20:01:42,627 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14533.22 sec
2017-05-02 20:02:42,728 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14598.4 sec
2017-05-02 20:03:42,742 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14664.81 sec
2017-05-02 20:04:43,612 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14726.77 sec
2017-05-02 20:05:44,122 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14792.84 sec
2017-05-02 20:06:44,817 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14858.14 sec
2017-05-02 20:07:45,779 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14923.59 sec
2017-05-02 20:08:46,416 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 14989.22 sec
2017-05-02 20:09:04,912 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 15008.95 sec
2017-05-02 20:10:05,270 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 15071.86 sec
2017-05-02 20:11:05,579 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 15084.43 sec
MapReduce Total cumulative CPU time: 0 days 4 hours 11 minutes 24 seconds 430 msec
Ended Job = job_1493104900716_661025
Launching Job 2 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_663908, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_663908/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_663908
Hadoop job information for Stage-4: number of mappers: 3; number of reducers: 3
2017-05-02 20:12:27,190 Stage-4 map = 0%,  reduce = 0%
2017-05-02 20:13:19,433 Stage-4 map = 1%,  reduce = 0%, Cumulative CPU 11.32 sec
2017-05-02 20:13:50,350 Stage-4 map = 4%,  reduce = 0%, Cumulative CPU 17.01 sec
2017-05-02 20:14:02,692 Stage-4 map = 6%,  reduce = 0%, Cumulative CPU 25.6 sec
2017-05-02 20:14:04,739 Stage-4 map = 7%,  reduce = 0%, Cumulative CPU 25.88 sec
2017-05-02 20:14:10,913 Stage-4 map = 9%,  reduce = 0%, Cumulative CPU 28.27 sec
2017-05-02 20:14:17,087 Stage-4 map = 11%,  reduce = 0%, Cumulative CPU 30.22 sec
2017-05-02 20:14:43,828 Stage-4 map = 14%,  reduce = 0%, Cumulative CPU 30.68 sec
2017-05-02 20:14:46,971 Stage-4 map = 15%,  reduce = 0%, Cumulative CPU 34.08 sec
2017-05-02 20:14:50,043 Stage-4 map = 17%,  reduce = 0%, Cumulative CPU 37.74 sec
2017-05-02 20:14:53,130 Stage-4 map = 18%,  reduce = 0%, Cumulative CPU 41.75 sec
2017-05-02 20:14:56,229 Stage-4 map = 20%,  reduce = 0%, Cumulative CPU 45.71 sec
2017-05-02 20:15:02,405 Stage-4 map = 22%,  reduce = 0%, Cumulative CPU 48.6 sec
2017-05-02 20:15:05,498 Stage-4 map = 29%,  reduce = 0%, Cumulative CPU 50.84 sec
2017-05-02 20:15:06,532 Stage-4 map = 40%,  reduce = 0%, Cumulative CPU 52.43 sec
2017-05-02 20:15:11,747 Stage-4 map = 41%,  reduce = 0%, Cumulative CPU 54.14 sec
2017-05-02 20:15:18,030 Stage-4 map = 42%,  reduce = 0%, Cumulative CPU 55.34 sec
2017-05-02 20:15:27,390 Stage-4 map = 43%,  reduce = 0%, Cumulative CPU 57.91 sec
2017-05-02 20:15:38,806 Stage-4 map = 44%,  reduce = 0%, Cumulative CPU 59.72 sec
2017-05-02 20:15:48,186 Stage-4 map = 45%,  reduce = 0%, Cumulative CPU 62.58 sec
2017-05-02 20:15:59,511 Stage-4 map = 46%,  reduce = 0%, Cumulative CPU 65.09 sec
2017-05-02 20:16:09,846 Stage-4 map = 47%,  reduce = 0%, Cumulative CPU 67.69 sec
2017-05-02 20:16:25,266 Stage-4 map = 48%,  reduce = 0%, Cumulative CPU 70.44 sec
2017-05-02 20:16:40,721 Stage-4 map = 49%,  reduce = 0%, Cumulative CPU 72.92 sec
2017-05-02 20:16:46,947 Stage-4 map = 50%,  reduce = 0%, Cumulative CPU 74.63 sec
2017-05-02 20:16:57,536 Stage-4 map = 51%,  reduce = 0%, Cumulative CPU 76.59 sec
2017-05-02 20:17:03,724 Stage-4 map = 52%,  reduce = 0%, Cumulative CPU 79.39 sec
2017-05-02 20:17:22,325 Stage-4 map = 53%,  reduce = 0%, Cumulative CPU 82.84 sec
2017-05-02 20:17:33,620 Stage-4 map = 54%,  reduce = 0%, Cumulative CPU 86.14 sec
2017-05-02 20:17:45,925 Stage-4 map = 55%,  reduce = 0%, Cumulative CPU 88.49 sec
2017-05-02 20:17:55,267 Stage-4 map = 56%,  reduce = 0%, Cumulative CPU 90.36 sec
2017-05-02 20:18:06,573 Stage-4 map = 57%,  reduce = 0%, Cumulative CPU 91.06 sec
2017-05-02 20:18:15,833 Stage-4 map = 59%,  reduce = 0%, Cumulative CPU 95.67 sec
2017-05-02 20:18:18,908 Stage-4 map = 64%,  reduce = 0%, Cumulative CPU 107.56 sec
2017-05-02 20:18:21,988 Stage-4 map = 66%,  reduce = 0%, Cumulative CPU 116.94 sec
2017-05-02 20:18:25,065 Stage-4 map = 69%,  reduce = 0%, Cumulative CPU 125.76 sec
2017-05-02 20:18:28,145 Stage-4 map = 73%,  reduce = 0%, Cumulative CPU 94.74 sec
2017-05-02 20:18:34,305 Stage-4 map = 81%,  reduce = 0%, Cumulative CPU 150.21 sec
2017-05-02 20:18:37,396 Stage-4 map = 84%,  reduce = 0%, Cumulative CPU 153.31 sec
2017-05-02 20:18:40,487 Stage-4 map = 87%,  reduce = 0%, Cumulative CPU 117.86 sec
2017-05-02 20:18:43,581 Stage-4 map = 89%,  reduce = 0%, Cumulative CPU 120.77 sec
2017-05-02 20:18:49,733 Stage-4 map = 93%,  reduce = 0%, Cumulative CPU 127.59 sec
2017-05-02 20:18:52,809 Stage-4 map = 96%,  reduce = 0%, Cumulative CPU 130.62 sec
2017-05-02 20:18:55,898 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 133.63 sec
2017-05-02 20:19:14,924 Stage-4 map = 100%,  reduce = 18%, Cumulative CPU 144.27 sec
2017-05-02 20:19:18,011 Stage-4 map = 100%,  reduce = 22%, Cumulative CPU 147.5 sec
2017-05-02 20:19:21,080 Stage-4 map = 100%,  reduce = 23%, Cumulative CPU 160.0 sec
2017-05-02 20:19:22,104 Stage-4 map = 100%,  reduce = 38%, Cumulative CPU 170.27 sec
2017-05-02 20:19:24,150 Stage-4 map = 100%,  reduce = 52%, Cumulative CPU 187.63 sec
2017-05-02 20:19:25,171 Stage-4 map = 100%,  reduce = 56%, Cumulative CPU 190.91 sec
2017-05-02 20:19:27,221 Stage-4 map = 100%,  reduce = 57%, Cumulative CPU 194.31 sec
2017-05-02 20:19:28,249 Stage-4 map = 100%,  reduce = 63%, Cumulative CPU 201.32 sec
2017-05-02 20:19:30,293 Stage-4 map = 100%,  reduce = 65%, Cumulative CPU 204.76 sec
2017-05-02 20:19:31,351 Stage-4 map = 100%,  reduce = 69%, Cumulative CPU 213.39 sec
2017-05-02 20:19:33,392 Stage-4 map = 100%,  reduce = 71%, Cumulative CPU 217.24 sec
2017-05-02 20:19:34,412 Stage-4 map = 100%,  reduce = 72%, Cumulative CPU 219.58 sec
2017-05-02 20:19:35,436 Stage-4 map = 100%,  reduce = 73%, Cumulative CPU 233.43 sec
2017-05-02 20:19:36,464 Stage-4 map = 100%,  reduce = 74%, Cumulative CPU 238.98 sec
2017-05-02 20:19:37,490 Stage-4 map = 100%,  reduce = 75%, Cumulative CPU 242.27 sec
2017-05-02 20:19:38,511 Stage-4 map = 100%,  reduce = 76%, Cumulative CPU 245.63 sec
2017-05-02 20:19:39,535 Stage-4 map = 100%,  reduce = 77%, Cumulative CPU 250.15 sec
2017-05-02 20:19:41,583 Stage-4 map = 100%,  reduce = 78%, Cumulative CPU 257.22 sec
2017-05-02 20:19:42,613 Stage-4 map = 100%,  reduce = 80%, Cumulative CPU 265.25 sec
2017-05-02 20:19:45,718 Stage-4 map = 100%,  reduce = 82%, Cumulative CPU 279.3 sec
2017-05-02 20:19:47,770 Stage-4 map = 100%,  reduce = 83%, Cumulative CPU 285.68 sec
2017-05-02 20:19:48,788 Stage-4 map = 100%,  reduce = 85%, Cumulative CPU 290.07 sec
2017-05-02 20:19:50,870 Stage-4 map = 100%,  reduce = 86%, Cumulative CPU 293.76 sec
2017-05-02 20:19:51,891 Stage-4 map = 100%,  reduce = 88%, Cumulative CPU 297.33 sec
2017-05-02 20:19:53,957 Stage-4 map = 100%,  reduce = 89%, Cumulative CPU 301.45 sec
2017-05-02 20:19:54,989 Stage-4 map = 100%,  reduce = 91%, Cumulative CPU 306.7 sec
2017-05-02 20:19:57,045 Stage-4 map = 100%,  reduce = 92%, Cumulative CPU 310.42 sec
2017-05-02 20:19:58,110 Stage-4 map = 100%,  reduce = 93%, Cumulative CPU 313.49 sec
2017-05-02 20:20:00,173 Stage-4 map = 100%,  reduce = 95%, Cumulative CPU 318.57 sec
2017-05-02 20:20:03,238 Stage-4 map = 100%,  reduce = 96%, Cumulative CPU 321.94 sec
2017-05-02 20:20:07,420 Stage-4 map = 100%,  reduce = 97%, Cumulative CPU 326.97 sec
2017-05-02 20:20:09,554 Stage-4 map = 100%,  reduce = 98%, Cumulative CPU 330.78 sec
2017-05-02 20:20:12,663 Stage-4 map = 100%,  reduce = 99%, Cumulative CPU 336.21 sec
2017-05-02 20:20:13,692 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 339.75 sec
MapReduce Total cumulative CPU time: 5 minutes 39 seconds 750 msec
Ended Job = job_1493104900716_663908
Launching Job 3 out of 4
Number of reduce tasks not specified. Estimated from input data size: 3
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_664483, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_664483/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_664483
Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 3
2017-05-02 20:24:37,276 Stage-1 map = 0%,  reduce = 0%
2017-05-02 20:25:15,419 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 4.23 sec
2017-05-02 20:25:31,826 Stage-1 map = 37%,  reduce = 0%, Cumulative CPU 33.11 sec
2017-05-02 20:25:34,898 Stage-1 map = 47%,  reduce = 0%, Cumulative CPU 43.98 sec
2017-05-02 20:25:44,115 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 62.4 sec
2017-05-02 20:25:50,278 Stage-1 map = 78%,  reduce = 0%, Cumulative CPU 73.84 sec
2017-05-02 20:25:53,352 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 81.45 sec
2017-05-02 20:25:56,427 Stage-1 map = 96%,  reduce = 0%, Cumulative CPU 87.83 sec
2017-05-02 20:25:59,498 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 92.02 sec
2017-05-02 20:26:18,986 Stage-1 map = 100%,  reduce = 67%, Cumulative CPU 110.99 sec
2017-05-02 20:26:22,065 Stage-1 map = 100%,  reduce = 68%, Cumulative CPU 116.49 sec
2017-05-02 20:26:25,128 Stage-1 map = 100%,  reduce = 75%, Cumulative CPU 123.36 sec
2017-05-02 20:26:28,190 Stage-1 map = 100%,  reduce = 82%, Cumulative CPU 130.6 sec
2017-05-02 20:26:31,260 Stage-1 map = 100%,  reduce = 89%, Cumulative CPU 137.56 sec
2017-05-02 20:26:34,346 Stage-1 map = 100%,  reduce = 93%, Cumulative CPU 143.22 sec
2017-05-02 20:26:37,418 Stage-1 map = 100%,  reduce = 96%, Cumulative CPU 147.64 sec
2017-05-02 20:26:40,510 Stage-1 map = 100%,  reduce = 98%, Cumulative CPU 151.87 sec
2017-05-02 20:26:43,597 Stage-1 map = 100%,  reduce = 99%, Cumulative CPU 154.27 sec
2017-05-02 20:26:46,660 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 155.44 sec
MapReduce Total cumulative CPU time: 2 minutes 35 seconds 440 msec
Ended Job = job_1493104900716_664483
Launching Job 4 out of 4
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_664748, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_664748/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_664748
Hadoop job information for Stage-2: number of mappers: 2; number of reducers: 1
2017-05-02 20:28:38,298 Stage-2 map = 0%,  reduce = 0%
2017-05-02 20:29:15,760 Stage-2 map = 6%,  reduce = 0%, Cumulative CPU 50.04 sec
2017-05-02 20:29:18,870 Stage-2 map = 11%,  reduce = 0%, Cumulative CPU 56.86 sec
2017-05-02 20:29:46,089 Stage-2 map = 25%,  reduce = 0%, Cumulative CPU 126.63 sec
2017-05-02 20:30:12,079 Stage-2 map = 0%,  reduce = 0%
2017-05-02 20:31:36,567 Stage-2 map = 0%,  reduce = 0%
2017-05-02 20:32:37,381 Stage-2 map = 0%,  reduce = 0%, Cumulative CPU 41.54 sec
2017-05-02 20:33:28,476 Stage-2 map = 5%,  reduce = 0%, Cumulative CPU 56.03 sec
2017-05-02 20:33:32,563 Stage-2 map = 11%,  reduce = 0%, Cumulative CPU 65.55 sec
2017-05-02 20:34:00,109 Stage-2 map = 35%,  reduce = 0%, Cumulative CPU 126.48 sec
2017-05-02 20:34:07,287 Stage-2 map = 48%,  reduce = 0%, Cumulative CPU 153.77 sec
2017-05-02 20:34:10,375 Stage-2 map = 53%,  reduce = 0%, Cumulative CPU 160.53 sec
2017-05-02 20:34:24,800 Stage-2 map = 70%,  reduce = 0%, Cumulative CPU 190.63 sec
2017-05-02 20:34:35,091 Stage-2 map = 83%,  reduce = 0%, Cumulative CPU 209.32 sec
2017-05-02 20:34:53,636 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 229.11 sec
2017-05-02 20:35:24,307 Stage-2 map = 100%,  reduce = 67%, Cumulative CPU 246.06 sec
2017-05-02 20:35:27,383 Stage-2 map = 100%,  reduce = 70%, Cumulative CPU 251.08 sec
2017-05-02 20:35:30,450 Stage-2 map = 100%,  reduce = 79%, Cumulative CPU 255.41 sec
2017-05-02 20:35:33,577 Stage-2 map = 100%,  reduce = 86%, Cumulative CPU 259.62 sec
2017-05-02 20:35:36,670 Stage-2 map = 100%,  reduce = 94%, Cumulative CPU 262.99 sec
2017-05-02 20:35:39,741 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 265.31 sec
MapReduce Total cumulative CPU time: 4 minutes 25 seconds 310 msec
Ended Job = job_1493104900716_664748
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 158  Reduce: 171   Cumulative CPU: 15084.43 sec   HDFS Read: 43532842792 HDFS Write: 522161442 SUCCESS
Stage-Stage-4: Map: 3  Reduce: 3   Cumulative CPU: 340.87 sec   HDFS Read: 522228798 HDFS Write: 522141942 SUCCESS
Stage-Stage-1: Map: 3  Reduce: 3   Cumulative CPU: 155.51 sec   HDFS Read: 522190314 HDFS Write: 521039959 SUCCESS
Stage-Stage-2: Map: 2  Reduce: 1   Cumulative CPU: 265.52 sec   HDFS Read: 521054889 HDFS Write: 381397704 SUCCESS
Total MapReduce CPU Time Spent: 0 days 4 hours 24 minutes 6 seconds 330 msec
OK
Time taken: 5361.971 seconds, Fetched: 5837118 row(s)
SQL done, now R
now push to leaf(1/2)
{"access_key": "ff63a9a52b921aa04827dbf544633bb5", "timestamp": 1492012800, "data": [{"params": {"city_id": "1"}, "val": {"real_ratio": 71.84}}, {"params": {"city_id": "11"}, "val": {"real_ratio": 98.22}}, {"params": {"city_id": "13"}, "val": {"real_ratio": 97.15}}, {"params": {"city_id": "17"}, "val": {"real_ratio": 96.12}}, {"params": {"city_id": "18"}, "val": {"real_ratio": 96.74}}, {"params": {"city_id": "2"}, "val": {"real_ratio": 98.6}}, {"params": {"city_id": "22"}, "val": {"real_ratio": 97.24}}, {"params": {"city_id": "25"}, "val": {"real_ratio": 92.21}}, {"params": {"city_id": "30"}, "val": {"real_ratio": 99.69}}, {"params": {"city_id": "33"}, "val": {"real_ratio": 99.46}}, {"params": {"city_id": "34"}, "val": {"real_ratio": 99.4}}, {"params": {"city_id": "35"}, "val": {"real_ratio": 95.59}}, {"params": {"city_id": "38"}, "val": {"real_ratio": 97.17}}, {"params": {"city_id": "39"}, "val": {"real_ratio": 96.39}}, {"params": {"city_id": "40"}, "val": {"real_ratio": 99.46}}, {"params": {"city_id": "41"}, "val": {"real_ratio": 99.62}}, {"params": {"city_id": "45"}, "val": {"real_ratio": 99.27}}, {"params": {"city_id": "58"}, "val": {"real_ratio": 98.65}}, {"params": {"city_id": "62"}, "val": {"real_ratio": 96.37}}, {"params": {"city_id": "7"}, "val": {"real_ratio": 96.02}}, {"params": {"city_id": "82"}, "val": {"real_ratio": 98.79}}, {"params": {"city_id": "85"}, "val": {"real_ratio": 98.58}}, {"params": {"city_id": "90"}, "val": {"real_ratio": 94.31}}], "access_id": 38}
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 20:30:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  243G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
36G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
21G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m

set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
set hive.cli.print.header=false;

use transit_dw;
select 
    7 as city_id,
    round(100 * abnormal_num / total_num, 2) as real_abnormal_ratio 
from 
(
    select 
        sum(case when (bloom_resp['status'] = 1) or (cast(bloom_resp['normal_num'] as int) > 0 and cast(bloom_resp['nogps_num'] as int) / cast(bloom_resp['normal_num'] as int) > 0.6) then 1 else 0 end) as abnormal_num, 
        count(1) as total_num
    from dwv_log_transit_realtime_query 
    where 
        concat(year,month,day) = '20170413' 
        and city_id = '7'
)q

17/05/02 20:37:48 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 20:37:48 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
OK
Time taken: 1.589 seconds
Query ID = busbi_20170502203801_5a890bd8-d983-438c-bfa5-24fb972a4037
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_665311, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_665311/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_665311
Hadoop job information for Stage-1: number of mappers: 12; number of reducers: 1
2017-05-02 20:42:32,145 Stage-1 map = 0%,  reduce = 0%
2017-05-02 20:43:32,942 Stage-1 map = 0%,  reduce = 0%
2017-05-02 20:43:35,033 Stage-1 map = 8%,  reduce = 0%, Cumulative CPU 3.78 sec
2017-05-02 20:44:02,107 Stage-1 map = 11%,  reduce = 0%, Cumulative CPU 226.5 sec
2017-05-02 20:44:03,142 Stage-1 map = 17%,  reduce = 0%, Cumulative CPU 237.32 sec
2017-05-02 20:44:04,178 Stage-1 map = 25%,  reduce = 0%, Cumulative CPU 287.7 sec
2017-05-02 20:44:05,211 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 303.41 sec
2017-05-02 20:44:16,604 Stage-1 map = 53%,  reduce = 0%, Cumulative CPU 346.16 sec
2017-05-02 20:44:23,850 Stage-1 map = 58%,  reduce = 0%, Cumulative CPU 359.69 sec
2017-05-02 20:44:34,180 Stage-1 map = 69%,  reduce = 0%, Cumulative CPU 394.32 sec
2017-05-02 20:44:35,226 Stage-1 map = 72%,  reduce = 0%, Cumulative CPU 407.89 sec
2017-05-02 20:44:39,363 Stage-1 map = 78%,  reduce = 0%, Cumulative CPU 436.83 sec
2017-05-02 20:44:40,395 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 457.73 sec
2017-05-02 20:45:15,457 Stage-1 map = 100%,  reduce = 67%, Cumulative CPU 458.34 sec
2017-05-02 20:45:19,583 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 460.99 sec
MapReduce Total cumulative CPU time: 7 minutes 40 seconds 990 msec
Ended Job = job_1493104900716_665311
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 12  Reduce: 1   Cumulative CPU: 460.99 sec   HDFS Read: 2240813502 HDFS Write: 7 SUCCESS
Total MapReduce CPU Time Spent: 7 minutes 40 seconds 990 msec
OK
Time taken: 441.248 seconds, Fetched: 1 row(s)
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
[1;32mInformation at Tue May  2 20:40:01 CST 2017[0m

[1;31mÊ≥®ÊÑèÊ∏ÖÁêÜÁ£ÅÁõòÔºåË∞¢Ë∞¢Âêà‰Ωú !!![0m

/dev/sdb1       1.7T  1.4T  242G  86% /data
100G	/data/home/uemc_bi
62G	/data/home/shikuan
55G	/data/home/qudanna
47G	/data/home/yaolin
45G	/data/home/busbi
36G	/data/home/g_caiwu
[1;33m-------------------------------------------------[0m
136G	/data/xinsi_traffic
80G	/data/kuaicheshiyebu_fuwubu
36G	/data/supply_chain
21G	/data/sec_bi
18G	/data/speech_exchange
18G	/data/common_api
[1;33m-------------------------------------------------[0m
[1;33m-*-*--*-*--*-*--*-*-*-*--*-*--*-*--*-*--*-*--*-*-[0m
rmr: DEPRECATED: Please use 'rm -r' instead.
17/05/02 20:45:35 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval = 10080 minutes, Emptier interval = 0 minutes.
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/13/_SUCCESS' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current

add jar MapMerge.jar;
create temporary function map_merge as 'com.hive.udf.MapMerge';
set mapreduce.job.queuename=root.bashishiyebu-yewuzhichengzhongxing.galileo_data;
use transit_dw;

create temporary table tmp_abnormal_ratio_20170413(
    city_id string,
    real_abnormal_ratio double
)row format delimited fields terminated by '\t';

load data local inpath '4.txt' overwrite into table tmp_abnormal_ratio_20170413;

create temporary table tmp_dwm_transit_bm_data_rate
as
select
    a.city_id,
    a.data_source_id,
    map_merge(statistical_data, map('real_abnormal_ratio', b.real_abnormal_ratio))
from dwm_transit_bm_data_rate a
left join tmp_abnormal_ratio_20170413 b
on a.city_id = b.city_id
where
    concat(year,month,day) = '20170413';

alter table dwm_transit_bm_data_rate drop partition(year='2017',month='04',day='13');
alter table dwm_transit_bm_data_rate add partition(year='2017',month='04',day='13') location '2017/04/13';
insert overwrite table dwm_transit_bm_data_rate partition(year='2017',month='04',day='13')
select
    *
from tmp_dwm_transit_bm_data_rate;

17/05/02 20:45:39 WARN conf.HiveConf: HiveConf of name hive.metastore.local does not exist
17/05/02 20:45:39 WARN conf.HiveConf: HiveConf of name hive.hadoop.master does not exist

Logging initialized using configuration in file:/data/hadoop/apache-hive-1.2.1-bin-20161214/conf/hive-log4j.properties
Added [MapMerge.jar] to class path
Added resources: [MapMerge.jar]
OK
Time taken: 1.38 seconds
OK
Time taken: 0.095 seconds
OK
Time taken: 0.473 seconds
Loading data to table transit_dw.tmp_abnormal_ratio_20170413
Table transit_dw.tmp_abnormal_ratio_20170413 stats: [numFiles=1, numRows=0, totalSize=182, rawDataSize=0]
OK
Time taken: 0.499 seconds
Query ID = busbi_20170502204545_f01d6947-1d04-46f6-a0fa-66c3fcf126a2
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1493104900716_665588, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_665588/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_665588
Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 1
2017-05-02 20:46:33,187 Stage-1 map = 0%,  reduce = 0%
2017-05-02 20:46:41,775 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 2.12 sec
2017-05-02 20:46:42,839 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 4.61 sec
2017-05-02 20:47:18,217 Stage-1 map = 100%,  reduce = 69%, Cumulative CPU 7.1 sec
2017-05-02 20:47:41,991 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 8.16 sec
MapReduce Total cumulative CPU time: 8 seconds 160 msec
Ended Job = job_1493104900716_665588
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_20-45-45_536_7244057235267128386-1/-ext-10001
Moving data to: hdfs://mycluster-tj/tmp/hive-hadoop/galileo_data/4252d4e3-f2a8-4a6f-a027-1024d950aa67/_tmp_space.db/89533b54-c76c-443c-acca-4cd65b8c6450
Table transit_dw.tmp_dwm_transit_bm_data_rate stats: [numFiles=1, numRows=24, totalSize=6091, rawDataSize=6067]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 2  Reduce: 1   Cumulative CPU: 8.55 sec   HDFS Read: 19082 HDFS Write: 6188 SUCCESS
Total MapReduce CPU Time Spent: 8 seconds 550 msec
OK
a.city_id	a.data_source_id	_c2
Time taken: 228.537 seconds
Dropped the partition year=2017/month=04/day=13
OK
Time taken: 0.204 seconds
OK
Time taken: 4.768 seconds
Query ID = busbi_20170502204940_4c80572a-d106-4c16-ac75-bdc67abefa34
Total jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1493104900716_665773, Tracking URL = http://bigdata-hdp-apache501.xg01:8088/proxy/application_1493104900716_665773/
Kill Command = /usr/local/hadoop-2.7.2/bin/hadoop job  -kill job_1493104900716_665773
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2017-05-02 20:52:08,336 Stage-1 map = 0%,  reduce = 0%
2017-05-02 20:52:19,795 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 5.7 sec
MapReduce Total cumulative CPU time: 5 seconds 700 msec
Ended Job = job_1493104900716_665773
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to: hdfs://mycluster-tj/tmp/hive-staging/hadoop_hive_2017-05-02_20-49-40_859_5477284623593718797-1/-ext-10000
Loading data to table transit_dw.dwm_transit_bm_data_rate partition (year=2017, month=04, day=13)
Moved: 'hdfs://mycluster-tj/user/galileo_data/data/bi/transit_dw/dwm_transit_bm_data_rate/2017/04/13/000000_0' to trash at: hdfs://mycluster-tj/user/galileo_data/.Trash/Current
Partition transit_dw.dwm_transit_bm_data_rate{year=2017, month=04, day=13} stats: [numFiles=1, numRows=24, totalSize=1809, rawDataSize=30256]
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 5.7 sec   HDFS Read: 10428 HDFS Write: 1929 SUCCESS
Total MapReduce CPU Time Spent: 5 seconds 700 msec
OK
tmp_dwm_transit_bm_data_rate.city_id	tmp_dwm_transit_bm_data_rate.data_source_id	tmp_dwm_transit_bm_data_rate._c2
Time taken: 162.206 seconds
